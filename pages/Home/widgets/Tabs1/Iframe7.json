{
  "animateLoading": true,
  "borderOpacity": 100,
  "borderRadius": "{{appsmith.theme.borderRadius.appBorderRadius}}",
  "borderWidth": 1,
  "bottomRow": 138,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "dynamicBindingPathList": [
    {
      "key": "borderRadius"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "srcDoc"
    }
  ],
  "dynamicTriggerPathList": [],
  "flexVerticalAlignment": "start",
  "isLoading": false,
  "isVisible": true,
  "key": "wh6z4zxt20",
  "leftColumn": 0,
  "mobileBottomRow": 32,
  "mobileLeftColumn": 0,
  "mobileRightColumn": 11,
  "mobileTopRow": 0,
  "needsErrorInfo": false,
  "parentColumnSpace": 19.9375,
  "parentId": "zxuc6pk9ga",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "responsiveBehavior": "fill",
  "rightColumn": 62,
  "source": "https://www.example.com",
  "srcDoc": "<style>\n    * {\n        margin: 0;\n        padding: 0;\n        box-sizing: border-box;\n    }\n\n    body {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;\n        background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);\n        min-height: 100vh;\n        padding: 20px;\n    }\n\n    .rastreamento-container {\n        max-width: 1920px;\n        margin: 0 auto;\n    }\n\n    /* ========== HEADER & SEARCH ========== */\n    .search-header {\n        background: white;\n        padding: 24px 32px;\n        border-radius: 16px;\n        box-shadow: 0 8px 32px rgba(0,0,0,0.12);\n        margin-bottom: 20px;\n    }\n\n    .header-title {\n        font-size: 28px;\n        font-weight: 900;\n        background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);\n        -webkit-background-clip: text;\n        -webkit-text-fill-color: transparent;\n        background-clip: text;\n        margin-bottom: 20px;\n        display: flex;\n        align-items: center;\n        gap: 12px;\n    }\n\n    .search-box {\n        display: flex;\n        gap: 12px;\n        align-items: center;\n    }\n\n    .search-input {\n        flex: 1;\n        padding: 14px 20px;\n        border: 3px solid #1890ff;\n        border-radius: 12px;\n        font-size: 16px;\n        font-weight: 600;\n        color: #111827;\n        transition: all 0.2s;\n    }\n\n    .search-input:focus {\n        outline: none;\n        border-color: #0050b3;\n        box-shadow: 0 0 0 4px rgba(24, 144, 255, 0.1);\n    }\n\n    .search-btn {\n        padding: 14px 28px;\n        background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);\n        color: white;\n        border: none;\n        border-radius: 12px;\n        font-size: 15px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n        box-shadow: 0 4px 12px rgba(24, 144, 255, 0.3);\n        white-space: nowrap;\n    }\n\n    .search-btn:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 6px 20px rgba(24, 144, 255, 0.4);\n    }\n\n    .search-hint {\n        margin-top: 8px;\n        font-size: 12px;\n        color: #6b7280;\n        font-weight: 600;\n    }\n\n    /* ========== MAIN LAYOUT ========== */\n    .tracking-layout {\n        display: none;\n        grid-template-columns: 1fr 400px;\n        gap: 20px;\n        height: calc(100vh - 200px);\n        min-height: 600px;\n    }\n\n    .tracking-layout.active {\n        display: grid;\n    }\n\n    /* ========== MAP SECTION ========== */\n    .map-container {\n        background: white;\n        border-radius: 16px;\n        overflow: hidden;\n        box-shadow: 0 8px 32px rgba(0,0,0,0.12);\n        display: flex;\n        flex-direction: column;\n    }\n\n    .map-header {\n        padding: 20px 24px;\n        background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);\n        color: white;\n    }\n\n    .map-title {\n        font-size: 20px;\n        font-weight: 800;\n        margin-bottom: 8px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n\n    .map-subtitle {\n        font-size: 13px;\n        opacity: 0.9;\n        font-weight: 600;\n    }\n\n    .map-frame {\n        flex: 1;\n        width: 100%;\n        border: none;\n        min-height: 500px;\n    }\n\n    .map-legend {\n        padding: 16px 24px;\n        background: #f9fafb;\n        border-top: 2px solid #e5e7eb;\n        display: flex;\n        gap: 24px;\n        flex-wrap: wrap;\n    }\n\n    .legend-item {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        font-size: 12px;\n        font-weight: 700;\n        color: #374151;\n    }\n\n    .legend-icon {\n        font-size: 18px;\n    }\n\n    /* ========== SIDEBAR ========== */\n    .sidebar {\n        background: white;\n        border-radius: 16px;\n        box-shadow: 0 8px 32px rgba(0,0,0,0.12);\n        display: flex;\n        flex-direction: column;\n        overflow: hidden;\n    }\n\n    .sidebar-header {\n        padding: 20px 24px;\n        background: linear-gradient(135deg, #52c41a 0%, #389e0d 100%);\n        color: white;\n    }\n\n    .sidebar-title {\n        font-size: 18px;\n        font-weight: 800;\n        margin-bottom: 12px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n\n    .motoboy-info {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 8px;\n        font-size: 12px;\n        font-weight: 600;\n    }\n\n    .motoboy-label {\n        opacity: 0.8;\n    }\n\n    .motoboy-value {\n        text-align: right;\n        font-weight: 800;\n    }\n\n    .sidebar-stats {\n        display: flex;\n        gap: 8px;\n        padding: 16px 24px;\n        background: #f0f9ff;\n        border-bottom: 2px solid #e0f2fe;\n    }\n\n    .stat-box {\n        flex: 1;\n        text-align: center;\n    }\n\n    .stat-value {\n        font-size: 24px;\n        font-weight: 900;\n        color: #1890ff;\n        margin-bottom: 4px;\n    }\n\n    .stat-label {\n        font-size: 10px;\n        font-weight: 700;\n        text-transform: uppercase;\n        color: #6b7280;\n        letter-spacing: 0.5px;\n    }\n\n    .sidebar-content {\n        flex: 1;\n        overflow-y: auto;\n        padding: 16px;\n    }\n\n    /* ========== PEDIDO CARDS ========== */\n    .pedido-card {\n        background: #f9fafb;\n        border: 2px solid #e5e7eb;\n        border-radius: 12px;\n        padding: 16px;\n        margin-bottom: 12px;\n        transition: all 0.2s;\n        cursor: pointer;\n    }\n\n    .pedido-card:hover {\n        border-color: #1890ff;\n        box-shadow: 0 4px 12px rgba(24, 144, 255, 0.15);\n        transform: translateX(4px);\n    }\n\n    .pedido-card.entregue {\n        border-color: #52c41a;\n        background: #f6ffed;\n    }\n\n    .pedido-card.em-rota {\n        border-color: #faad14;\n        background: #fffbe6;\n    }\n\n    .pedido-card.atual {\n        border-color: #1890ff;\n        background: #e6f7ff;\n        border-width: 3px;\n        box-shadow: 0 4px 16px rgba(24, 144, 255, 0.25);\n    }\n\n    .pedido-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        margin-bottom: 12px;\n    }\n\n    .pedido-numero {\n        font-size: 16px;\n        font-weight: 800;\n        color: #111827;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n\n    .pedido-status {\n        padding: 4px 12px;\n        border-radius: 999px;\n        font-size: 10px;\n        font-weight: 800;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n\n    .pedido-status.entregue {\n        background: #52c41a;\n        color: white;\n    }\n\n    .pedido-status.em-rota {\n        background: #faad14;\n        color: white;\n    }\n\n    .pedido-status.pendente {\n        background: #d9d9d9;\n        color: #595959;\n    }\n\n    .pedido-status.atual {\n        background: #1890ff;\n        color: white;\n        animation: pulse 2s infinite;\n    }\n\n    @keyframes pulse {\n        0%, 100% { opacity: 1; }\n        50% { opacity: 0.7; }\n    }\n\n    .pedido-cliente {\n        font-size: 13px;\n        font-weight: 700;\n        color: #374151;\n        margin-bottom: 8px;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        overflow: hidden;\n    }\n\n    .pedido-endereco {\n        font-size: 11px;\n        font-weight: 600;\n        color: #6b7280;\n        margin-bottom: 8px;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        overflow: hidden;\n    }\n\n    .pedido-horario {\n        font-size: 11px;\n        font-weight: 700;\n        color: #1890ff;\n        display: flex;\n        align-items: center;\n        gap: 4px;\n    }\n\n    /* ========== EMPTY STATE ========== */\n    .empty-state {\n        background: white;\n        padding: 60px 40px;\n        border-radius: 16px;\n        box-shadow: 0 8px 32px rgba(0,0,0,0.12);\n        text-align: center;\n    }\n\n    .empty-icon {\n        font-size: 80px;\n        margin-bottom: 20px;\n    }\n\n    .empty-title {\n        font-size: 28px;\n        font-weight: 800;\n        color: #374151;\n        margin-bottom: 12px;\n    }\n\n    .empty-text {\n        font-size: 16px;\n        color: #6b7280;\n        font-weight: 600;\n        margin-bottom: 24px;\n    }\n\n    .empty-examples {\n        display: inline-flex;\n        gap: 12px;\n        flex-wrap: wrap;\n        justify-content: center;\n    }\n\n    .example-chip {\n        padding: 8px 16px;\n        background: #f0f9ff;\n        border: 2px solid #1890ff;\n        border-radius: 8px;\n        font-size: 13px;\n        font-weight: 700;\n        color: #0050b3;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n\n    .example-chip:hover {\n        background: #1890ff;\n        color: white;\n        transform: translateY(-2px);\n    }\n\n    /* ========== SCROLLBAR ========== */\n    .sidebar-content::-webkit-scrollbar {\n        width: 8px;\n    }\n\n    .sidebar-content::-webkit-scrollbar-track {\n        background: #f1f1f1;\n    }\n\n    .sidebar-content::-webkit-scrollbar-thumb {\n        background: #1890ff;\n        border-radius: 4px;\n    }\n\n    .sidebar-content::-webkit-scrollbar-thumb:hover {\n        background: #0050b3;\n    }\n\n    /* ========== RESPONSIVE ========== */\n    @media (max-width: 1200px) {\n        .tracking-layout {\n            grid-template-columns: 1fr;\n            height: auto;\n        }\n\n        .map-container {\n            min-height: 500px;\n        }\n\n        .sidebar {\n            height: 600px;\n        }\n    }\n\n    @media (max-width: 768px) {\n        .search-box {\n            flex-direction: column;\n        }\n\n        .motoboy-info {\n            grid-template-columns: 1fr;\n            gap: 4px;\n        }\n\n        .motoboy-value {\n            text-align: left;\n        }\n    }\n\n    /* ========== LOADING ========== */\n    .loading-overlay {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0, 0, 0, 0.7);\n        display: none;\n        align-items: center;\n        justify-content: center;\n        z-index: 9999;\n    }\n\n    .loading-overlay.active {\n        display: flex;\n    }\n\n    .loading-content {\n        background: white;\n        padding: 40px;\n        border-radius: 16px;\n        text-align: center;\n    }\n\n    .loading-spinner {\n        font-size: 48px;\n        animation: spin 1s linear infinite;\n    }\n\n    @keyframes spin {\n        from { transform: rotate(0deg); }\n        to { transform: rotate(360deg); }\n    }\n\n    .loading-text {\n        margin-top: 16px;\n        font-size: 16px;\n        font-weight: 700;\n        color: #374151;\n    }\n</style>\n\n<div class=\"rastreamento-container\">\n    <!-- HEADER & SEARCH -->\n    <div class=\"search-header\">\n        <div class=\"header-title\">üó∫Ô∏è Rastreamento Visual em Tempo Real</div>\n        \n        <div class=\"search-box\">\n            <input \n                type=\"text\" \n                id=\"searchInput\" \n                class=\"search-input\" \n                placeholder=\"Digite o n√∫mero da SAIDA ou PEDIDO...\"\n                onkeypress=\"if(event.key === 'Enter') buscarRastreamento()\"\n            >\n            <button class=\"search-btn\" onclick=\"buscarRastreamento()\">\n                üîç Rastrear\n            </button>\n        </div>\n        \n        <div class=\"search-hint\">\n            üí° <strong>Dica:</strong> Digite uma SAIDA para ver todos os pedidos no mapa, ou um PEDIDO espec√≠fico para ver sua localiza√ß√£o\n        </div>\n    </div>\n\n    <!-- EMPTY STATE -->\n    <div id=\"emptyState\" class=\"empty-state\">\n        <div class=\"empty-icon\">üó∫Ô∏è</div>\n        <div class=\"empty-title\">Rastreie Entregas em Tempo Real</div>\n        <div class=\"empty-text\">\n            Digite uma SAIDA ou PEDIDO para visualizar no mapa<br>\n            Veja todos os pontos de entrega e a localiza√ß√£o atual do motoboy\n        </div>\n        <div id=\"suggestions\" class=\"empty-examples\">\n            <!-- Preenchido dinamicamente -->\n        </div>\n    </div>\n\n    <!-- TRACKING LAYOUT -->\n    <div id=\"trackingLayout\" class=\"tracking-layout\">\n        <!-- MAP SECTION -->\n        <div class=\"map-container\">\n            <div class=\"map-header\">\n                <div class=\"map-title\" id=\"mapTitle\">üó∫Ô∏è Mapa da Rota</div>\n                <div class=\"map-subtitle\" id=\"mapSubtitle\">Visualizando entregas...</div>\n            </div>\n            <iframe id=\"mapFrame\" class=\"map-frame\"></iframe>\n            <div class=\"map-legend\">\n                <div class=\"legend-item\">\n                    <span class=\"legend-icon\">üè¢</span>\n                    <span>Filial (In√≠cio)</span>\n                </div>\n                <div class=\"legend-item\">\n                    <span class=\"legend-icon\">üì¶</span>\n                    <span>Cliente (Pendente)</span>\n                </div>\n                <div class=\"legend-item\">\n                    <span class=\"legend-icon\">‚úÖ</span>\n                    <span>Entregue</span>\n                </div>\n                <div class=\"legend-item\">\n                    <span class=\"legend-icon\">üèçÔ∏è</span>\n                    <span>Motoboy (Posi√ß√£o Atual)</span>\n                </div>\n            </div>\n        </div>\n\n        <!-- SIDEBAR -->\n        <div class=\"sidebar\">\n            <div class=\"sidebar-header\">\n                <div class=\"sidebar-title\">üèçÔ∏è Informa√ß√µes da Rota</div>\n                <div id=\"motoboyInfo\" class=\"motoboy-info\">\n                    <!-- Preenchido dinamicamente -->\n                </div>\n            </div>\n\n            <div class=\"sidebar-stats\">\n                <div class=\"stat-box\">\n                    <div class=\"stat-value\" id=\"statTotal\">0</div>\n                    <div class=\"stat-label\">Total</div>\n                </div>\n                <div class=\"stat-box\">\n                    <div class=\"stat-value\" id=\"statEntregues\" style=\"color: #52c41a;\">0</div>\n                    <div class=\"stat-label\">Entregues</div>\n                </div>\n                <div class=\"stat-box\">\n                    <div class=\"stat-value\" id=\"statPendentes\" style=\"color: #faad14;\">0</div>\n                    <div class=\"stat-label\">Pendentes</div>\n                </div>\n            </div>\n\n            <div class=\"sidebar-content\" id=\"pedidosList\">\n                <!-- Preenchido dinamicamente -->\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- LOADING -->\n<div id=\"loadingOverlay\" class=\"loading-overlay\">\n    <div class=\"loading-content\">\n        <div class=\"loading-spinner\">üîÑ</div>\n        <div class=\"loading-text\">Carregando mapa...</div>\n    </div>\n</div>\n\n<script>\n    // ========================================\n    // DADOS GLOBAIS\n    // ========================================\n    let trackingData = {\n        pedidos: [],\n        calculo: [],\n        rotas: []\n    };\n\n    let currentView = {\n        saidaId: null,\n        pedidos: [],\n        motoboy: null,\n        filial: null\n    };\n\n    // ========================================\n    // INICIALIZAR\n    // ========================================\n    function initRastreamento() {\n        console.log('üó∫Ô∏è Inicializando rastreamento...');\n        console.log('üìä Pedidos dispon√≠veis:', trackingData.pedidos.length);\n        \n        loadSuggestions();\n    }\n\n    function loadSuggestions() {\n        const suggestionsDiv = document.getElementById('suggestions');\n        \n        // Pegar as √∫ltimas 5 sa√≠das √∫nicas\n        const saidas = [...new Set(trackingData.pedidos.map(p => p.SAIDAID))].slice(0, 5);\n        \n        if (saidas.length > 0) {\n            suggestionsDiv.innerHTML = `\n                <div style=\"width: 100%; margin-bottom: 12px; font-size: 13px; font-weight: 700; color: #6b7280;\">\n                    √öltimas sa√≠das:\n                </div>\n                ${saidas.map(s => `\n                    <div class=\"example-chip\" onclick=\"document.getElementById('searchInput').value='${s}'; buscarRastreamento();\">\n                        Sa√≠da #${s}\n                    </div>\n                `).join('')}\n            `;\n        }\n    }\n\n    // ========================================\n    // BUSCAR RASTREAMENTO\n    // ========================================\n    function buscarRastreamento() {\n        const input = document.getElementById('searchInput').value.trim();\n        \n        if (!input) {\n            alert('Por favor, digite uma SAIDA ou PEDIDO!');\n            return;\n        }\n\n        showLoading(true);\n        console.log('üîç Buscando:', input);\n\n        // Tentar como SAIDA primeiro\n        let pedidosDaRota = trackingData.pedidos.filter(p => \n            String(p.SAIDAID) === input || \n            parseInt(p.SAIDAID) === parseInt(input)\n        );\n\n        // Se n√£o encontrar como SAIDA, tentar como PEDIDO\n        if (pedidosDaRota.length === 0) {\n            const pedidoUnico = trackingData.pedidos.find(p => \n                String(p.PEDIDO) === input || \n                parseInt(p.PEDIDO) === parseInt(input)\n            );\n            \n            if (pedidoUnico) {\n                console.log('üì¶ Encontrado como PEDIDO, buscando toda a rota...');\n                pedidosDaRota = trackingData.pedidos.filter(p => \n                    p.SAIDAID === pedidoUnico.SAIDAID\n                );\n            }\n        }\n\n        console.log('üìä Pedidos encontrados:', pedidosDaRota.length);\n\n        if (pedidosDaRota.length === 0) {\n            showLoading(false);\n            alert(`‚ùå Nenhuma rota encontrada!\\n\\nVerifique o n√∫mero digitado.`);\n            return;\n        }\n\n        // Processar rota\n        processarRota(pedidosDaRota, input);\n    }\n\n    // ========================================\n    // PROCESSAR ROTA\n    // ========================================\n    function processarRota(pedidos, searchTerm) {\n        console.log('‚öôÔ∏è Processando rota...');\n\n        // Ordenar por hor√°rio\n        pedidos.sort((a, b) => {\n            const timeA = a.ENTREGA_CLIENTE || a.INICIO_ROTA || '';\n            const timeB = b.ENTREGA_CLIENTE || b.INICIO_ROTA || '';\n            return timeA.localeCompare(timeB);\n        });\n\n        // Atualizar dados atuais\n        currentView.saidaId = pedidos[0].SAIDAID;\n        currentView.pedidos = pedidos;\n        currentView.motoboy = pedidos[0].MOTOBOY;\n        currentView.filial = pedidos[0].CIDADEFILIAL;\n\n        // Encontrar √∫ltima entrega (posi√ß√£o atual do motoboy)\n        const ultimaEntrega = [...pedidos].reverse().find(p => \n            p.ENTREGA_CLIENTE && p.ENTREGA_CLIENTE !== 'null'\n        );\n\n        // Estat√≠sticas\n        const totalPedidos = pedidos.length;\n        const entregues = pedidos.filter(p => p.ENTREGA_CLIENTE && p.ENTREGA_CLIENTE !== 'null').length;\n        const pendentes = totalPedidos - entregues;\n\n        // Gerar mapa\n        gerarMapa(pedidos, ultimaEntrega);\n\n        // Atualizar sidebar\n        atualizarSidebar(pedidos, ultimaEntrega);\n\n        // Mostrar layout\n        document.getElementById('emptyState').style.display = 'none';\n        document.getElementById('trackingLayout').classList.add('active');\n\n        setTimeout(() => showLoading(false), 800);\n    }\n\n    // ========================================\n    // GERAR MAPA\n    // ========================================\n    function gerarMapa(pedidos, ultimaEntrega) {\n        console.log('üó∫Ô∏è Gerando mapa...');\n\n        // Pegar coordenadas da filial\n        const filialLat = pedidos[0].FILIAL_LATITUDE;\n        const filialLng = pedidos[0].FILIAL_LONGITUDE;\n\n        // Preparar waypoints (todos os clientes)\n        const waypoints = pedidos\n            .filter(p => p.LATITUDE && p.LONGITUDE)\n            .map(p => `${p.LATITUDE},${p.LONGITUDE}`)\n            .join('|');\n\n        // Centro do mapa (primeira entrega ou filial)\n        const primeiraEntrega = pedidos.find(p => p.LATITUDE && p.LONGITUDE);\n        const centerLat = primeiraEntrega?.LATITUDE || filialLat || '-15.7801';\n        const centerLng = primeiraEntrega?.LONGITUDE || filialLng || '-47.9292';\n\n        // URL do mapa\n        let mapUrl = `https://maps.google.com/maps?hl=pt-BR&z=13&output=embed`;\n        \n        // Se tiver coordenadas da filial e waypoints, mostrar rota\n        if (filialLat && filialLng && waypoints) {\n            mapUrl = `https://www.google.com/maps/embed/v1/directions?key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8&origin=${filialLat},${filialLng}&destination=${filialLat},${filialLng}&waypoints=${waypoints}&mode=driving&language=pt-BR`;\n        } else if (centerLat && centerLng) {\n            // Sen√£o, mostrar mapa centrado nos pontos\n            mapUrl = `https://maps.google.com/maps?q=${centerLat},${centerLng}&hl=pt-BR&z=13&output=embed`;\n        }\n\n        document.getElementById('mapFrame').src = mapUrl;\n\n        // Atualizar t√≠tulos\n        document.getElementById('mapTitle').innerHTML = `üó∫Ô∏è Rota #${currentView.saidaId} - ${currentView.motoboy}`;\n        document.getElementById('mapSubtitle').innerHTML = `${pedidos.length} pontos de entrega ‚Ä¢ ${currentView.filial}`;\n    }\n\n    // ========================================\n    // ATUALIZAR SIDEBAR\n    // ========================================\n    function atualizarSidebar(pedidos, ultimaEntrega) {\n        console.log('üìä Atualizando sidebar...');\n\n        const totalPedidos = pedidos.length;\n        const entregues = pedidos.filter(p => p.ENTREGA_CLIENTE && p.ENTREGA_CLIENTE !== 'null').length;\n        const pendentes = totalPedidos - entregues;\n\n        // Info do motoboy\n        document.getElementById('motoboyInfo').innerHTML = `\n            <div class=\"motoboy-label\">Motoboy:</div>\n            <div class=\"motoboy-value\">${currentView.motoboy}</div>\n            <div class=\"motoboy-label\">Sa√≠da:</div>\n            <div class=\"motoboy-value\">#${currentView.saidaId}</div>\n            <div class=\"motoboy-label\">Filial:</div>\n            <div class=\"motoboy-value\">${currentView.filial}</div>\n            <div class=\"motoboy-label\">Rota:</div>\n            <div class=\"motoboy-value\">#${pedidos[0].CODROTA || 'N/A'}</div>\n        `;\n\n        // Stats\n        document.getElementById('statTotal').textContent = totalPedidos;\n        document.getElementById('statEntregues').textContent = entregues;\n        document.getElementById('statPendentes').textContent = pendentes;\n\n        // Lista de pedidos\n        const pedidosHtml = pedidos.map((pedido, index) => {\n            const isEntregue = pedido.ENTREGA_CLIENTE && pedido.ENTREGA_CLIENTE !== 'null';\n            const isAtual = ultimaEntrega && pedido.PEDIDO === ultimaEntrega.PEDIDO;\n            \n            let statusClass = 'pendente';\n            let statusText = 'PENDENTE';\n            \n            if (isAtual) {\n                statusClass = 'atual';\n                statusText = 'ATUAL üèçÔ∏è';\n            } else if (isEntregue) {\n                statusClass = 'entregue';\n                statusText = 'ENTREGUE';\n            } else if (pedido.INICIO_ROTA && pedido.INICIO_ROTA !== 'null') {\n                statusClass = 'em-rota';\n                statusText = 'EM ROTA';\n            }\n\n            return `\n                <div class=\"pedido-card ${statusClass}\" onclick=\"focusPedido('${pedido.PEDIDO}')\">\n                    <div class=\"pedido-header\">\n                        <div class=\"pedido-numero\">\n                            ${index + 1}. üì¶ ${pedido.PEDIDO}\n                        </div>\n                        <div class=\"pedido-status ${statusClass}\">${statusText}</div>\n                    </div>\n                    <div class=\"pedido-cliente\">\n                        ${pedido.RAZAO_SOCIAL || 'Cliente n√£o identificado'}\n                    </div>\n                    <div class=\"pedido-endereco\">\n                        üìç ${pedido.ENDERECO || 'Endere√ßo n√£o dispon√≠vel'}\n                    </div>\n                    ${isEntregue ? `\n                        <div class=\"pedido-horario\">\n                            ‚úÖ ${formatTime(pedido.ENTREGA_CLIENTE)}\n                        </div>\n                    ` : pedido.INICIO_ROTA && pedido.INICIO_ROTA !== 'null' ? `\n                        <div class=\"pedido-horario\" style=\"color: #faad14;\">\n                            üöö ${formatTime(pedido.INICIO_ROTA)}\n                        </div>\n                    ` : `\n                        <div class=\"pedido-horario\" style=\"color: #d9d9d9;\">\n                            ‚è≥ Aguardando...\n                        </div>\n                    `}\n                </div>\n            `;\n        }).join('');\n\n        document.getElementById('pedidosList').innerHTML = pedidosHtml;\n    }\n\n    // ========================================\n    // FOCAR PEDIDO NO MAPA\n    // ========================================\n    function focusPedido(pedidoNum) {\n        console.log('üéØ Focando no pedido:', pedidoNum);\n        \n        const pedido = currentView.pedidos.find(p => p.PEDIDO === pedidoNum);\n        \n        if (pedido && pedido.LATITUDE && pedido.LONGITUDE) {\n            const mapUrl = `https://maps.google.com/maps?q=${pedido.LATITUDE},${pedido.LONGITUDE}&hl=pt-BR&z=17&output=embed`;\n            document.getElementById('mapFrame').src = mapUrl;\n            \n            // Scroll para o topo do mapa\n            document.getElementById('mapFrame').scrollIntoView({ behavior: 'smooth', block: 'start' });\n        } else {\n            alert('üìç Coordenadas n√£o dispon√≠veis para este pedido.');\n        }\n    }\n\n    // ========================================\n    // UTILIT√ÅRIOS\n    // ========================================\n    function formatTime(dateStr) {\n        if (!dateStr || dateStr === 'null') return '-';\n        try {\n            const date = new Date(dateStr);\n            return date.toLocaleTimeString('pt-BR', {\n                hour: '2-digit',\n                minute: '2-digit'\n            });\n        } catch (e) {\n            return dateStr;\n        }\n    }\n\n    function showLoading(show) {\n        const overlay = document.getElementById('loadingOverlay');\n        if (show) {\n            overlay.classList.add('active');\n        } else {\n            overlay.classList.remove('active');\n        }\n    }\n\n    // ========================================\n    // INICIALIZAR\n    // ========================================\n    window.addEventListener('DOMContentLoaded', function() {\n        console.log('üöÄ DOM carregado...');\n        setTimeout(() => {\n            if (trackingData.pedidos.length > 0) {\n                initRastreamento();\n            } else {\n                setTimeout(() => initRastreamento(), 500);\n            }\n        }, 200);\n    });\n</script>\n\n<!-- Injetar dados do Appsmith -->\n<script>\n    {{\n        (() => {\n            const pedidos = pedidos_e_saidas_do_dia?.data || [];\n            const calculo = calculo_do_google?.data || { logistica_motoboy: [] };\n            const rotas = dmaplicativo_prod_rotas_otimiz?.data || [];\n            \n            return `\n                console.log('üó∫Ô∏è Carregando dados para rastreamento...');\n                console.log('üì¶ Pedidos:', ${pedidos.length});\n                console.log('üìä C√°lculos:', ${(calculo.logistica_motoboy || []).length});\n                console.log('üöö Rotas:', ${rotas.length});\n                \n                trackingData.pedidos = ${JSON.stringify(pedidos)};\n                trackingData.calculo = ${JSON.stringify(calculo.logistica_motoboy || [])};\n                trackingData.rotas = ${JSON.stringify(rotas)};\n                \n                console.log('‚úÖ Dados carregados!');\n                \n                setTimeout(() => {\n                    if (typeof initRastreamento === 'function') {\n                        initRastreamento();\n                    }\n                }, 150);\n            `;\n        })()\n    }}\n</script>\n\n",
  "topRow": 0,
  "type": "IFRAME_WIDGET",
  "version": 1,
  "widgetId": "rv3bs8qdmp",
  "widgetName": "Iframe7"
}