{
  "animateLoading": true,
  "borderOpacity": 100,
  "borderRadius": "{{appsmith.theme.borderRadius.appBorderRadius}}",
  "borderWidth": 1,
  "bottomRow": 230,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "dynamicBindingPathList": [
    {
      "key": "borderRadius"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "srcDoc"
    }
  ],
  "dynamicTriggerPathList": [],
  "flexVerticalAlignment": "start",
  "isLoading": false,
  "isVisible": true,
  "key": "xd19ls55fs",
  "leftColumn": 0,
  "mobileBottomRow": 32,
  "mobileLeftColumn": 0,
  "mobileRightColumn": 17,
  "mobileTopRow": 0,
  "needsErrorInfo": false,
  "parentColumnSpace": 19.9375,
  "parentId": "pcjyr7zcgm",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "responsiveBehavior": "fill",
  "rightColumn": 64,
  "source": "https://www.example.com",
  "srcDoc": "<style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    \n    body {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;\n        background: #f5f7fa;\n        padding: 12px;\n        font-size: 11px;\n    }\n    \n    .intercorrencias-container {\n        max-width: 1600px;\n        margin: 0 auto;\n    }\n    \n    /* Header Principal */\n    .header-principal {\n        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n        border-radius: 16px;\n        padding: 24px;\n        margin-bottom: 24px;\n        box-shadow: 0 10px 40px rgba(239, 68, 68, 0.3);\n        color: white;\n        text-align: center;\n        position: relative;\n        overflow: hidden;\n    }\n    \n    .header-principal::before {\n        content: '';\n        position: absolute;\n        top: -50%;\n        left: -50%;\n        width: 200%;\n        height: 200%;\n        background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><circle cx=\"50\" cy=\"50\" r=\"2\" fill=\"rgba(255,255,255,0.1)\"/></svg>') repeat;\n        animation: float 20s infinite linear;\n        pointer-events: none;\n    }\n    \n    @keyframes float {\n        0% { transform: translate(-50%, -50%) rotate(0deg); }\n        100% { transform: translate(-50%, -50%) rotate(360deg); }\n    }\n    \n    .header-title {\n        font-size: 36px;\n        font-weight: 900;\n        margin-bottom: 8px;\n        position: relative;\n        z-index: 1;\n    }\n    \n    .header-subtitle {\n        font-size: 16px;\n        font-weight: 600;\n        opacity: 0.9;\n        position: relative;\n        z-index: 1;\n    }\n    \n    /* Indicador Ao Vivo */\n    .live-indicator {\n        position: absolute;\n        top: 20px;\n        right: 20px;\n        background: rgba(255, 255, 255, 0.2);\n        padding: 8px 12px;\n        border-radius: 20px;\n        font-size: 12px;\n        font-weight: 700;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n    \n    .live-dot {\n        width: 10px;\n        height: 10px;\n        background: #10b981;\n        border-radius: 50%;\n        animation: pulse 2s infinite;\n    }\n    \n    @keyframes pulse {\n        0%, 100% { opacity: 1; transform: scale(1); }\n        50% { opacity: 0.7; transform: scale(1.1); }\n    }\n    \n    @keyframes fadeIn {\n        from { opacity: 0; transform: translateY(10px); }\n        to { opacity: 1; transform: translateY(0); }\n    }\n    \n    @keyframes slideIn {\n        from { transform: translateX(-20px); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n    }\n    \n    @keyframes shimmer {\n        0% { background-position: -1000px 0; }\n        100% { background-position: 1000px 0; }\n    }\n    \n    /* Controles */\n    .controles-header {\n        position: absolute;\n        bottom: 20px;\n        right: 20px;\n        display: flex;\n        gap: 12px;\n    }\n    \n    .btn-controle {\n        background: rgba(255, 255, 255, 0.2);\n        color: white;\n        border: 2px solid rgba(255, 255, 255, 0.3);\n        padding: 8px 16px;\n        border-radius: 8px;\n        font-size: 12px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .btn-controle:hover {\n        background: rgba(255, 255, 255, 0.3);\n        transform: translateY(-2px);\n    }\n    \n    /* Stats Cards */\n    .stats-row {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 16px;\n        margin-bottom: 24px;\n    }\n    \n    .stat-card {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        text-align: center;\n        transition: transform 0.2s;\n        border-top: 4px solid #ef4444;\n    }\n    \n    .stat-card:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 8px 20px rgba(0,0,0,0.15);\n    }\n    \n    .stat-value {\n        font-size: 32px;\n        font-weight: 900;\n        color: #ef4444;\n        line-height: 1;\n        margin-bottom: 8px;\n    }\n    \n    .stat-label {\n        font-size: 12px;\n        font-weight: 600;\n        color: #6b7280;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    /* Filtros */\n    .filtros-section {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        margin-bottom: 24px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        border-left: 5px solid #1890ff;\n    }\n    \n    .filtros-title {\n        font-size: 18px;\n        font-weight: 700;\n        color: #1890ff;\n        margin-bottom: 16px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n    \n    .filtros-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n        gap: 16px;\n    }\n    \n    .filtro-grupo {\n        display: flex;\n        flex-direction: column;\n        gap: 6px;\n    }\n    \n    .filtro-label {\n        font-size: 11px;\n        font-weight: 700;\n        color: #6b7280;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    .filtro-control {\n        padding: 10px 12px;\n        border: 2px solid #e5e7eb;\n        border-radius: 8px;\n        font-size: 12px;\n        background: white;\n        color: #374151;\n        font-weight: 600;\n        transition: all 0.2s;\n    }\n    \n    .filtro-control:focus {\n        outline: none;\n        border-color: #1890ff;\n        box-shadow: 0 0 0 3px rgba(24, 144, 255, 0.1);\n    }\n    \n    .btn-limpar-filtros {\n        background: #ef4444;\n        color: white;\n        border: none;\n        padding: 10px 20px;\n        border-radius: 8px;\n        font-size: 12px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .btn-limpar-filtros:hover {\n        background: #dc2626;\n        transform: translateY(-2px);\n    }\n    \n    /* Controles de Visualiza√ß√£o */\n    .view-controls {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 20px;\n    }\n    \n    .btn-modo {\n        background: white;\n        color: #1890ff;\n        border: 2px solid #1890ff;\n        padding: 8px 16px;\n        border-radius: 8px;\n        font-size: 12px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .btn-modo.ativo {\n        background: #1890ff;\n        color: white;\n    }\n    \n    .btn-modo:hover {\n        background: #1890ff;\n        color: white;\n        transform: translateY(-1px);\n    }\n    \n    /* Cards Grid */\n    .intercorrencias-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));\n        gap: 20px;\n    }\n    \n    /* Card de Intercorr√™ncia */\n    .intercorrencia-card {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.1);\n        border-left: 5px solid #ef4444;\n        transition: all 0.3s;\n        position: relative;\n    }\n    \n    .intercorrencia-card:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 8px 20px rgba(239, 68, 68, 0.2);\n    }\n    \n    .card-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 16px;\n        padding-bottom: 12px;\n        border-bottom: 2px solid #f3f4f6;\n    }\n    \n    .intercorrencia-id {\n        font-size: 20px;\n        font-weight: 900;\n        color: #ef4444;\n        background: #fef2f2;\n        padding: 8px 12px;\n        border-radius: 8px;\n        border: 2px solid #ef4444;\n    }\n    \n    .badge-status {\n        padding: 6px 12px;\n        border-radius: 20px;\n        font-size: 11px;\n        font-weight: 700;\n        text-transform: uppercase;\n    }\n    \n    .status-pendente {\n        background: #fef3c7;\n        color: #92400e;\n        border: 2px solid #f59e0b;\n    }\n    \n    .status-aprovado {\n        background: #d1fae5;\n        color: #065f46;\n        border: 2px solid #10b981;\n    }\n    \n    .badge-cidade {\n        background: #1890ff;\n        color: white;\n        padding: 4px 8px;\n        border-radius: 6px;\n        font-size: 12px;\n        font-weight: 700;\n        margin-left: 8px;\n    }\n    \n    /* Informa√ß√µes do Card */\n    .card-info {\n        display: grid;\n        grid-template-columns: repeat(2, 1fr);\n        gap: 12px;\n        margin-bottom: 16px;\n    }\n    \n    .info-item {\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n    }\n    \n    .info-label {\n        font-size: 10px;\n        font-weight: 700;\n        color: #9ca3af;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    .info-value {\n        font-size: 14px;\n        font-weight: 600;\n        color: #1f2937;\n    }\n    \n    /* Se√ß√£o Motoboy */\n    .motoboy-info {\n        background: #f0f9ff;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 16px;\n        border-left: 4px solid #1890ff;\n    }\n    \n    .motoboy-nome {\n        font-size: 16px;\n        font-weight: 700;\n        color: #1890ff;\n        margin-bottom: 4px;\n    }\n    \n    .motoboy-codigo {\n        font-size: 12px;\n        color: #6b7280;\n    }\n    \n    /* Tempo */\n    .tempo-info {\n        background: #fff7ed;\n        border-radius: 8px;\n        padding: 12px;\n        text-align: center;\n        border: 2px solid #f59e0b;\n        margin-bottom: 16px;\n    }\n    \n    .tempo-valor {\n        font-size: 20px;\n        font-weight: 900;\n        color: #f59e0b;\n        font-family: 'Courier New', monospace;\n        margin-bottom: 4px;\n    }\n    \n    .tempo-label {\n        font-size: 11px;\n        color: #92400e;\n        font-weight: 600;\n        text-transform: uppercase;\n    }\n    \n    /* Descri√ß√£o */\n    .descricao-info {\n        background: #fef2f2;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 16px;\n        border-left: 4px solid #ef4444;\n    }\n    \n    .descricao-titulo {\n        font-size: 12px;\n        font-weight: 700;\n        color: #ef4444;\n        text-transform: uppercase;\n        margin-bottom: 8px;\n    }\n    \n    .descricao-texto {\n        font-size: 13px;\n        color: #1f2937;\n        line-height: 1.6;\n        word-wrap: break-word;\n        white-space: pre-wrap;\n        overflow-wrap: break-word;\n    }\n    \n    /* Aprova√ß√£o */\n    .aprovacao-section {\n        background: #f9fafb;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 16px;\n        border: 2px solid #d1d5db;\n    }\n    \n    .aprovacao-pendente {\n        border-color: #f59e0b;\n        background: #fffbeb;\n    }\n    \n    .aprovacao-aprovada {\n        border-color: #10b981;\n        background: #ecfdf5;\n    }\n    \n    .aprovacao-titulo {\n        font-size: 12px;\n        font-weight: 700;\n        margin-bottom: 6px;\n        text-transform: uppercase;\n    }\n    \n    .aprovacao-pendente .aprovacao-titulo {\n        color: #f59e0b;\n    }\n    \n    .aprovacao-aprovada .aprovacao-titulo {\n        color: #10b981;\n    }\n    \n    .aprovacao-info {\n        font-size: 12px;\n        color: #6b7280;\n    }\n    \n    /* Imagem */\n    .imagem-section {\n        margin-bottom: 16px;\n    }\n    \n    .imagem-container {\n        position: relative;\n        border-radius: 8px;\n        overflow: hidden;\n        border: 2px solid #e5e7eb;\n        background: #f9fafb;\n        height: 200px;\n    }\n    \n    .imagem-intercorrencia {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n        cursor: pointer;\n        transition: transform 0.3s;\n    }\n    \n    .imagem-intercorrencia:hover {\n        transform: scale(1.05);\n    }\n    \n    .sem-imagem {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        height: 100%;\n        color: #9ca3af;\n        font-size: 16px;\n        font-weight: 600;\n    }\n    \n    .btn-ver-imagem {\n        background: #8b5cf6;\n        color: white;\n        padding: 8px 16px;\n        border: none;\n        border-radius: 6px;\n        font-size: 12px;\n        font-weight: 600;\n        cursor: pointer;\n        transition: all 0.2s;\n        margin-top: 8px;\n        width: 100%;\n    }\n    \n    .btn-ver-imagem:hover {\n        background: #7c3aed;\n        transform: translateY(-2px);\n    }\n    \n    /* Rodap√© do Card */\n    .card-footer {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding-top: 12px;\n        border-top: 2px solid #f3f4f6;\n        margin-top: 16px;\n        font-size: 11px;\n        color: #6b7280;\n    }\n    \n    .lancamento-info {\n        display: flex;\n        flex-direction: column;\n        gap: 2px;\n    }\n    \n    .lancamento-nome {\n        font-weight: 700;\n        color: #1f2937;\n    }\n    \n    /* Lista Compacta */\n    .intercorrencias-lista {\n        background: white;\n        border-radius: 12px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        overflow: hidden;\n        display: none;\n    }\n    \n    .lista-header {\n        background: #ef4444;\n        color: white;\n        padding: 12px 16px;\n        font-size: 12px;\n        font-weight: 700;\n        display: grid;\n        grid-template-columns: 80px 100px 150px 100px 120px 120px 1fr 100px;\n        gap: 8px;\n        border-bottom: 2px solid #dc2626;\n    }\n    \n    .lista-item {\n        display: grid;\n        grid-template-columns: 80px 100px 150px 100px 120px 120px 1fr 100px;\n        gap: 8px;\n        padding: 12px 16px;\n        border-bottom: 1px solid #f3f4f6;\n        align-items: center;\n        font-size: 11px;\n        transition: background 0.2s;\n        cursor: pointer;\n    }\n    \n    .lista-item:hover {\n        background: #fef2f2;\n    }\n    \n    .lista-item.pendente {\n        border-left: 4px solid #f59e0b;\n    }\n    \n    .lista-item.aprovado {\n        border-left: 4px solid #10b981;\n    }\n    \n    /* Status badges na lista */\n    .status-badge {\n        padding: 4px 8px;\n        border-radius: 4px;\n        font-size: 9px;\n        font-weight: 700;\n        text-align: center;\n        text-transform: uppercase;\n    }\n    \n    .status-badge.pendente {\n        background: #fef3c7;\n        color: #92400e;\n    }\n    \n    .status-badge.aprovado {\n        background: #d1fae5;\n        color: #065f46;\n    }\n    \n    /* Sem dados */\n    .sem-intercorrencias {\n        text-align: center;\n        padding: 80px;\n        background: white;\n        border-radius: 16px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n    }\n    \n    .sem-intercorrencias-icon {\n        font-size: 80px;\n        margin-bottom: 20px;\n    }\n    \n    .sem-intercorrencias-texto {\n        font-size: 24px;\n        font-weight: 700;\n        color: #10b981;\n        margin-bottom: 8px;\n    }\n    \n    .sem-intercorrencias-subtexto {\n        font-size: 14px;\n        color: #6b7280;\n    }\n    \n    /* Modal */\n    .modal {\n        display: none;\n        position: fixed;\n        z-index: 1000;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0,0,0,0.8);\n    }\n    \n    .modal-content {\n        background-color: white;\n        margin: 3% auto;\n        padding: 20px;\n        border-radius: 12px;\n        max-width: 90%;\n        max-height: 90%;\n        overflow: auto;\n    }\n    \n    .modal-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 20px;\n        border-bottom: 2px solid #ef4444;\n        padding-bottom: 10px;\n    }\n    \n    .modal-title {\n        color: #ef4444;\n        font-size: 20px;\n        font-weight: 700;\n    }\n    \n    .close {\n        color: #9ca3af;\n        font-size: 24px;\n        font-weight: bold;\n        cursor: pointer;\n    }\n    \n    .close:hover {\n        color: #ef4444;\n    }\n    \n    /* Loading */\n    .loading {\n        text-align: center;\n        padding: 40px;\n        color: #6b7280;\n        font-size: 16px;\n    }\n    \n    /* Estilos para Gr√°ficos/Analytics */\n    .chart-item {\n        background: #f9fafb;\n        border: 2px solid #e5e7eb;\n        border-radius: 8px;\n        padding: 12px;\n        text-align: center;\n        transition: all 0.2s;\n        cursor: pointer;\n    }\n    \n    .chart-item:hover {\n        border-color: #10b981;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(16, 185, 129, 0.1);\n    }\n    \n    .chart-label {\n        font-size: 12px;\n        font-weight: 700;\n        color: #1f2937;\n        margin-bottom: 8px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n    }\n    \n    .chart-stats {\n        display: flex;\n        justify-content: space-between;\n        gap: 8px;\n        margin-bottom: 6px;\n    }\n    \n    .chart-stat {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        flex: 1;\n    }\n    \n    .chart-value {\n        font-size: 16px;\n        font-weight: 800;\n        margin-bottom: 2px;\n    }\n    \n    .chart-value.tempo {\n        color: #f59e0b;\n        font-family: 'Courier New', monospace;\n    }\n    \n    .chart-value.quantidade {\n        color: #ef4444;\n    }\n    \n    .chart-value.aprovadas {\n        color: #10b981;\n    }\n    \n    .chart-sublabel {\n        font-size: 9px;\n        font-weight: 600;\n        color: #6b7280;\n        text-transform: uppercase;\n    }\n    \n    .chart-barra {\n        width: 100%;\n        height: 6px;\n        background: #e5e7eb;\n        border-radius: 3px;\n        overflow: hidden;\n        margin-top: 4px;\n    }\n    \n    .chart-progress {\n        height: 100%;\n        background: linear-gradient(90deg, #ef4444 0%, #f59e0b 50%, #10b981 100%);\n        transition: width 0.5s ease;\n    }\n    \n    /* Rankings */\n    .ranking-item {\n        background: white;\n        border: 2px solid #e5e7eb;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 8px;\n    }\n    \n    .ranking-header {\n        font-size: 12px;\n        font-weight: 700;\n        text-align: center;\n        margin-bottom: 8px;\n        padding-bottom: 6px;\n        border-bottom: 2px solid #e5e7eb;\n    }\n    \n    .ranking-list {\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n    }\n    \n    .ranking-entry {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 4px 0;\n        font-size: 11px;\n        border-bottom: 1px solid #f3f4f6;\n    }\n    \n    .ranking-position {\n        background: #6b7280;\n        color: white;\n        padding: 2px 6px;\n        border-radius: 4px;\n        font-weight: 700;\n        margin-right: 8px;\n        min-width: 24px;\n        text-align: center;\n    }\n    \n    .ranking-position.primeiro {\n        background: #ef4444;\n    }\n    \n    .ranking-position.segundo {\n        background: #f59e0b;\n    }\n    \n    .ranking-position.terceiro {\n        background: #10b981;\n    }\n    \n    /* Sistema de Abas */\n    .tabs-container {\n        background: white;\n        border-radius: 12px;\n        margin-bottom: 24px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        overflow: hidden;\n    }\n    \n    .tabs-header {\n        display: flex;\n        border-bottom: 3px solid #f3f4f6;\n        background: #f9fafb;\n    }\n    \n    .tab-button {\n        flex: 1;\n        padding: 16px 24px;\n        background: transparent;\n        border: none;\n        font-size: 14px;\n        font-weight: 700;\n        color: #6b7280;\n        cursor: pointer;\n        transition: all 0.3s;\n        border-bottom: 3px solid transparent;\n        margin-bottom: -3px;\n    }\n    \n    .tab-button:hover {\n        background: #f3f4f6;\n        color: #1f2937;\n    }\n    \n    .tab-button.active {\n        color: #ef4444;\n        background: white;\n        border-bottom: 3px solid #ef4444;\n    }\n    \n    .tab-content {\n        display: none;\n        padding: 24px;\n    }\n    \n    .tab-content.active {\n        display: block;\n    }\n    \n    /* Status Reprovado */\n    .status-reprovado {\n        background: #fee2e2;\n        color: #991b1b;\n        border: 2px solid #dc2626;\n    }\n    \n    /* Gr√°ficos Avan√ßados */\n    .chart-container {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        margin-bottom: 24px;\n    }\n    \n    .chart-title {\n        font-size: 16px;\n        font-weight: 700;\n        color: #1f2937;\n        margin-bottom: 16px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n    \n    .bar-chart {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n    }\n    \n    .bar-item {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n    }\n    \n    .bar-label {\n        min-width: 80px;\n        font-size: 12px;\n        font-weight: 600;\n        color: #374151;\n    }\n    \n    .bar-wrapper {\n        flex: 1;\n        height: 30px;\n        background: #f3f4f6;\n        border-radius: 6px;\n        overflow: hidden;\n    }\n    \n    .bar-fill {\n        height: 100%;\n        background: linear-gradient(90deg, #ef4444, #f59e0b);\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        padding-right: 8px;\n        transition: width 0.5s ease;\n    }\n    \n    .bar-value {\n        font-size: 11px;\n        font-weight: 700;\n        color: white;\n    }\n    \n    /* Heatmap */\n    .heatmap-grid {\n        display: grid;\n        grid-template-columns: repeat(24, 1fr);\n        gap: 4px;\n    }\n    \n    .heatmap-cell {\n        aspect-ratio: 1;\n        border-radius: 4px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 10px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: transform 0.2s;\n    }\n    \n    .heatmap-cell:hover {\n        transform: scale(1.2);\n        z-index: 10;\n    }\n    \n    /* Cards de Insight */\n    .insight-card {\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n    }\n    \n    .insight-value {\n        font-size: 28px;\n        font-weight: 900;\n        margin-bottom: 4px;\n    }\n    \n    .insight-description {\n        font-size: 11px;\n        opacity: 0.8;\n    }\n</style>\n\n<div class=\"intercorrencias-container\">\n    <!-- Header Principal -->\n    <div class=\"header-principal\">\n        <!-- Indicador Ao Vivo -->\n        <div class=\"live-indicator\">\n            <div class=\"live-dot\"></div>\n            AO VIVO\n        </div>\n        \n        <!-- Controles -->\n        <div class=\"controles-header\">\n            <button class=\"btn-controle\" onclick=\"atualizarDados()\">\n                üîÑ Atualizar\n            </button>\n            <button class=\"btn-controle\" onclick=\"exportarDados()\">\n                üìä Exportar\n            </button>\n            <button class=\"btn-controle\" onclick=\"debugSistema()\">\n                üîç Debug\n            </button>\n        </div>\n        \n        <div class=\"header-title\">\n            ‚ö†Ô∏è Central de Intercorr√™ncias BI 2.0\n        </div>\n        <div class=\"header-subtitle\">\n            Monitoramento e Gest√£o de Problemas em Tempo Real\n        </div>\n    </div>\n    \n    <!-- Estat√≠sticas -->\n    <div class=\"stats-row\">\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"totalIntercorrencias\">0</div>\n            <div class=\"stat-label\">Total de Intercorr√™ncias</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"intercorrenciasPendentes\">0</div>\n            <div class=\"stat-label\">‚è≥ Pendentes de Aprova√ß√£o</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"intercorrenciasAprovadas\">0</div>\n            <div class=\"stat-label\">‚úÖ Aprovadas</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #dc2626;\">\n            <div class=\"stat-value\" id=\"intercorrenciasReprovadas\" style=\"color: #dc2626;\">0</div>\n            <div class=\"stat-label\">‚ùå Reprovadas</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"tempoMedio\">00:00</div>\n            <div class=\"stat-label\">‚è∞ Tempo M√©dio</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"cidadesAfetadas\">0</div>\n            <div class=\"stat-label\">üèôÔ∏è Cidades Afetadas</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"motoboyEnvolvidos\">0</div>\n            <div class=\"stat-label\">üèçÔ∏è Motoboys Envolvidos</div>\n        </div>\n    </div>\n    \n    <!-- Estat√≠sticas Avan√ßadas - Diverg√™ncias -->\n    <div class=\"stats-row\">\n        <div class=\"stat-card\" style=\"border-top-color: #f59e0b;\">\n            <div class=\"stat-value\" id=\"totalClientes\" style=\"color: #f59e0b;\">0</div>\n            <div class=\"stat-label\">üë• Intercorr√™ncia por Cliente</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #06b6d4;\">\n            <div class=\"stat-value\" id=\"totalVendedores\" style=\"color: #06b6d4;\">0</div>\n            <div class=\"stat-label\">üíº Intercorr√™ncia por Vendedor</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #dc2626;\">\n            <div class=\"stat-value\" id=\"enderecoErrado\" style=\"color: #dc2626;\">0</div>\n            <div class=\"stat-label\">üìç Endere√ßo Errado</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #1e40af;\">\n            <div class=\"stat-value\" id=\"clientesNovos\" style=\"color: #1e40af;\">0</div>\n            <div class=\"stat-label\">üÜï Cliente Novo</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #8b5cf6;\">\n            <div class=\"stat-value\" id=\"clientesRecorrentes\" style=\"color: #8b5cf6;\">0</div>\n            <div class=\"stat-label\">üîÅ Cliente Recorrente</div>\n        </div>\n    </div>\n    \n    <!-- Estat√≠sticas - Atrasos e Tempos -->\n    <div class=\"stats-row\">\n        <div class=\"stat-card\" style=\"border-top-color: #ea580c;\">\n            <div class=\"stat-value\" id=\"somaAtrasosMotoboy\" style=\"color: #ea580c;\">00:00</div>\n            <div class=\"stat-label\">‚è±Ô∏è Soma dos Atrasos do Motoboy</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #0891b2;\">\n            <div class=\"stat-value\" id=\"tempoMedioSaida\" style=\"color: #0891b2;\">00:00</div>\n            <div class=\"stat-label\">üöÄ Tempo M√©dio de Sa√≠da</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #db2777;\">\n            <div class=\"stat-value\" id=\"tempoTotalAtrasoSaida\" style=\"color: #db2777;\">00:00</div>\n            <div class=\"stat-label\">üïê Tempo Total de Atraso de Sa√≠da</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #dc2626;\">\n            <div class=\"stat-value\" id=\"percTotalAtrasos\" style=\"color: #dc2626;\">0%</div>\n            <div class=\"stat-label\">üìâ % Total dos Atrasos</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #10b981;\">\n            <div class=\"stat-value\" id=\"taxaAprovacaoGeral\" style=\"color: #10b981;\">0%</div>\n            <div class=\"stat-label\">‚úì Taxa de Aprova√ß√£o Geral</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #f59e0b;\">\n            <div class=\"stat-value\" id=\"percEnderecoErrado\" style=\"color: #f59e0b;\">0%</div>\n            <div class=\"stat-label\">üìä % Endere√ßo Errado</div>\n        </div>\n    </div>\n    \n    <!-- Filtros -->\n    <div class=\"filtros-section\">\n        <div class=\"filtros-title\">\n            üîç Filtros Avan√ßados\n        </div>\n        <div class=\"filtros-grid\">\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üìä Status de Aprova√ß√£o</div>\n                <select class=\"filtro-control\" id=\"filtroAprovacao\" onchange=\"aplicarFiltros()\">\n                    <option value=\"\">Todos</option>\n                    <option value=\"TRUE\">‚úÖ Aprovadas</option>\n                    <option value=\"PENDENTE\">‚è≥ Pendentes</option>\n                    <option value=\"FALSE\">‚ùå Reprovadas</option>\n                </select>\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üèôÔ∏è Cidade</div>\n                <select class=\"filtro-control\" id=\"filtroCidade\" onchange=\"aplicarFiltros()\">\n                    <option value=\"\">Todas</option>\n                </select>\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üèçÔ∏è Motoboy</div>\n                <select class=\"filtro-control\" id=\"filtroMotoboy\" onchange=\"aplicarFiltros()\">\n                    <option value=\"\">Todos</option>\n                </select>\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üìÖ Data</div>\n                <input type=\"date\" class=\"filtro-control\" id=\"filtroData\" onchange=\"aplicarFiltros()\">\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üì¶ Pedido</div>\n                <input type=\"text\" class=\"filtro-control\" id=\"filtroPedido\" placeholder=\"N√∫mero do pedido\" onchange=\"aplicarFiltros()\">\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üßπ A√ß√µes</div>\n                <button class=\"btn-limpar-filtros\" onclick=\"limparFiltros()\">\n                    üßπ Limpar Filtros\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Sistema de Abas -->\n    <div class=\"tabs-container\">\n        <div class=\"tabs-header\">\n            <button class=\"tab-button active\" onclick=\"mudarAba('dashboard')\">\n                üìä Dashboard\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('intercorrencias')\">\n                üìã Intercorr√™ncias\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('divergencias')\">\n                ‚ö†Ô∏è Diverg√™ncias\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('motoboys')\">\n                üèçÔ∏è An√°lise por Motoboy\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('estados')\">\n                üó∫Ô∏è An√°lise por Estado/UF\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('analytics')\">\n                üìà Analytics Avan√ßados\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('percentuais')\">\n                üìä Estratifica√ß√£o %\n            </button>\n        </div>\n        \n        <!-- Tab: Dashboard -->\n        <div class=\"tab-content active\" id=\"tabDashboard\">\n            <!-- Analytics e Gr√°ficos -->\n            <div class=\"analytics-section\" style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-left: 5px solid #10b981;\">\n                <div style=\"font-size: 18px; font-weight: 700; color: #10b981; margin-bottom: 16px; display: flex; align-items: center; justify-content: space-between;\">\n                    <span>üìä Analytics - Tempo de Intercorr√™ncias</span>\n                    <button onclick=\"toggleAnalytics()\" style=\"background: #10b981; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 10px; cursor: pointer;\" id=\"btnToggleAnalytics\">\n                        üìä Recolher\n                    </button>\n                </div>\n                <div id=\"analyticsContent\">\n        \n        <!-- Totais por Filial -->\n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 10px;\">üè¢ Por Filial:</div>\n            <div id=\"graficoFiliais\" style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;\">\n                <!-- Ser√° preenchido via JavaScript -->\n            </div>\n        </div>\n        \n        <!-- Totais por Motoboy -->\n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 10px;\">üèçÔ∏è Por Motoboy:</div>\n            <div id=\"graficoMotoboys\" style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;\">\n                <!-- Ser√° preenchido via JavaScript -->\n            </div>\n        </div>\n        \n        <!-- Totais por Cidade -->\n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 10px;\">üèôÔ∏è Por Cidade:</div>\n            <div id=\"graficoCidades\" style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;\">\n                <!-- Ser√° preenchido via JavaScript -->\n            </div>\n        </div>\n        \n        <!-- Rankings -->\n        <div style=\"border-top: 2px solid #e5e7eb; padding-top: 16px;\">\n            <div style=\"font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 12px;\">üèÜ Rankings:</div>\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;\" id=\"rankingsContainer\">\n                <!-- Rankings ser√£o inseridos aqui -->\n            </div>\n        </div>\n                </div> <!-- Fechar analyticsContent -->\n            </div>\n        </div>\n        \n        <!-- Tab: Intercorr√™ncias -->\n        <div class=\"tab-content\" id=\"tabIntercorrencias\">\n            <!-- Controles de Visualiza√ß√£o -->\n            <div class=\"view-controls\">\n        <div>\n            <button class=\"btn-modo ativo\" id=\"btnCards\" onclick=\"alterarModo('cards')\">\n                üì± Cards\n            </button>\n            <button class=\"btn-modo\" id=\"btnLista\" onclick=\"alterarModo('lista')\">\n                üìã Lista Compacta\n            </button>\n        </div>\n        <div style=\"font-size: 12px; color: #6b7280; font-weight: 600;\">\n            <span id=\"resultadosFiltro\">Mostrando todas as intercorr√™ncias</span>\n        </div>\n    </div>\n    \n    <!-- Grid de Cards -->\n    <div class=\"intercorrencias-grid\" id=\"intercorrenciasGrid\">\n        <div class=\"loading\">\n            ‚ö†Ô∏è Carregando intercorr√™ncias...\n        </div>\n    </div>\n    \n    <!-- Lista Compacta -->\n    <div class=\"intercorrencias-lista\" id=\"intercorrenciasLista\">\n        <div class=\"lista-header\">\n            <div>ID</div>\n            <div>Pedido</div>\n            <div>Motoboy</div>\n            <div>Cidade</div>\n            <div>Data</div>\n            <div>Tempo</div>\n            <div>Descri√ß√£o</div>\n            <div>Status</div>\n            <div>A√ß√µes</div>\n        </div>\n        <div id=\"listaBody\">\n                <!-- Lista ser√° inserida aqui -->\n            </div>\n        </div>\n        </div>\n        \n        <!-- Tab: Diverg√™ncias -->\n        <div class=\"tab-content\" id=\"tabDivergencias\">\n            <!-- Header da Aba -->\n            <div style=\"background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); border-radius: 12px; padding: 24px; margin-bottom: 24px; color: white; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);\">\n                <h2 style=\"margin: 0 0 8px 0; font-size: 28px; font-weight: 900;\">‚ö†Ô∏è An√°lise de Diverg√™ncias</h2>\n                <p style=\"margin: 0; opacity: 0.9; font-size: 14px;\">An√°lise detalhada de clientes, vendedores e endere√ßos com problemas</p>\n            </div>\n            \n            <!-- An√°lise por Cliente -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #f59e0b;\">\n                <div class=\"chart-title\" style=\"color: #f59e0b;\">üë• Intercorr√™ncias por Cliente</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Clientes com maior volume de intercorr√™ncias e recorr√™ncia de problemas</p>\n                \n                <!-- Tabela de Clientes -->\n                <div id=\"tabelaClientes\" style=\"overflow-x: auto;\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- An√°lise por Vendedor -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #06b6d4;\">\n                <div class=\"chart-title\" style=\"color: #06b6d4;\">üíº Ranking de Vendedores com Intercorr√™ncias</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Vendedores envolvidos em intercorr√™ncias e suas taxas de aprova√ß√£o</p>\n                \n                <!-- Tabela de Vendedores -->\n                <div id=\"tabelaVendedores\" style=\"overflow-x: auto;\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- An√°lise de Cliente Novo -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #1e40af;\">\n                <div class=\"chart-title\" style=\"color: #1e40af;\">üÜï An√°lise: Cliente Novo</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Identifica√ß√£o e an√°lise de intercorr√™ncias relacionadas a clientes novos</p>\n                \n                <!-- Cards de Estat√≠sticas de Cliente Novo -->\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px;\">\n                    <div class=\"performance-card\" style=\"background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üÜï</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #1e40af;\" id=\"cnTotalClientesNovos\">0</div>\n                        <div style=\"font-size: 12px; opacity: 0.8; color: #1e3a8a;\">Total Clientes Novos</div>\n                    </div>\n                    <div class=\"performance-card\" style=\"background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">‚ö†Ô∏è</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #dc2626;\" id=\"cnIntercorrencias\">0</div>\n                        <div style=\"font-size: 12px; opacity: 0.8; color: #991b1b;\">Intercorr√™ncias</div>\n                    </div>\n                    <div class=\"performance-card\" style=\"background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üîÅ</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #7c3aed;\" id=\"cnRecorrentes\">0</div>\n                        <div style=\"font-size: 12px; opacity: 0.8; color: #5b21b6;\">Recorrentes</div>\n                    </div>\n                    <div class=\"performance-card\" style=\"background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üìä</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #f59e0b;\" id=\"cnPercentual\">0%</div>\n                        <div style=\"font-size: 12px; opacity: 0.8; color: #92400e;\">% do Total</div>\n                    </div>\n                </div>\n                \n                \n                <div id=\"tabelaClientesNovos\" style=\"overflow-x: auto;\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- An√°lise de Endere√ßo Errado -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #dc2626;\">\n                <div class=\"chart-title\" style=\"color: #dc2626;\">üìç An√°lise: Endere√ßo Errado</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Detalhamento espec√≠fico de intercorr√™ncias relacionadas a erro de endere√ßo</p>\n                \n                <!-- Cards de Estat√≠sticas de Endere√ßo Errado -->\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px;\">\n                    <div class=\"performance-card\" style=\"background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üìç</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #dc2626;\" id=\"endTotalErros\">0</div>\n                        <div style=\"font-size: 12px; opacity: 0.8; color: #991b1b;\">Total Endere√ßos Errados</div>\n                    </div>\n                    <div class=\"performance-card\" style=\"background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üìä</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #f59e0b;\" id=\"endPercentual\">0%</div>\n                        <div style=\"font-size: 12px; opacity: 0.8; color: #92400e;\">% do Total</div>\n                    </div>\n                    <div class=\"performance-card\" style=\"background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üÜï</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #1e40af;\" id=\"endClientesNovosEnd\">0</div>\n                        <div style=\"font-size: 12px; opacity: 0.8; color: #1e3a8a;\">Clientes Novos</div>\n                    </div>\n                    <div class=\"performance-card\" style=\"background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">‚úÖ</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #10b981;\" id=\"endTaxaAprovacao\">0%</div>\n                        <div style=\"font-size: 12px; opacity: 0.8; color: #065f46;\">Taxa de Aprova√ß√£o</div>\n                    </div>\n                </div>\n                \n                <!-- Estratifica√ß√£o Detalhada -->\n                <div style=\"background: #f9fafb; padding: 16px; border-radius: 8px; margin-bottom: 20px;\">\n                    <h4 style=\"margin: 0 0 16px 0; color: #1f2937; font-size: 14px; font-weight: 700;\">üéØ Estratifica√ß√£o Detalhada</h4>\n                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px;\">\n                        <div style=\"background: white; padding: 12px; border-radius: 8px; border: 2px solid #dbeafe;\">\n                            <div style=\"font-weight: 700; color: #1e40af; margin-bottom: 4px;\">üÜï Cliente Novo</div>\n                            <div id=\"endClienteNovo\" style=\"font-size: 24px; font-weight: 900; color: #1e40af;\">0</div>\n                        </div>\n                        <div style=\"background: white; padding: 12px; border-radius: 8px; border: 2px solid #fecaca;\">\n                            <div style=\"font-weight: 700; color: #dc2626; margin-bottom: 4px;\">‚öôÔ∏è Erro Operacional</div>\n                            <div id=\"endErroOperacional\" style=\"font-size: 24px; font-weight: 900; color: #dc2626;\">0</div>\n                        </div>\n                        <div style=\"background: white; padding: 12px; border-radius: 8px; border: 2px solid #fde68a;\">\n                            <div style=\"font-weight: 700; color: #f59e0b; margin-bottom: 4px;\">‚úçÔ∏è Erro de Digita√ß√£o</div>\n                            <div id=\"endErroDigitacao\" style=\"font-size: 24px; font-weight: 900; color: #f59e0b;\">0</div>\n                        </div>\n                        <div style=\"background: white; padding: 12px; border-radius: 8px; border: 2px solid #d1fae5;\">\n                            <div style=\"font-weight: 700; color: #10b981; margin-bottom: 4px;\">üíº Erro do Vendedor</div>\n                            <div id=\"endErroVendedor\" style=\"font-size: 24px; font-weight: 900; color: #10b981;\">0</div>\n                        </div>\n                    </div>\n                </div>\n                \n                <!-- Estratifica√ß√£o de Endere√ßo Errado -->\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 20px;\">\n                    <div>\n                        <h4 style=\"margin: 0 0 12px 0; color: #1f2937; font-size: 14px; font-weight: 700;\">üìã Por Categoria</h4>\n                        <div id=\"endCategoria\" class=\"bar-chart\">\n                            <!-- Ser√° preenchido via JavaScript -->\n                        </div>\n                    </div>\n                    <div>\n                        <h4 style=\"margin: 0 0 12px 0; color: #1f2937; font-size: 14px; font-weight: 700;\">üèôÔ∏è Por Cidade</h4>\n                        <div id=\"endCidade\" class=\"bar-chart\">\n                            <!-- Ser√° preenchido via JavaScript -->\n                        </div>\n                    </div>\n                </div>\n                \n                <!-- Lista Detalhada de Endere√ßos Errados -->\n                <div style=\"margin-top: 20px;\">\n                    <h4 style=\"margin: 0 0 12px 0; color: #1f2937; font-size: 14px; font-weight: 700;\">üìã Detalhes das Intercorr√™ncias</h4>\n                    <div id=\"listaEnderecoErrado\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Gr√°ficos Comparativos -->\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n                <div class=\"chart-container\">\n                    <div class=\"chart-title\">üîÑ Clientes com Maior Recorr√™ncia</div>\n                    <div id=\"graficoClientesRecorrentes\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                <div class=\"chart-container\">\n                    <div class=\"chart-title\">üíº Vendedores: Top 10 com Mais Intercorr√™ncias</div>\n                    <div id=\"graficoTopVendedores\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n            </div>\n            \n            <!-- AN√ÅLISE INTELIGENTE DE PADR√ïES -->\n            <div style=\"background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%); border-radius: 12px; padding: 24px; margin-bottom: 24px; color: white; box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);\">\n                <h2 style=\"margin: 0 0 8px 0; font-size: 24px; font-weight: 900; display: flex; align-items: center; gap: 12px;\">\n                    <span style=\"font-size: 32px;\">üîç</span>\n                    An√°lise Inteligente de Padr√µes\n                </h2>\n                <p style=\"margin: 0; opacity: 0.9; font-size: 13px;\">Identifica√ß√£o autom√°tica de correla√ß√µes e padr√µes problem√°ticos</p>\n            </div>\n            \n            <!-- Filtros de An√°lise -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #7c3aed;\">\n                <div class=\"chart-title\" style=\"color: #7c3aed; display: flex; justify-content: space-between; align-items: center;\">\n                    <span>üéØ Filtros de An√°lise Inteligente</span>\n                    <button onclick=\"aplicarFiltrosDivergencias()\" \n                            style=\"background: #7c3aed; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;\"\n                            onmouseover=\"this.style.background='#6d28d9'\"\n                            onmouseout=\"this.style.background='#7c3aed'\">\n                        üîç Analisar\n                    </button>\n                </div>\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 16px;\">\n                    <div>\n                        <label style=\"font-size: 12px; font-weight: 600; color: #6b7280; display: block; margin-bottom: 4px;\">üíº Vendedor</label>\n                        <select id=\"filtroDivVendedor\" style=\"width: 100%; padding: 8px; border: 2px solid #e5e7eb; border-radius: 6px; font-size: 12px;\">\n                            <option value=\"\">Todos</option>\n                        </select>\n                    </div>\n                    <div>\n                        <label style=\"font-size: 12px; font-weight: 600; color: #6b7280; display: block; margin-bottom: 4px;\">üè¢ Filial</label>\n                        <select id=\"filtroDivFilial\" style=\"width: 100%; padding: 8px; border: 2px solid #e5e7eb; border-radius: 6px; font-size: 12px;\">\n                            <option value=\"\">Todas</option>\n                        </select>\n                    </div>\n                    <div>\n                        <label style=\"font-size: 12px; font-weight: 600; color: #6b7280; display: block; margin-bottom: 4px;\">üèçÔ∏è Motoboy</label>\n                        <select id=\"filtroDivMotoboy\" style=\"width: 100%; padding: 8px; border: 2px solid #e5e7eb; border-radius: 6px; font-size: 12px;\">\n                            <option value=\"\">Todos</option>\n                        </select>\n                    </div>\n                    <div>\n                        <label style=\"font-size: 12px; font-weight: 600; color: #6b7280; display: block; margin-bottom: 4px;\">üìç Categoria</label>\n                        <select id=\"filtroDivCategoria\" style=\"width: 100%; padding: 8px; border: 2px solid #e5e7eb; border-radius: 6px; font-size: 12px;\">\n                            <option value=\"\">Todas</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Padr√µes Identificados Automaticamente -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #dc2626;\">\n                <div class=\"chart-title\" style=\"color: #dc2626;\">‚ö†Ô∏è Padr√µes Problem√°ticos Identificados</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Combina√ß√µes com alta incid√™ncia de intercorr√™ncias</p>\n                <div id=\"padroesProblematicos\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Matriz de Correla√ß√µes -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #7c3aed;\">\n                <div class=\"chart-title\" style=\"color: #7c3aed;\">üîó Matriz de Correla√ß√µes</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">An√°lise de correla√ß√µes entre Vendedor, Motoboy, Filial e Categoria</p>\n                <div id=\"matrizCorrelacoes\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Insights de Recorr√™ncia -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #f59e0b;\">\n                <div class=\"chart-title\" style=\"color: #f59e0b;\">üí° Insights de Recorr√™ncia</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">An√°lises autom√°ticas de padr√µes repetitivos</p>\n                <div id=\"insightsRecorrencia\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Tabela de Combina√ß√µes Cr√≠ticas -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #ef4444;\">\n                <div class=\"chart-title\" style=\"color: #ef4444;\">üéØ Top 20 Combina√ß√µes Cr√≠ticas</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Combina√ß√µes Vendedor + Filial + Motoboy com mais problemas</p>\n                <div id=\"tabelaCombinacoesCriticas\" style=\"overflow-x: auto;\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Timeline de Tend√™ncias -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #8b5cf6;\">\n                <div class=\"chart-title\" style=\"color: #8b5cf6;\">üìà Tend√™ncia de Diverg√™ncias ao Longo do Tempo</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Evolu√ß√£o temporal de intercorr√™ncias e padr√µes identificados</p>\n                <div id=\"timelineTendencias\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Recomenda√ß√µes Autom√°ticas -->\n            <div class=\"chart-container\" style=\"background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-left: 5px solid #f59e0b;\">\n                <div class=\"chart-title\" style=\"color: #f59e0b; display: flex; align-items: center; gap: 12px;\">\n                    <span style=\"font-size: 32px;\">üí°</span>\n                    Recomenda√ß√µes Inteligentes\n                </div>\n                <p style=\"margin-bottom: 16px; color: #78350f; font-size: 12px; font-weight: 600;\">Sugest√µes autom√°ticas baseadas na an√°lise de padr√µes</p>\n                <div id=\"recomendacoesAutomaticas\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Comparativo de Performance -->\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n                <div class=\"chart-container\" style=\"border-left: 5px solid #10b981;\">\n                    <div class=\"chart-title\" style=\"color: #10b981;\">üèÜ Top 5 Melhores Performers</div>\n                    <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Vendedores com melhor taxa de aprova√ß√£o</p>\n                    <div id=\"topMelhoresPerformers\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                <div class=\"chart-container\" style=\"border-left: 5px solid #dc2626;\">\n                    <div class=\"chart-title\" style=\"color: #dc2626;\">‚ö†Ô∏è Top 5 Necessitam Aten√ß√£o</div>\n                    <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">Vendedores com maior taxa de reprova√ß√£o</p>\n                    <div id=\"topNecessitamAtencao\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n            </div>\n            \n            <!-- An√°lise de Impacto Financeiro (se dispon√≠vel) -->\n            <div class=\"chart-container\" style=\"border-left: 5px solid #059669;\">\n                <div class=\"chart-title\" style=\"color: #059669;\">üí∞ Estimativa de Impacto</div>\n                <p style=\"margin-bottom: 16px; color: #6b7280; font-size: 12px;\">An√°lise do impacto potencial das intercorr√™ncias</p>\n                <div id=\"analiseImpacto\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n        </div>\n        \n        <!-- Tab: An√°lise por Motoboy -->\n        <div class=\"tab-content\" id=\"tabMotoboys\">\n            <div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);\">\n                <div style=\"display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;\">\n                    <h3 style=\"color: #1890ff; margin: 0;\">üèçÔ∏è Selecione um Motoboy para An√°lise Detalhada</h3>\n                    <select id=\"selectMotoboy\" onchange=\"analisarMotoboy(this.value)\" style=\"padding: 10px; border-radius: 8px; border: 2px solid #1890ff; font-weight: 600; font-size: 14px; min-width: 300px;\">\n                        <option value=\"\">Selecione um motoboy...</option>\n                    </select>\n                </div>\n                \n                <!-- Cards de Insight do Motoboy -->\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;\">\n                    <div class=\"performance-card\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üìä</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #1890ff;\" id=\"mbTotalIntercorrencias\">-</div>\n                        <div style=\"font-size: 12px; opacity: 0.8;\">Total de Intercorr√™ncias</div>\n                    </div>\n                    <div class=\"performance-card\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">‚úÖ</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #10b981;\" id=\"mbTaxaAprovacao\">-</div>\n                        <div style=\"font-size: 12px; opacity: 0.8;\">Taxa de Aprova√ß√£o</div>\n                    </div>\n                    <div class=\"performance-card\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">‚è±Ô∏è</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #f59e0b;\" id=\"mbTempoMedio\">-</div>\n                        <div style=\"font-size: 12px; opacity: 0.8;\">Tempo M√©dio</div>\n                    </div>\n                </div>\n                \n                <!-- Gr√°ficos do Motoboy -->\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üìä Status das Intercorr√™ncias</div>\n                        <div id=\"mbGraficoStatus\"></div>\n                    </div>\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üèôÔ∏è Cidades Atendidas</div>\n                        <div id=\"mbGraficoCidades\"></div>\n                    </div>\n                </div>\n                \n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üïê Distribui√ß√£o por Hor√°rio</div>\n                        <div id=\"mbGraficoHorarios\"></div>\n                    </div>\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üî• Principais Problemas</div>\n                        <div id=\"mbGraficoProblemas\"></div>\n                    </div>\n                </div>\n                \n                <!-- Hist√≥rico Recente -->\n                <div class=\"chart-container\">\n                    <div class=\"chart-title\">üìã Hist√≥rico Recente de Intercorr√™ncias</div>\n                    <div id=\"mbHistorico\"></div>\n                </div>\n            </div>\n            \n            <!-- Tabela de Compara√ß√£o entre Motoboys -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üèÜ Ranking de Motoboys</div>\n                <div id=\"tabelaComparacaoMotoboys\"></div>\n            </div>\n        </div>\n        \n        <!-- Tab: An√°lise por Estado/UF -->\n        <div class=\"tab-content\" id=\"tabEstados\">\n            <div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);\">\n                <div style=\"display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;\">\n                    <h3 style=\"color: #10b981; margin: 0;\">üó∫Ô∏è Selecione um Estado (UF) para An√°lise Detalhada</h3>\n                    <select id=\"selectEstado\" onchange=\"analisarEstado(this.value)\" style=\"padding: 10px; border-radius: 8px; border: 2px solid #10b981; font-weight: 600; font-size: 14px; min-width: 300px;\">\n                        <option value=\"\">Selecione um estado...</option>\n                    </select>\n                </div>\n                \n                <!-- Cards de Insight do Estado -->\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;\">\n                    <div class=\"performance-card\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üìä</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #10b981;\" id=\"estTotalIntercorrencias\">-</div>\n                        <div style=\"font-size: 12px; opacity: 0.8;\">Total de Intercorr√™ncias</div>\n                    </div>\n                    <div class=\"performance-card\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">‚úÖ</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #10b981;\" id=\"estTaxaAprovacao\">-</div>\n                        <div style=\"font-size: 12px; opacity: 0.8;\">Taxa de Aprova√ß√£o</div>\n                    </div>\n                    <div class=\"performance-card\">\n                        <div style=\"font-size: 32px; margin-bottom: 8px;\">üèçÔ∏è</div>\n                        <div style=\"font-size: 28px; font-weight: 900; color: #f59e0b;\" id=\"estTotalMotoboys\">-</div>\n                        <div style=\"font-size: 12px; opacity: 0.8;\">Motoboys Ativos</div>\n                    </div>\n                </div>\n                \n                <!-- Gr√°ficos do Estado -->\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üìä Status das Intercorr√™ncias</div>\n                        <div id=\"estGraficoStatus\"></div>\n                    </div>\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üèôÔ∏è Cidades do Estado</div>\n                        <div id=\"estGraficoCidades\"></div>\n                    </div>\n                </div>\n                \n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üèçÔ∏è Motoboys Atuantes</div>\n                        <div id=\"estGraficoMotoboys\"></div>\n                    </div>\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üî• Principais Problemas</div>\n                        <div id=\"estGraficoProblemas\"></div>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Tabela de Compara√ß√£o entre Estados -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üó∫Ô∏è Ranking por Estado (UF)</div>\n                <div id=\"tabelaComparacaoEstados\"></div>\n            </div>\n        </div>\n        \n        <!-- Tab: Analytics Avan√ßados -->\n        <div class=\"tab-content\" id=\"tabAnalytics\">\n            <!-- Insights Cards -->\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n                <div class=\"insight-card\" id=\"insightHorarioPico\">\n                    <div style=\"font-size: 32px; margin-bottom: 12px;\">‚è∞</div>\n                    <div style=\"font-size: 14px; font-weight: 700; margin-bottom: 8px; opacity: 0.9;\">Hor√°rio de Pico</div>\n                    <div class=\"insight-value\">--:--</div>\n                    <div class=\"insight-description\">Hor√°rio com mais intercorr√™ncias</div>\n                </div>\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\">\n                    <div style=\"font-size: 32px; margin-bottom: 12px;\">üìà</div>\n                    <div style=\"font-size: 14px; font-weight: 700; margin-bottom: 8px; opacity: 0.9;\">Taxa de Aprova√ß√£o</div>\n                    <div class=\"insight-value\" id=\"insightTaxaAprovacao\">0%</div>\n                    <div class=\"insight-description\">Percentual de intercorr√™ncias aprovadas</div>\n                </div>\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\">\n                    <div style=\"font-size: 32px; margin-bottom: 12px;\">‚ö°</div>\n                    <div style=\"font-size: 14px; font-weight: 700; margin-bottom: 8px; opacity: 0.9;\">Tempo de Resposta</div>\n                    <div class=\"insight-value\" id=\"insightTempoResposta\">--:--</div>\n                    <div class=\"insight-description\">Tempo m√©dio at√© aprova√ß√£o</div>\n                </div>\n            </div>\n            \n            <!-- Heatmap de Hor√°rios -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üïê Heatmap - Intercorr√™ncias por Hor√°rio</div>\n                <div style=\"margin-bottom: 12px; font-size: 12px; color: #6b7280;\">\n                    Visualize em quais hor√°rios do dia ocorrem mais intercorr√™ncias\n                </div>\n                <div class=\"heatmap-grid\" id=\"heatmapHorarios\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n                <div style=\"display: flex; justify-content: center; align-items: center; gap: 16px; margin-top: 12px; font-size: 11px;\">\n                    <div style=\"display: flex; align-items: center; gap: 4px;\">\n                        <div style=\"width: 20px; height: 20px; background: #ecfdf5; border-radius: 4px;\"></div>\n                        <span>Baixo (0-2)</span>\n                    </div>\n                    <div style=\"display: flex; align-items: center; gap: 4px;\">\n                        <div style=\"width: 20px; height: 20px; background: #a7f3d0; border-radius: 4px;\"></div>\n                        <span>M√©dio (3-5)</span>\n                    </div>\n                    <div style=\"display: flex; align-items: center; gap: 4px;\">\n                        <div style=\"width: 20px; height: 20px; background: #fef3c7; border-radius: 4px;\"></div>\n                        <span>Alto (6-10)</span>\n                    </div>\n                    <div style=\"display: flex; align-items: center; gap: 4px;\">\n                        <div style=\"width: 20px; height: 20px; background: #fecaca; border-radius: 4px;\"></div>\n                        <span>Cr√≠tico (10+)</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Gr√°ficos de Distribui√ß√£o -->\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n                <!-- Por Dia da Semana -->\n                <div class=\"chart-container\">\n                    <div class=\"chart-title\">üìÖ Distribui√ß√£o por Dia da Semana</div>\n                    <div class=\"bar-chart\" id=\"graficoDiaSemana\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Por Per√≠odo do Dia -->\n                <div class=\"chart-container\">\n                    <div class=\"chart-title\">üåÖ Distribui√ß√£o por Per√≠odo do Dia</div>\n                    <div class=\"bar-chart\" id=\"graficoPeriodoDia\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n            </div>\n            \n            <!-- An√°lise de Tempo de Resolu√ß√£o -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">‚è±Ô∏è An√°lise de Tempo de Resolu√ß√£o</div>\n                <div class=\"bar-chart\" id=\"graficoTempoResolucao\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Top Causas -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üî• Top 10 Causas Mais Frequentes</div>\n                <div class=\"bar-chart\" id=\"graficoTopCausas\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Timeline 24h -->\n            <div class=\"chart-container\" style=\"grid-column: 1 / -1; background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%); border: 2px solid #e5e7eb; position: relative; overflow: hidden;\">\n                <!-- Header do gr√°fico -->\n                <div style=\"background: linear-gradient(135deg, #1890ff 0%, #0066cc 100%); padding: 20px; margin: -20px -20px 20px -20px; color: white; position: relative; overflow: hidden;\">\n                    <div style=\"position: absolute; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.1; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.1) 10px, rgba(255,255,255,0.1) 20px);\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"display: flex; align-items: center; justify-content: space-between;\">\n                            <div>\n                                <h3 style=\"margin: 0; font-size: 20px; font-weight: 900; display: flex; align-items: center; gap: 12px;\">\n                                    <span style=\"font-size: 32px;\">üìà</span>\n                                    Mapa de Intercorr√™ncias 24h\n                                </h3>\n                                <p style=\"margin: 8px 0 0 0; font-size: 13px; opacity: 0.9;\">Timeline interativo: clique nas bolas para ver detalhes de cada hora</p>\n                            </div>\n                            <div style=\"background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); padding: 12px 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3);\">\n                                <div style=\"font-size: 11px; opacity: 0.9; margin-bottom: 4px;\">Total de Intercorr√™ncias</div>\n                                <div id=\"timelineTotalCount\" style=\"font-size: 28px; font-weight: 900;\">0</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                \n                <!-- Gr√°fico -->\n                <div id=\"timelineChart\" style=\"min-height: 320px; padding: 20px; background: white; border-radius: 12px; box-shadow: inset 0 2px 8px rgba(0,0,0,0.03);\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n        </div>\n        \n        <!-- Tab: Estratifica√ß√£o Percentual -->\n        <div class=\"tab-content\" id=\"tabPercentuais\">\n            <!-- Header da Aba -->\n            <div style=\"background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); border-radius: 12px; padding: 24px; margin-bottom: 24px; color: white; box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);\">\n                <h2 style=\"margin: 0 0 8px 0; font-size: 28px; font-weight: 900;\">üìä Estratifica√ß√£o Percentual</h2>\n                <p style=\"margin: 0; opacity: 0.9; font-size: 14px;\">Visualiza√ß√£o completa de todos os dados em percentuais para an√°lise comparativa</p>\n            </div>\n            \n            <!-- Grid de Gr√°ficos Percentuais -->\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 24px; margin-bottom: 24px;\">\n                \n                <!-- Percentual por Categoria -->\n                <div class=\"chart-container\" style=\"border-left: 5px solid #ef4444;\">\n                    <div class=\"chart-title\" style=\"color: #ef4444;\">üìç Distribui√ß√£o por Categoria</div>\n                    <div id=\"percCategoria\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Percentual por Status -->\n                <div class=\"chart-container\" style=\"border-left: 5px solid #10b981;\">\n                    <div class=\"chart-title\" style=\"color: #10b981;\">‚úÖ Distribui√ß√£o por Status de Aprova√ß√£o</div>\n                    <div id=\"percStatus\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Percentual por Filial -->\n                <div class=\"chart-container\" style=\"border-left: 5px solid #3b82f6;\">\n                    <div class=\"chart-title\" style=\"color: #3b82f6;\">üè¢ Distribui√ß√£o por Filial</div>\n                    <div id=\"percFilial\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Percentual por Cidade -->\n                <div class=\"chart-container\" style=\"border-left: 5px solid #f59e0b;\">\n                    <div class=\"chart-title\" style=\"color: #f59e0b;\">üèôÔ∏è Distribui√ß√£o por Cidade</div>\n                    <div id=\"percCidade\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Percentual por Motoboy -->\n                <div class=\"chart-container\" style=\"border-left: 5px solid #8b5cf6;\">\n                    <div class=\"chart-title\" style=\"color: #8b5cf6;\">üèçÔ∏è Distribui√ß√£o por Motoboy (Top 10)</div>\n                    <div id=\"percMotoboy\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Percentual por Vendedor -->\n                <div class=\"chart-container\" style=\"border-left: 5px solid #06b6d4;\">\n                    <div class=\"chart-title\" style=\"color: #06b6d4;\">üíº Distribui√ß√£o por Vendedor (Top 10)</div>\n                    <div id=\"percVendedor\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Percentual por Dia da Semana -->\n                <div class=\"chart-container\" style=\"border-left: 5px solid #ec4899;\">\n                    <div class=\"chart-title\" style=\"color: #ec4899;\">üìÖ Distribui√ß√£o por Dia da Semana</div>\n                    <div id=\"percDiaSemana\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Percentual por Per√≠odo do Dia -->\n                <div class=\"chart-container\" style=\"border-left: 5px solid #14b8a6;\">\n                    <div class=\"chart-title\" style=\"color: #14b8a6;\">üïê Distribui√ß√£o por Per√≠odo do Dia</div>\n                    <div id=\"percPeriodoDia\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Resumo Geral em Percentuais -->\n            <div class=\"chart-container\" style=\"background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%); border-left: 5px solid #6b7280;\">\n                <div class=\"chart-title\" style=\"color: #374151;\">üìà Resumo Geral - Principais Indicadores %</div>\n                <div id=\"resumoPercentual\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Modal de Imagem -->\n<div id=\"modalImagem\" class=\"modal\">\n    <div class=\"modal-content\">\n        <div class=\"modal-header\">\n            <div class=\"modal-title\">üì∑ Foto da Intercorr√™ncia</div>\n            <button class=\"close\" onclick=\"fecharModal()\">&times;</button>\n        </div>\n        <div id=\"modalImagemConteudo\">\n            <!-- Imagem ser√° inserida aqui -->\n        </div>\n    </div>\n</div>\n\n<!-- Modal de Timeline (Detalhes por Hora) -->\n<div id=\"modalTimelineHora\" class=\"modal\">\n    <div class=\"modal-content\" style=\"max-width: 900px; max-height: 90vh; overflow-y: auto;\">\n        <div style=\"position: sticky; top: 0; background: white; z-index: 10; padding-bottom: 16px; border-bottom: 2px solid #f3f4f6;\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n                <h2 id=\"modalTimelineTitulo\" style=\"color: #1890ff; margin: 0;\">üìà Intercorr√™ncias das 00:00 - 01:00</h2>\n                <span class=\"close\" onclick=\"fecharModalTimeline()\" style=\"cursor: pointer; font-size: 32px; color: #6b7280;\">&times;</span>\n            </div>\n            <div id=\"modalTimelineStats\" style=\"display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 16px;\">\n                <!-- Estat√≠sticas ser√£o inseridas aqui -->\n            </div>\n        </div>\n        <div id=\"modalTimelineConteudo\" style=\"padding-top: 16px;\">\n            <!-- Intercorr√™ncias ser√£o listadas aqui -->\n        </div>\n    </div>\n</div>\n\n<!-- Modal de Debug -->\n<div id=\"modalDebug\" class=\"modal\">\n    <div class=\"modal-content\" style=\"max-width: 1000px; max-height: 90vh; overflow-y: auto;\">\n        <div style=\"position: sticky; top: 0; background: white; z-index: 10; padding-bottom: 16px; border-bottom: 2px solid #f3f4f6;\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n                <h2 style=\"color: #8b5cf6; margin: 0;\">üîç Debug - Sistema de Intercorr√™ncias</h2>\n                <span class=\"close\" onclick=\"fecharModalDebug()\" style=\"cursor: pointer; font-size: 32px; color: #6b7280;\">&times;</span>\n            </div>\n        </div>\n        <div id=\"modalDebugConteudo\" style=\"padding-top: 16px;\">\n            <!-- Informa√ß√µes de debug ser√£o inseridas aqui -->\n        </div>\n    </div>\n</div>\n\n<!-- Modal de Detalhes da Intercorr√™ncia -->\n<div id=\"modalDetalhesIntercorrencia\" class=\"modal\">\n    <div class=\"modal-content\" style=\"max-width: 1200px; max-height: 90vh; overflow-y: auto;\">\n        <div style=\"position: sticky; top: 0; background: white; z-index: 10; padding-bottom: 16px; border-bottom: 2px solid #f3f4f6; box-shadow: 0 2px 8px rgba(0,0,0,0.1);\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n                <h2 id=\"modalDetalhesTitulo\" style=\"color: #ef4444; margin: 0; display: flex; align-items: center; gap: 12px;\">\n                    <span style=\"font-size: 32px;\">üìã</span>\n                    Detalhes da Intercorr√™ncia\n                </h2>\n                <span class=\"close\" onclick=\"fecharModalDetalhes()\" style=\"cursor: pointer; font-size: 32px; color: #6b7280; transition: color 0.2s;\">&times;</span>\n            </div>\n        </div>\n        <div id=\"modalDetalhesConteudo\" style=\"padding-top: 20px;\">\n            <!-- Detalhes ser√£o inseridos aqui -->\n        </div>\n    </div>\n</div>\n\n<script>\n// Vari√°veis globais\nlet intercorrenciasOriginais = [];\nlet intercorrenciasFiltradas = [];\nlet modoVisualizacao = 'cards';\n\n// Inicializar dados\n{{\n    (() => {\n        const dados = intercorrencias_bi20?.data || [];\n        return `intercorrenciasOriginais = ${JSON.stringify(dados)};`;\n    })()\n}}\n\n// Formatar tempo de intercorr√™ncia\nfunction formatarTempo(tempoStr) {\n    if (!tempoStr) return '00:00:00';\n    \n    try {\n        // Formato: \"0 0:30:0.0\"\n        const regex = /(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/;\n        const match = tempoStr.match(regex);\n        \n        if (match) {\n            const [, dias, horas, minutos, segundos] = match;\n            const h = String(parseInt(horas) || 0).padStart(2, '0');\n            const m = String(parseInt(minutos) || 0).padStart(2, '0');\n            const s = String(parseInt(segundos) || 0).padStart(2, '0');\n            return dias > 0 ? `${dias}d ${h}:${m}:${s}` : `${h}:${m}:${s}`;\n        }\n        \n        return tempoStr;\n    } catch (error) {\n        return tempoStr || '00:00:00';\n    }\n}\n\n// Parsear data do formato DD/MM/YYYY HH:mm:ss para objeto Date\nfunction parsearData(dataStr) {\n    if (!dataStr) return null;\n    \n    try {\n        // Formato esperado: \"13/11/2025 13:02:04\" (DD/MM/YYYY HH:mm:ss)\n        if (typeof dataStr === 'string' && dataStr.includes('/')) {\n            const partes = dataStr.split(/[\\s\\/:]/).filter(p => p);\n            \n            if (partes.length >= 3) {\n                const dia = parseInt(partes[0]);\n                const mes = parseInt(partes[1]) - 1; // JavaScript usa m√™s 0-11\n                const ano = parseInt(partes[2]);\n                const hora = partes[3] ? parseInt(partes[3]) : 0;\n                const minuto = partes[4] ? parseInt(partes[4]) : 0;\n                const segundo = partes[5] ? parseInt(partes[5]) : 0;\n                \n                // Criar data completa\n                const data = new Date(ano, mes, dia, hora, minuto, segundo);\n                \n                // Validar\n                if (!isNaN(data.getTime())) {\n                    return data;\n                }\n            }\n        }\n        \n        // Fallback: tentar converter diretamente\n        const data = new Date(dataStr);\n        if (!isNaN(data.getTime())) {\n            return data;\n        }\n        \n        return null;\n    } catch (error) {\n        console.error('Erro ao parsear data:', dataStr, error);\n        return null;\n    }\n}\n\n// Formatar data\nfunction formatarData(dataStr) {\n    if (!dataStr) return 'N/A';\n    \n    const data = parsearData(dataStr);\n    \n    if (!data) {\n        return 'Data inv√°lida';\n    }\n    \n    return data.toLocaleDateString('pt-BR');\n}\n\n// Determinar status da intercorr√™ncia\nfunction getStatusIntercorrencia(item) {\n    const aprovacao = item.APROVACAO_INTERCORRENCIA;\n    const temJustificativa = item.JUSTIFICATIVA_APROVACAO && item.JUSTIFICATIVA_APROVACAO.trim();\n    \n    if (aprovacao === 'TRUE') {\n        return 'APROVADO';\n    } else if (aprovacao === 'FALSE' && temJustificativa) {\n        return 'REPROVADO';\n    } else {\n        return 'PENDENTE';\n    }\n}\n\n// Popular filtros\nfunction popularFiltros() {\n    console.log('üìã Populando filtros...');\n    \n    // Cidades\n    const cidades = [...new Set(intercorrenciasOriginais.map(d => d.CIDADE))].filter(c => c).sort();\n    const selectCidade = document.getElementById('filtroCidade');\n    selectCidade.innerHTML = '<option value=\"\">Todas</option>';\n    cidades.forEach(cidade => {\n        selectCidade.innerHTML += '<option value=\"' + cidade + '\">' + cidade + '</option>';\n    });\n    \n    // Motoboys\n    const motoboys = [...new Set(intercorrenciasOriginais.map(d => d.NOME_MOTOBOY))].filter(m => m).sort();\n    const selectMotoboy = document.getElementById('filtroMotoboy');\n    selectMotoboy.innerHTML = '<option value=\"\">Todos</option>';\n    motoboys.forEach(motoboy => {\n        selectMotoboy.innerHTML += '<option value=\"' + motoboy + '\">' + motoboy + '</option>';\n    });\n    \n    console.log('üìã Filtros populados:', { cidades: cidades.length, motoboys: motoboys.length });\n}\n\n// Aplicar filtros\nfunction aplicarFiltros() {\n    const filtroAprovacao = document.getElementById('filtroAprovacao').value;\n    const filtroCidade = document.getElementById('filtroCidade').value;\n    const filtroMotoboy = document.getElementById('filtroMotoboy').value;\n    const filtroData = document.getElementById('filtroData').value;\n    const filtroPedido = document.getElementById('filtroPedido').value;\n    \n    console.log('üîç Aplicando filtros:', { filtroAprovacao, filtroCidade, filtroMotoboy, filtroData, filtroPedido });\n    \n    intercorrenciasFiltradas = intercorrenciasOriginais.filter(item => {\n        // Filtro por aprova√ß√£o (usando nova l√≥gica)\n        if (filtroAprovacao) {\n            const status = getStatusIntercorrencia(item);\n            if (filtroAprovacao === 'TRUE' && status !== 'APROVADO') return false;\n            if (filtroAprovacao === 'PENDENTE' && status !== 'PENDENTE') return false;\n            if (filtroAprovacao === 'FALSE' && status !== 'REPROVADO') return false;\n        }\n        \n        // Filtro por cidade\n        if (filtroCidade && item.CIDADE !== filtroCidade) return false;\n        \n        // Filtro por motoboy\n        if (filtroMotoboy && item.NOME_MOTOBOY !== filtroMotoboy) return false;\n        \n        // Filtro por data\n        if (filtroData && item.DATA_INTERCORRENCIA) {\n            const dataItem = item.DATA_INTERCORRENCIA;\n            if (dataItem !== filtroData) return false;\n        }\n        \n        // Filtro por pedido\n        if (filtroPedido && item.NUMPED && !item.NUMPED.includes(filtroPedido)) return false;\n        \n        return true;\n    });\n    \n    console.log('üìä Filtros aplicados:', intercorrenciasFiltradas.length + '/' + intercorrenciasOriginais.length);\n    \n    atualizarEstatisticas();\n    renderizar();\n    atualizarResultados();\n    gerarGraficos();\n}\n\n// Renderizar conforme modo\nfunction renderizar() {\n    if (modoVisualizacao === 'cards') {\n        renderizarCards();\n    } else {\n        renderizarLista();\n    }\n}\n\n// Renderizar cards\nfunction renderizarCards() {\n    console.log('üé® Renderizando cards...', intercorrenciasFiltradas.length);\n    \n    const grid = document.getElementById('intercorrenciasGrid');\n    \n    if (intercorrenciasFiltradas.length === 0) {\n        grid.innerHTML = `\n            <div class=\"sem-intercorrencias\">\n                <div class=\"sem-intercorrencias-icon\">‚úÖ</div>\n                <div class=\"sem-intercorrencias-texto\">Nenhuma intercorr√™ncia encontrada</div>\n                <div class=\"sem-intercorrencias-subtexto\">Isso √© uma boa not√≠cia! N√£o h√° problemas com os filtros selecionados.</div>\n            </div>\n        `;\n        return;\n    }\n    \n    grid.innerHTML = intercorrenciasFiltradas.map((item, index) => {\n        const tempoFormatado = formatarTempo(item.TEMPO_INTERCORRENCIA);\n        const dataFormatada = formatarData(item.DATA_INTERCORRENCIA);\n        const status = getStatusIntercorrencia(item);\n        const hasImagem = item.URLS_FOTOS && item.URLS_FOTOS.trim();\n        \n        let statusClass = 'status-pendente';\n        let statusText = '‚è≥ Pendente';\n        if (status === 'APROVADO') {\n            statusClass = 'status-aprovado';\n            statusText = '‚úÖ Aprovada';\n        } else if (status === 'REPROVADO') {\n            statusClass = 'status-reprovado';\n            statusText = '‚ùå Reprovada';\n        }\n        \n        return `\n            <div class=\"intercorrencia-card\" data-index=\"${index}\">\n                <div class=\"card-header\">\n                    <div style=\"display: flex; align-items: center;\">\n                        <div class=\"intercorrencia-id\"># ${item.ID_INTERCORRENCIA}</div>\n                        <div class=\"badge-cidade\">${item.CIDADE}</div>\n                    </div>\n                    <div class=\"badge-status ${statusClass}\">\n                        ${statusText}\n                    </div>\n                </div>\n                \n                <div class=\"card-info\">\n                    <div class=\"info-item\">\n                        <div class=\"info-label\">üö¶ Sa√≠da ID</div>\n                        <div class=\"info-value\">${item.SAIDA_ID}</div>\n                    </div>\n                    <div class=\"info-item\">\n                        <div class=\"info-label\">üì¶ Pedido</div>\n                        <div class=\"info-value\">${item.NUMPED}</div>\n                    </div>\n                    <div class=\"info-item\">\n                        <div class=\"info-label\">üè¢ Filial</div>\n                        <div class=\"info-value\">${item.ID_FILIAL}</div>\n                    </div>\n                    <div class=\"info-item\">\n                        <div class=\"info-label\">üìÖ Data</div>\n                        <div class=\"info-value\">${dataFormatada}</div>\n                    </div>\n                </div>\n                \n                <div class=\"motoboy-info\">\n                    <div class=\"motoboy-nome\">üèçÔ∏è ${item.NOME_MOTOBOY}</div>\n                    <div class=\"motoboy-codigo\">C√≥digo: ${item.COD_MOTOBOY}</div>\n                </div>\n                \n                <div class=\"tempo-info\">\n                    <div class=\"tempo-valor\">${tempoFormatado}</div>\n                    <div class=\"tempo-label\">TEMPO DE INTERCORR√äNCIA</div>\n                </div>\n                \n                <div class=\"descricao-info\">\n                    <div class=\"descricao-titulo\">‚ö†Ô∏è Descri√ß√£o do Problema</div>\n                    <div class=\"descricao-texto\">${item.DESCRICAO || 'Sem descri√ß√£o'}</div>\n                </div>\n                \n                <div class=\"aprovacao-section ${status === 'APROVADO' ? 'aprovacao-aprovada' : 'aprovacao-pendente'}\">\n                    <div class=\"aprovacao-titulo\">\n                        ${status === 'APROVADO' ? '‚úÖ Aprova√ß√£o Concedida' : (status === 'REPROVADO' ? '‚ùå Reprovada' : '‚è≥ Aguardando Aprova√ß√£o')}\n                    </div>\n                    <div class=\"aprovacao-info\">\n                        ${status !== 'PENDENTE' ? \n                            '<strong>Por:</strong> ' + (item.NOME_QUEM_APROVOU || 'Sistema') + '<br>' +\n                            '<strong>C√≥digo:</strong> ' + (item.CODE_WINTHOR_QUEM_APROVOU || 'N/A') + '<br>' +\n                            '<strong>Justificativa:</strong> ' + (item.JUSTIFICATIVA_APROVACAO || 'Sem justificativa')\n                            :\n                            'Status: Pendente de an√°lise'\n                        }\n                    </div>\n                </div>\n                \n                <div class=\"imagem-section\">\n                    <div class=\"imagem-container\">\n                        ${hasImagem ? \n                            '<img src=\"' + item.URLS_FOTOS + '\" ' +\n                            'alt=\"Foto da intercorr√™ncia\" ' +\n                            'class=\"imagem-intercorrencia\" ' + \n                            'onclick=\"abrirModal(\\'' + item.URLS_FOTOS + '\\', \\'' + item.ID_INTERCORRENCIA + '\\')\" ' +\n                            'onerror=\"this.parentElement.innerHTML=\\'<div class=&quot;sem-imagem&quot;>üì∑ Erro ao carregar</div>\\'\">'\n                            :\n                            '<div class=\"sem-imagem\">üì∑ Nenhuma foto anexada</div>'\n                        }\n                    </div>\n                    ${hasImagem ? \n                        '<button class=\"btn-ver-imagem\" onclick=\"abrirModal(\\'' + item.URLS_FOTOS + '\\', \\'' + item.ID_INTERCORRENCIA + '\\')\">üì∑ Ver Imagem Completa</button>'\n                        : ''\n                    }\n                </div>\n                \n                <div class=\"card-footer\">\n                    <div class=\"lancamento-info\">\n                        <div>üìù Lan√ßado por:</div>\n                        <div class=\"lancamento-nome\">${item.NOME_LANCAMENTO}</div>\n                        <div>C√≥digo: ${item.CODWINTHOR_LANCAMENTO}</div>\n                    </div>\n                    <div style=\"display: flex; align-items: center; gap: 12px;\">\n                        <button class=\"btn-ver-detalhes\" \n                                onclick='abrirModalDetalhes(${JSON.stringify(item).replace(/'/g, \"&apos;\")})' \n                                style=\"background: #7c3aed; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;\"\n                                onmouseover=\"this.style.background='#6d28d9'\"\n                                onmouseout=\"this.style.background='#7c3aed'\">\n                            üìã Ver Detalhes\n                        </button>\n                        <div style=\"font-weight: 700; color: #ef4444;\">\n                            ID: ${item.ID_INTERCORRENCIA}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n    \n    console.log('‚úÖ Cards renderizados');\n}\n\n// Renderizar lista compacta\nfunction renderizarLista() {\n    console.log('üìã Renderizando lista...', intercorrenciasFiltradas.length);\n    \n    const listaBody = document.getElementById('listaBody');\n    \n    listaBody.innerHTML = intercorrenciasFiltradas.map((item, index) => {\n        const tempoFormatado = formatarTempo(item.TEMPO_INTERCORRENCIA);\n        const dataFormatada = formatarData(item.DATA_INTERCORRENCIA);\n        const status = getStatusIntercorrencia(item);\n        \n        let statusClass = 'pendente';\n        let statusTexto = 'Pendente';\n        if (status === 'APROVADO') {\n            statusClass = 'aprovado';\n            statusTexto = 'Aprovada';\n        } else if (status === 'REPROVADO') {\n            statusClass = 'pendente'; // Usar mesma cor que pendente por enquanto\n            statusTexto = 'Reprovada';\n        }\n        \n        return `\n            <div class=\"lista-item ${statusClass}\" \n                 title=\"Clique no bot√£o para ver detalhes\">\n                <div style=\"font-weight: 700; color: #ef4444;\">#${item.ID_INTERCORRENCIA}</div>\n                <div style=\"font-weight: 600;\">${item.NUMPED}</div>\n                <div>${item.NOME_MOTOBOY}</div>\n                <div>${item.CIDADE}</div>\n                <div>${dataFormatada}</div>\n                <div style=\"font-family: monospace;\">${tempoFormatado}</div>\n                <div style=\"font-size: 11px; color: #6b7280; max-width: 300px; line-height: 1.4;\">\n                    ${item.DESCRICAO || 'Sem descri√ß√£o'}\n                </div>\n                <div>\n                    <div class=\"status-badge ${statusClass}\">\n                        ${statusTexto}\n                    </div>\n                </div>\n                <div>\n                    <button onclick='abrirModalDetalhes(${JSON.stringify(item).replace(/'/g, \"&apos;\")})' \n                            style=\"background: #7c3aed; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600; white-space: nowrap;\"\n                            onmouseover=\"this.style.background='#6d28d9'\"\n                            onmouseout=\"this.style.background='#7c3aed'\">\n                        üìã Ver\n                    </button>\n                </div>\n            </div>\n        `;\n    }).join('');\n    \n    console.log('‚úÖ Lista renderizada');\n}\n\n// Atualizar estat√≠sticas\nfunction atualizarEstatisticas() {\n    const total = intercorrenciasFiltradas.length;\n    const aprovadas = intercorrenciasFiltradas.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = intercorrenciasFiltradas.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = intercorrenciasFiltradas.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    const cidades = [...new Set(intercorrenciasFiltradas.map(i => i.CIDADE))].length;\n    const motoboys = [...new Set(intercorrenciasFiltradas.map(i => i.NOME_MOTOBOY))].length;\n    \n    // Calcular tempo m√©dio\n    let tempoMedioMinutos = 0;\n    if (total > 0) {\n        const tempos = intercorrenciasFiltradas.map(item => {\n            const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n            const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n            if (match) {\n                const [, dias, horas, minutos] = match;\n                return parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            }\n            return 0;\n        });\n        \n        tempoMedioMinutos = Math.floor(tempos.reduce((sum, t) => sum + t, 0) / tempos.length);\n    }\n    \n    const horasMedia = Math.floor(tempoMedioMinutos / 60);\n    const minutosMedia = tempoMedioMinutos % 60;\n    const tempoMedioFormatado = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n    \n    // Novos indicadores de Diverg√™ncias\n    const clientes = [...new Set(intercorrenciasFiltradas.map(i => i.CODIGO_CLIENTE || i.CODCLI).filter(c => c))];\n    const totalClientes = clientes.length;\n    \n    // Contar clientes recorrentes (2+ intercorr√™ncias)\n    const contagemPorCliente = {};\n    intercorrenciasFiltradas.forEach(i => {\n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        if (codCliente) {\n            contagemPorCliente[codCliente] = (contagemPorCliente[codCliente] || 0) + 1;\n        }\n    });\n    const clientesRecorrentes = Object.values(contagemPorCliente).filter(count => count >= 2).length;\n    \n    // Total de vendedores\n    const vendedores = [...new Set(intercorrenciasFiltradas.map(i => i.CODRCA).filter(v => v))];\n    const totalVendedores = vendedores.length;\n    \n    // Endere√ßo errado (ID_CATEGORIA_INTERCORRENCIA === \"4\" ou CATEGORIA_INTERCORRENCIA cont√©m \"ENDERECO\")\n    const enderecoErrado = intercorrenciasFiltradas.filter(i => \n        i.ID_CATEGORIA_INTERCORRENCIA === '4' || \n        (i.CATEGORIA_INTERCORRENCIA && i.CATEGORIA_INTERCORRENCIA.toUpperCase().includes('ENDERECO'))\n    ).length;\n    \n    // Cliente novo - Filtrar pela categoria ID=6 ou CATEGORIA_INTERCORRENCIA='CLIENTE NOVO'\n    const clientesNovos = intercorrenciasFiltradas.filter(i => \n        i.ID_CATEGORIA_INTERCORRENCIA === '6' || \n        (i.CATEGORIA_INTERCORRENCIA && i.CATEGORIA_INTERCORRENCIA.toUpperCase().includes('CLIENTE NOVO'))\n    ).length;\n    \n    // Calcular atrasos - Placeholder (necessita campos de data planejada vs real)\n    const somaAtrasosMotoboy = '00:00'; // TODO: implementar quando campos estiverem dispon√≠veis\n    const tempoMedioSaida = '00:00'; // TODO: implementar quando campos estiverem dispon√≠veis\n    const tempoTotalAtrasoSaida = '00:00'; // TODO: implementar quando campos estiverem dispon√≠veis\n    const percTotalAtrasos = 0; // TODO: implementar quando campos estiverem dispon√≠veis\n    \n    // Taxa de aprova√ß√£o geral\n    const taxaAprovacaoGeral = total > 0 ? Math.round((aprovadas / total) * 100) : 0;\n    \n    // % de endere√ßo errado\n    const percEnderecoErrado = total > 0 ? Math.round((enderecoErrado / total) * 100) : 0;\n    \n    // Atualizar cards originais\n    document.getElementById('totalIntercorrencias').textContent = total;\n    document.getElementById('intercorrenciasPendentes').textContent = pendentes;\n    document.getElementById('intercorrenciasAprovadas').textContent = aprovadas;\n    document.getElementById('intercorrenciasReprovadas').textContent = reprovadas;\n    document.getElementById('cidadesAfetadas').textContent = cidades;\n    document.getElementById('motoboyEnvolvidos').textContent = motoboys;\n    document.getElementById('tempoMedio').textContent = tempoMedioFormatado;\n    \n    // Atualizar novos cards de Diverg√™ncias\n    document.getElementById('totalClientes').textContent = totalClientes;\n    document.getElementById('clientesRecorrentes').textContent = clientesRecorrentes;\n    document.getElementById('totalVendedores').textContent = totalVendedores;\n    document.getElementById('enderecoErrado').textContent = enderecoErrado;\n    document.getElementById('clientesNovos').textContent = clientesNovos;\n    document.getElementById('somaAtrasosMotoboy').textContent = somaAtrasosMotoboy;\n    document.getElementById('tempoMedioSaida').textContent = tempoMedioSaida;\n    document.getElementById('tempoTotalAtrasoSaida').textContent = tempoTotalAtrasoSaida;\n    document.getElementById('percTotalAtrasos').textContent = percTotalAtrasos + '%';\n    document.getElementById('taxaAprovacaoGeral').textContent = taxaAprovacaoGeral + '%';\n    document.getElementById('percEnderecoErrado').textContent = percEnderecoErrado + '%';\n    \n    console.log('üìä Estat√≠sticas atualizadas:', { \n        total, pendentes, aprovadas, reprovadas, cidades, motoboys,\n        totalClientes, clientesRecorrentes, totalVendedores, enderecoErrado,\n        clientesNovos, taxaAprovacaoGeral, percEnderecoErrado\n    });\n}\n\n// Gerar gr√°ficos de analytics\nfunction gerarGraficos() {\n    console.log('üìä Gerando gr√°ficos de analytics...');\n    \n    gerarGraficoFiliais();\n    gerarGraficoMotoboys();\n    gerarGraficoCidades();\n    gerarRankings();\n    gerarAnalisesDivergencias();\n}\n\n// Gerar gr√°fico por filiais\nfunction gerarGraficoFiliais() {\n    const filiaisStats = {};\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const filial = item.ID_FILIAL || 'N/A';\n        \n        if (!filiaisStats[filial]) {\n            filiaisStats[filial] = {\n                total: 0,\n                tempoTotal: 0,\n                aprovadas: 0,\n                pendentes: 0\n            };\n        }\n        \n        filiaisStats[filial].total++;\n        \n        // Calcular tempo em minutos\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        if (match) {\n            const [, dias, horas, minutos] = match;\n            const tempoMinutos = parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            filiaisStats[filial].tempoTotal += tempoMinutos;\n        }\n        \n        if (item.APROVACAO_INTERCORRENCIA === 'TRUE') {\n            filiaisStats[filial].aprovadas++;\n        } else {\n            filiaisStats[filial].pendentes++;\n        }\n    });\n    \n    const container = document.getElementById('graficoFiliais');\n    const maxTotal = Math.max(...Object.values(filiaisStats).map(s => s.total), 1);\n    \n    container.innerHTML = Object.entries(filiaisStats).map(([filial, stats]) => {\n        const tempoMedio = stats.total > 0 ? Math.floor(stats.tempoTotal / stats.total) : 0;\n        const horasMedia = Math.floor(tempoMedio / 60);\n        const minutosMedia = tempoMedio % 60;\n        const tempoFormatado = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n        const porcentagem = Math.round((stats.total / maxTotal) * 100);\n        \n        return `\n            <div class=\"chart-item\" onclick=\"filtrarPorFilial('${filial}')\">\n                <div class=\"chart-label\">üè¢ Filial ${filial}</div>\n                <div class=\"chart-stats\">\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value quantidade\">${stats.total}</div>\n                        <div class=\"chart-sublabel\">Total</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value tempo\">${tempoFormatado}</div>\n                        <div class=\"chart-sublabel\">Tempo M√©dio</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value aprovadas\">${stats.aprovadas}</div>\n                        <div class=\"chart-sublabel\">Aprovadas</div>\n                    </div>\n                </div>\n                <div class=\"chart-barra\">\n                    <div class=\"chart-progress\" style=\"width: ${porcentagem}%;\"></div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico por motoboys\nfunction gerarGraficoMotoboys() {\n    const motoboyStats = {};\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const motoboy = item.NOME_MOTOBOY || 'N/A';\n        \n        if (!motoboyStats[motoboy]) {\n            motoboyStats[motoboy] = {\n                total: 0,\n                tempoTotal: 0,\n                aprovadas: 0,\n                filiais: new Set()\n            };\n        }\n        \n        motoboyStats[motoboy].total++;\n        motoboyStats[motoboy].filiais.add(item.ID_FILIAL);\n        \n        // Calcular tempo\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        if (match) {\n            const [, dias, horas, minutos] = match;\n            const tempoMinutos = parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            motoboyStats[motoboy].tempoTotal += tempoMinutos;\n        }\n        \n        if (item.APROVACAO_INTERCORRENCIA === 'TRUE') {\n            motoboyStats[motoboy].aprovadas++;\n        }\n    });\n    \n    const container = document.getElementById('graficoMotoboys');\n    const maxTotal = Math.max(...Object.values(motoboyStats).map(s => s.total), 1);\n    \n    // Ordenar por total de intercorr√™ncias\n    const motoboyOrdenados = Object.entries(motoboyStats).sort((a, b) => b[1].total - a[1].total);\n    \n    container.innerHTML = motoboyOrdenados.map(([motoboy, stats]) => {\n        const tempoMedio = stats.total > 0 ? Math.floor(stats.tempoTotal / stats.total) : 0;\n        const horasMedia = Math.floor(tempoMedio / 60);\n        const minutosMedia = tempoMedio % 60;\n        const tempoFormatado = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n        const porcentagem = Math.round((stats.total / maxTotal) * 100);\n        \n        return `\n            <div class=\"chart-item\" onclick=\"filtrarPorMotoboy('${motoboy}')\">\n                <div class=\"chart-label\">üèçÔ∏è ${motoboy}</div>\n                <div class=\"chart-stats\">\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value quantidade\">${stats.total}</div>\n                        <div class=\"chart-sublabel\">Casos</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value tempo\">${tempoFormatado}</div>\n                        <div class=\"chart-sublabel\">Tempo M√©dio</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value aprovadas\">${stats.aprovadas}</div>\n                        <div class=\"chart-sublabel\">Aprovadas</div>\n                    </div>\n                </div>\n                <div style=\"font-size: 10px; color: #6b7280; margin-top: 4px;\">\n                    ${stats.filiais.size} filial(is)\n                </div>\n                <div class=\"chart-barra\">\n                    <div class=\"chart-progress\" style=\"width: ${porcentagem}%;\"></div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico por cidades\nfunction gerarGraficoCidades() {\n    const cidadesStats = {};\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const cidade = item.CIDADE || 'N/A';\n        \n        if (!cidadesStats[cidade]) {\n            cidadesStats[cidade] = {\n                total: 0,\n                tempoTotal: 0,\n                aprovadas: 0,\n                motoboys: new Set()\n            };\n        }\n        \n        cidadesStats[cidade].total++;\n        cidadesStats[cidade].motoboys.add(item.NOME_MOTOBOY);\n        \n        // Calcular tempo\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        if (match) {\n            const [, dias, horas, minutos] = match;\n            const tempoMinutos = parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            cidadesStats[cidade].tempoTotal += tempoMinutos;\n        }\n        \n        if (item.APROVACAO_INTERCORRENCIA === 'TRUE') {\n            cidadesStats[cidade].aprovadas++;\n        }\n    });\n    \n    const container = document.getElementById('graficoCidades');\n    const maxTotal = Math.max(...Object.values(cidadesStats).map(s => s.total), 1);\n    \n    container.innerHTML = Object.entries(cidadesStats).map(([cidade, stats]) => {\n        const tempoMedio = stats.total > 0 ? Math.floor(stats.tempoTotal / stats.total) : 0;\n        const horasMedia = Math.floor(tempoMedio / 60);\n        const minutosMedia = tempoMedio % 60;\n        const tempoFormatado = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n        const porcentagem = Math.round((stats.total / maxTotal) * 100);\n        \n        return `\n            <div class=\"chart-item\" onclick=\"filtrarPorCidade('${cidade}')\">\n                <div class=\"chart-label\">üèôÔ∏è ${cidade}</div>\n                <div class=\"chart-stats\">\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value quantidade\">${stats.total}</div>\n                        <div class=\"chart-sublabel\">Total</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value tempo\">${tempoFormatado}</div>\n                        <div class=\"chart-sublabel\">M√©dio</div>\n                    </div>\n                </div>\n                <div style=\"font-size: 10px; color: #6b7280; margin: 4px 0;\">\n                    ${stats.motoboys.size} motoboys ‚Ä¢ ${stats.aprovadas} aprovadas\n                </div>\n                <div class=\"chart-barra\">\n                    <div class=\"chart-progress\" style=\"width: ${porcentagem}%;\"></div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar rankings\nfunction gerarRankings() {\n    const container = document.getElementById('rankingsContainer');\n    \n    // Top Motoboys com mais intercorr√™ncias\n    const motoboyStats = {};\n    intercorrenciasFiltradas.forEach(item => {\n        const motoboy = item.NOME_MOTOBOY || 'N/A';\n        motoboyStats[motoboy] = (motoboyStats[motoboy] || 0) + 1;\n    });\n    \n    const topMotoboys = Object.entries(motoboyStats)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5);\n    \n    // Top Descri√ß√µes mais comuns\n    const descricoesStats = {};\n    intercorrenciasFiltradas.forEach(item => {\n        const desc = (item.DESCRICAO || 'Sem descri√ß√£o').substring(0, 30);\n        descricoesStats[desc] = (descricoesStats[desc] || 0) + 1;\n    });\n    \n    const topDescricoes = Object.entries(descricoesStats)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5);\n    \n    container.innerHTML = `\n        <!-- Top Motoboys -->\n        <div style=\"background: #fef2f2; border: 2px solid #ef4444; border-radius: 8px; padding: 12px;\">\n            <div style=\"font-size: 12px; font-weight: 700; color: #ef4444; margin-bottom: 8px; text-align: center;\">\n                ü•á TOP 5 - Motoboys com Mais Intercorr√™ncias\n            </div>\n            ${topMotoboys.map((entry, index) => `\n                <div style=\"display: flex; justify-content: space-between; align-items: center; padding: 4px 0; border-bottom: 1px solid #fed7d7; font-size: 11px;\">\n                    <div>\n                        <span style=\"background: #ef4444; color: white; padding: 2px 6px; border-radius: 4px; font-weight: 700; margin-right: 8px;\">\n                            ${index + 1}¬∫\n                        </span>\n                        ${entry[0]}\n                    </div>\n                    <div style=\"font-weight: 700; color: #ef4444;\">\n                        ${entry[1]} casos\n                    </div>\n                </div>\n            `).join('')}\n        </div>\n        \n        <!-- Top Problemas -->\n        <div style=\"background: #f0f9ff; border: 2px solid #1890ff; border-radius: 8px; padding: 12px;\">\n            <div style=\"font-size: 12px; font-weight: 700; color: #1890ff; margin-bottom: 8px; text-align: center;\">\n                üìã TOP 5 - Problemas Mais Comuns\n            </div>\n            ${topDescricoes.map((entry, index) => `\n                <div style=\"display: flex; justify-content: space-between; align-items: center; padding: 4px 0; border-bottom: 1px solid #bfdbfe; font-size: 11px;\">\n                    <div style=\"flex: 1; overflow: hidden; text-overflow: ellipsis;\">\n                        <span style=\"background: #1890ff; color: white; padding: 2px 6px; border-radius: 4px; font-weight: 700; margin-right: 8px;\">\n                            ${index + 1}¬∫\n                        </span>\n                        ${entry[0]}...\n                    </div>\n                    <div style=\"font-weight: 700; color: #1890ff; margin-left: 8px;\">\n                        ${entry[1]}x\n                    </div>\n                </div>\n            `).join('')}\n        </div>\n    `;\n}\n\n// Mudar de aba\nfunction mudarAba(aba) {\n    // Remover active de todos os bot√µes e conte√∫dos\n    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));\n    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));\n    \n    // Ativar a aba selecionada\n    const abaMap = {\n        'dashboard': 'tabDashboard',\n        'intercorrencias': 'tabIntercorrencias',\n        'divergencias': 'tabDivergencias',\n        'motoboys': 'tabMotoboys',\n        'estados': 'tabEstados',\n        'analytics': 'tabAnalytics',\n        'percentuais': 'tabPercentuais'\n    };\n    \n    document.getElementById(abaMap[aba]).classList.add('active');\n    event.target.classList.add('active');\n    \n    // Se for analytics, gerar gr√°ficos avan√ßados\n    if (aba === 'analytics') {\n        gerarGraficosAvancados();\n    }\n    \n    // Se for diverg√™ncias, garantir que os dados est√£o atualizados\n    if (aba === 'divergencias') {\n        gerarAnalisesDivergencias();\n    }\n    \n    // Se for percentuais, gerar an√°lises percentuais\n    if (aba === 'percentuais') {\n        gerarEstrategiaPercentual();\n    }\n    \n    // Inicializar abas espec√≠ficas\n    if (aba === 'motoboys') {\n        inicializarAbaMotoboys();\n    } else if (aba === 'estados') {\n        inicializarAbaEstados();\n    }\n    \n    console.log('üìë Aba alterada para:', aba);\n}\n\n// Gerar gr√°ficos avan√ßados (aba Analytics)\nfunction gerarGraficosAvancados() {\n    console.log('üìà Gerando gr√°ficos avan√ßados...');\n    \n    gerarHeatmapHorarios();\n    gerarGraficoDiaSemana();\n    gerarGraficoPeriodoDia();\n    gerarGraficoTempoResolucao();\n    gerarGraficoTopCausas();\n    gerarTimelineChart();\n    atualizarInsights();\n}\n\n// Gerar heatmap de hor√°rios\nfunction gerarHeatmapHorarios() {\n    const container = document.getElementById('heatmapHorarios');\n    const horarioStats = {};\n    \n    // Inicializar todas as horas\n    for (let h = 0; h < 24; h++) {\n        horarioStats[h] = 0;\n    }\n    \n    // Contar intercorr√™ncias por hora\n    intercorrenciasFiltradas.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            const data = parsearData(item.DATA_INTERCORRENCIA);\n            if (data) {\n                const hora = data.getHours();\n                if (hora >= 0 && hora < 24) {\n                    horarioStats[hora]++;\n                }\n            }\n        }\n    });\n    \n    const maxVal = Math.max(...Object.values(horarioStats), 1);\n    \n    container.innerHTML = Object.entries(horarioStats)\n        .sort((a, b) => parseInt(a[0]) - parseInt(b[0]))\n        .map(([hora, count]) => {\n            let cor = '#ecfdf5';\n            let textColor = '#065f46';\n            \n            if (count === 0) {\n                cor = '#f9fafb';\n                textColor = '#d1d5db';\n            } else if (count <= 2) {\n                cor = '#ecfdf5';\n                textColor = '#065f46';\n            } else if (count <= 5) {\n                cor = '#a7f3d0';\n                textColor = '#065f46';\n            } else if (count <= 10) {\n                cor = '#fef3c7';\n                textColor = '#92400e';\n            } else {\n                cor = '#fecaca';\n                textColor = '#991b1b';\n            }\n            \n            return `\n                <div class=\"heatmap-cell\" \n                     style=\"background: ${cor}; color: ${textColor}; font-weight: 700;\"\n                     title=\"${String(hora).padStart(2, '0')}:00 - ${count} intercorr√™ncia(s)\">\n                    ${String(hora).padStart(2, '0')}\n                </div>\n            `;\n        }).join('');\n}\n\n// Gerar gr√°fico por dia da semana\nfunction gerarGraficoDiaSemana() {\n    const container = document.getElementById('graficoDiaSemana');\n    const diasSemana = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];\n    const diaStats = [0, 0, 0, 0, 0, 0, 0];\n    \n    intercorrenciasFiltradas.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            try {\n                const data = new Date(item.DATA_INTERCORRENCIA);\n                const dia = data.getDay();\n                if (!isNaN(dia)) {\n                    diaStats[dia]++;\n                }\n            } catch (e) {}\n        }\n    });\n    \n    const maxVal = Math.max(...diaStats, 1);\n    \n    container.innerHTML = diasSemana.map((dia, index) => {\n        const count = diaStats[index];\n        const porcentagem = Math.round((count / maxVal) * 100);\n        \n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${dia}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico por per√≠odo do dia\nfunction gerarGraficoPeriodoDia() {\n    const container = document.getElementById('graficoPeriodoDia');\n    const periodos = {\n        'Madrugada (00-06h)': 0,\n        'Manh√£ (06-12h)': 0,\n        'Tarde (12-18h)': 0,\n        'Noite (18-24h)': 0\n    };\n    \n    intercorrenciasFiltradas.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            const data = parsearData(item.DATA_INTERCORRENCIA);\n            if (data) {\n                const hora = data.getHours();\n                if (hora >= 0 && hora < 6) periodos['Madrugada (00-06h)']++;\n                else if (hora >= 6 && hora < 12) periodos['Manh√£ (06-12h)']++;\n                else if (hora >= 12 && hora < 18) periodos['Tarde (12-18h)']++;\n                else periodos['Noite (18-24h)']++;\n            }\n        }\n    });\n    \n    const maxVal = Math.max(...Object.values(periodos), 1);\n    \n    container.innerHTML = Object.entries(periodos).map(([periodo, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        \n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${periodo}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico de tempo de resolu√ß√£o\nfunction gerarGraficoTempoResolucao() {\n    const container = document.getElementById('graficoTempoResolucao');\n    const faixas = {\n        '0-30 min': 0,\n        '30min-1h': 0,\n        '1-2h': 0,\n        '2-4h': 0,\n        '4h+': 0\n    };\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        \n        if (match) {\n            const [, dias, horas, minutos] = match;\n            const totalMinutos = parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            \n            if (totalMinutos < 30) faixas['0-30 min']++;\n            else if (totalMinutos < 60) faixas['30min-1h']++;\n            else if (totalMinutos < 120) faixas['1-2h']++;\n            else if (totalMinutos < 240) faixas['2-4h']++;\n            else faixas['4h+']++;\n        }\n    });\n    \n    const maxVal = Math.max(...Object.values(faixas), 1);\n    \n    container.innerHTML = Object.entries(faixas).map(([faixa, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        \n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${faixa}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico top causas\nfunction gerarGraficoTopCausas() {\n    const container = document.getElementById('graficoTopCausas');\n    const causasStats = {};\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const descricao = (item.DESCRICAO || 'Sem descri√ß√£o').substring(0, 40);\n        causasStats[descricao] = (causasStats[descricao] || 0) + 1;\n    });\n    \n    const topCausas = Object.entries(causasStats)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 10);\n    \n    const maxVal = Math.max(...topCausas.map(c => c[1]), 1);\n    \n    container.innerHTML = topCausas.map(([causa, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        \n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\" style=\"min-width: 150px; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;\" title=\"${causa}\">${causa}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico timeline 24h com bolas clic√°veis\nfunction gerarTimelineChart() {\n    const container = document.getElementById('timelineChart');\n    if (!container) return;\n    \n    const horarioStats = {};\n    for (let h = 0; h < 24; h++) horarioStats[h] = 0;\n    \n    let totalIntercorrencias = 0;\n    intercorrenciasFiltradas.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            const data = parsearData(item.DATA_INTERCORRENCIA);\n            if (data) {\n                const hora = data.getHours();\n                if (hora >= 0 && hora < 24) {\n                    horarioStats[hora]++;\n                    totalIntercorrencias++;\n                }\n            }\n        }\n    });\n    \n    // Atualizar contador total\n    const totalCountEl = document.getElementById('timelineTotalCount');\n    if (totalCountEl) {\n        totalCountEl.textContent = totalIntercorrencias;\n    }\n    \n    const maxVal = Math.max(...Object.values(horarioStats), 1);\n    const width = 1000;\n    const height = 250;\n    const padding = 50;\n    \n    // Criar array de pontos para a linha\n    const points = Object.entries(horarioStats).map(([hora, count]) => {\n        const x = padding + (parseInt(hora) / 23) * (width - 2 * padding);\n        const y = height - padding - (count / maxVal) * (height - 2 * padding);\n        return { hora: parseInt(hora), count, x, y };\n    });\n    \n    // Criar path para a linha\n    const pathData = points.map((p, i) => \n        `${i === 0 ? 'M' : 'L'} ${p.x} ${p.y}`\n    ).join(' ');\n    \n    // Criar √°rea preenchida\n    const areaPath = `${pathData} L ${points[points.length - 1].x} ${height - padding} L ${points[0].x} ${height - padding} Z`;\n    \n    container.innerHTML = `\n        <svg width=\"${width}\" height=\"${height}\" style=\"overflow: visible;\">\n            <!-- Grid lines -->\n            ${[0, 1, 2, 3, 4].map(i => {\n                const y = height - padding - (i / 4) * (height - 2 * padding);\n                const valor = Math.round((i / 4) * maxVal);\n                return `\n                    <line x1=\"${padding}\" y1=\"${y}\" x2=\"${width - padding}\" y2=\"${y}\" \n                          stroke=\"#e5e7eb\" stroke-width=\"1\" stroke-dasharray=\"5,5\"/>\n                    <text x=\"${padding - 10}\" y=\"${y + 5}\" text-anchor=\"end\" \n                          font-size=\"11\" fill=\"#6b7280\">${valor}</text>\n                `;\n            }).join('')}\n            \n            <!-- √Årea preenchida -->\n            <path d=\"${areaPath}\" fill=\"url(#gradient)\" opacity=\"0.3\"/>\n            \n            <!-- Linha principal -->\n            <path d=\"${pathData}\" fill=\"none\" stroke=\"#1890ff\" stroke-width=\"3\"/>\n            \n            <!-- Pontos (bolas) clic√°veis com efeitos -->\n            ${points.map(p => {\n                const radius = p.count === 0 ? 3 : Math.min(6 + (p.count / maxVal) * 8, 14);\n                const color = p.count === 0 ? '#d1d5db' : \n                             p.count <= 2 ? '#10b981' :\n                             p.count <= 5 ? '#f59e0b' :\n                             p.count <= 10 ? '#f97316' : '#ef4444';\n                \n                const glowColor = p.count === 0 ? 'none' : \n                                 p.count <= 2 ? 'rgba(16, 185, 129, 0.4)' :\n                                 p.count <= 5 ? 'rgba(245, 158, 11, 0.4)' :\n                                 p.count <= 10 ? 'rgba(249, 115, 22, 0.4)' : 'rgba(239, 68, 68, 0.4)';\n                \n                return `\n                    ${p.count > 0 ? `\n                        <!-- Glow effect -->\n                        <circle cx=\"${p.x}\" cy=\"${p.y}\" r=\"${radius + 6}\" \n                                fill=\"${glowColor}\" opacity=\"0.3\" class=\"pulse-circle\"/>\n                    ` : ''}\n                    \n                    <!-- Bola principal -->\n                    <circle cx=\"${p.x}\" cy=\"${p.y}\" r=\"${radius}\" \n                            fill=\"${color}\" stroke=\"white\" stroke-width=\"3\"\n                            style=\"cursor: ${p.count > 0 ? 'pointer' : 'default'}; transition: all 0.3s ease; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));\"\n                            onmouseover=\"if(${p.count} > 0) { this.setAttribute('r', ${radius + 3}); this.style.filter='drop-shadow(0 4px 8px rgba(0,0,0,0.3))'; }\"\n                            onmouseout=\"this.setAttribute('r', ${radius}); this.style.filter='drop-shadow(0 2px 4px rgba(0,0,0,0.2))';\"\n                            onclick=\"if (${p.count} > 0) abrirModalTimelineHora(${p.hora})\">\n                        <title>${String(p.hora).padStart(2, '0')}:00 - ${p.count} intercorr√™ncia(s)${p.count > 0 ? '\\nüîç Clique para ver detalhes' : ''}</title>\n                    </circle>\n                    \n                    ${p.count > 0 ? `\n                        <!-- Contador sobre a bola -->\n                        <text x=\"${p.x}\" y=\"${p.y - radius - 8}\" text-anchor=\"middle\" \n                              font-size=\"11\" font-weight=\"900\" fill=\"${color}\"\n                              style=\"pointer-events: none;\">\n                            ${p.count}\n                        </text>\n                    ` : ''}\n                    \n                    <!-- Hora abaixo -->\n                    <text x=\"${p.x}\" y=\"${height - padding + 20}\" text-anchor=\"middle\" \n                          font-size=\"10\" fill=\"#374151\" font-weight=\"700\"\n                          style=\"pointer-events: none;\">\n                        ${String(p.hora).padStart(2, '0')}h\n                    </text>\n                `;\n            }).join('')}\n            \n            <!-- Gradiente -->\n            <defs>\n                <linearGradient id=\"gradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                    <stop offset=\"0%\" style=\"stop-color:#1890ff;stop-opacity:0.6\" />\n                    <stop offset=\"100%\" style=\"stop-color:#1890ff;stop-opacity:0.1\" />\n                </linearGradient>\n            </defs>\n        </svg>\n        \n        <!-- Legenda Profissional -->\n        <div style=\"margin-top: 24px; padding: 16px; background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%); border-radius: 12px; border: 2px solid #e5e7eb;\">\n            <div style=\"text-align: center; margin-bottom: 12px;\">\n                <span style=\"font-size: 13px; font-weight: 700; color: #374151;\">üìä Legenda de Intensidade</span>\n            </div>\n            <div style=\"display: flex; justify-content: center; gap: 16px; flex-wrap: wrap;\">\n                <div style=\"display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);\">\n                    <div style=\"width: 14px; height: 14px; border-radius: 50%; background: #d1d5db; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);\"></div>\n                    <span style=\"font-size: 12px; font-weight: 600; color: #6b7280;\">Nenhum</span>\n                </div>\n                <div style=\"display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);\">\n                    <div style=\"width: 14px; height: 14px; border-radius: 50%; background: #10b981; border: 2px solid white; box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);\"></div>\n                    <span style=\"font-size: 12px; font-weight: 600; color: #059669;\">‚úÖ 1-2</span>\n                </div>\n                <div style=\"display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);\">\n                    <div style=\"width: 14px; height: 14px; border-radius: 50%; background: #f59e0b; border: 2px solid white; box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);\"></div>\n                    <span style=\"font-size: 12px; font-weight: 600; color: #d97706;\">‚ö†Ô∏è 3-5</span>\n                </div>\n                <div style=\"display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);\">\n                    <div style=\"width: 14px; height: 14px; border-radius: 50%; background: #f97316; border: 2px solid white; box-shadow: 0 2px 4px rgba(249, 115, 22, 0.3);\"></div>\n                    <span style=\"font-size: 12px; font-weight: 600; color: #ea580c;\">üî∂ 6-10</span>\n                </div>\n                <div style=\"display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);\">\n                    <div style=\"width: 14px; height: 14px; border-radius: 50%; background: #ef4444; border: 2px solid white; box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);\"></div>\n                    <span style=\"font-size: 12px; font-weight: 600; color: #dc2626;\">üî¥ 10+</span>\n                </div>\n            </div>\n            <div style=\"text-align: center; margin-top: 12px;\">\n                <span style=\"font-size: 11px; color: #6b7280;\">üí° Passe o mouse sobre as bolas para mais detalhes ‚Ä¢ Clique para abrir o modal</span>\n            </div>\n        </div>\n    `;\n}\n\n// Abrir modal de timeline com detalhes da hora\nfunction abrirModalTimelineHora(hora) {\n    console.log('üìà Abrindo modal da hora:', hora);\n    \n    // Filtrar intercorr√™ncias da hora selecionada\n    const intercorrencias = intercorrenciasFiltradas.filter(item => {\n        if (!item.DATA_INTERCORRENCIA) return false;\n        const data = parsearData(item.DATA_INTERCORRENCIA);\n        return data && data.getHours() === hora;\n    });\n    \n    // Atualizar t√≠tulo\n    const horaStr = String(hora).padStart(2, '0');\n    const proximaHora = String((hora + 1) % 24).padStart(2, '0');\n    document.getElementById('modalTimelineTitulo').textContent = \n        `üìà Intercorr√™ncias das ${horaStr}:00 - ${proximaHora}:00`;\n    \n    // Atualizar estat√≠sticas\n    const total = intercorrencias.length;\n    const aprovadas = intercorrencias.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = intercorrencias.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = intercorrencias.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    \n    document.getElementById('modalTimelineStats').innerHTML = `\n        <div style=\"background: #f9fafb; padding: 12px; border-radius: 8px; text-align: center;\">\n            <div style=\"font-size: 24px; font-weight: 900; color: #1890ff;\">${total}</div>\n            <div style=\"font-size: 11px; color: #6b7280;\">Total</div>\n        </div>\n        <div style=\"background: #ecfdf5; padding: 12px; border-radius: 8px; text-align: center;\">\n            <div style=\"font-size: 24px; font-weight: 900; color: #10b981;\">${aprovadas}</div>\n            <div style=\"font-size: 11px; color: #065f46;\">‚úÖ Aprovadas</div>\n        </div>\n        <div style=\"background: #fee2e2; padding: 12px; border-radius: 8px; text-align: center;\">\n            <div style=\"font-size: 24px; font-weight: 900; color: #ef4444;\">${reprovadas}</div>\n            <div style=\"font-size: 11px; color: #991b1b;\">‚ùå Reprovadas</div>\n        </div>\n        <div style=\"background: #fef3c7; padding: 12px; border-radius: 8px; text-align: center;\">\n            <div style=\"font-size: 24px; font-weight: 900; color: #f59e0b;\">${pendentes}</div>\n            <div style=\"font-size: 11px; color: #92400e;\">‚è≥ Pendentes</div>\n        </div>\n    `;\n    \n    // Listar intercorr√™ncias\n    document.getElementById('modalTimelineConteudo').innerHTML = intercorrencias.map(item => {\n        const status = getStatusIntercorrencia(item);\n        const statusClass = status === 'APROVADO' ? 'status-aprovado' : \n                           status === 'REPROVADO' ? 'status-reprovado' : 'status-pendente';\n        const statusIcon = status === 'APROVADO' ? '‚úÖ' : \n                          status === 'REPROVADO' ? '‚ùå' : '‚è≥';\n        \n        return `\n            <div style=\"background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 5px solid ${status === 'APROVADO' ? '#10b981' : status === 'REPROVADO' ? '#ef4444' : '#f59e0b'};\">\n                <div style=\"display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;\">\n                    <div>\n                        <div style=\"font-weight: 700; font-size: 16px; color: #ef4444; margin-bottom: 4px;\">\n                            #${item.ID_INTERCORRENCIA}\n                        </div>\n                        <div style=\"display: flex; gap: 8px; flex-wrap: wrap;\">\n                            <span class=\"badge-status ${statusClass}\">${statusIcon} ${status}</span>\n                            <span class=\"badge-cidade\">${item.CIDADE || 'N/A'}</span>\n                        </div>\n                    </div>\n                </div>\n                \n                <div style=\"display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 12px; font-size: 13px;\">\n                    <div>\n                        <strong>üèçÔ∏è Motoboy:</strong><br>\n                        <span style=\"color: #6b7280;\">${item.NOME_MOTOBOY || 'N/A'}</span>\n                    </div>\n                    <div>\n                        <strong>üì¶ Pedido:</strong><br>\n                        <span style=\"color: #6b7280;\">${item.NUMPED || 'N/A'}</span>\n                    </div>\n                    <div>\n                        <strong>‚è∞ Hora:</strong><br>\n                        <span style=\"color: #6b7280;\">${new Date(item.DATA_INTERCORRENCIA).toLocaleTimeString('pt-BR')}</span>\n                    </div>\n                    <div>\n                        <strong>üè¢ Filial:</strong><br>\n                        <span style=\"color: #6b7280;\">${item.ID_FILIAL || 'N/A'}</span>\n                    </div>\n                    <div style=\"grid-column: 1 / -1;\">\n                        <strong>üìÖ Data:</strong><br>\n                        <span style=\"color: #6b7280;\">${formatarData(item.DATA_INTERCORRENCIA)}</span>\n                    </div>\n                </div>\n                \n                ${item.DESCRICAO ? `\n                    <div style=\"background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 8px;\">\n                        <strong style=\"font-size: 12px; color: #6b7280;\">üìù Descri√ß√£o:</strong><br>\n                        <div style=\"font-size: 13px; color: #374151; margin-top: 4px;\">${item.DESCRICAO}</div>\n                    </div>\n                ` : ''}\n                \n                ${item.JUSTIFICATIVA_APROVACAO ? `\n                    <div style=\"background: ${status === 'APROVADO' ? '#ecfdf5' : '#fee2e2'}; padding: 12px; border-radius: 8px; margin-bottom: 8px;\">\n                        <strong style=\"font-size: 12px; color: ${status === 'APROVADO' ? '#065f46' : '#991b1b'};\">\n                            ${status === 'APROVADO' ? '‚úÖ' : '‚ùå'} Justificativa:\n                        </strong><br>\n                        <div style=\"font-size: 13px; color: ${status === 'APROVADO' ? '#047857' : '#dc2626'}; margin-top: 4px;\">\n                            ${item.JUSTIFICATIVA_APROVACAO}\n                        </div>\n                    </div>\n                ` : ''}\n                \n                <button onclick='abrirModalDetalhes(${JSON.stringify(item).replace(/'/g, \"&apos;\")})' \n                        style=\"background: #7c3aed; color: white; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; width: 100%;\"\n                        onmouseover=\"this.style.background='#6d28d9'\"\n                        onmouseout=\"this.style.background='#7c3aed'\">\n                    üìã Ver Todos os Detalhes\n                </button>\n            </div>\n        `;\n    }).join('');\n    \n    // Mostrar modal\n    document.getElementById('modalTimelineHora').style.display = 'block';\n}\n\n// Fechar modal de timeline\nfunction fecharModalTimeline() {\n    document.getElementById('modalTimelineHora').style.display = 'none';\n}\n\n// Atualizar insights\nfunction atualizarInsights() {\n    // Hor√°rio de pico\n    const horarioStats = {};\n    intercorrenciasFiltradas.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            const data = parsearData(item.DATA_INTERCORRENCIA);\n            if (data) {\n                const hora = data.getHours();\n                horarioStats[hora] = (horarioStats[hora] || 0) + 1;\n            }\n        }\n    });\n    \n    const horarioPico = Object.entries(horarioStats).sort((a, b) => b[1] - a[1])[0];\n    if (horarioPico) {\n        document.querySelector('#insightHorarioPico .insight-value').textContent = \n            String(horarioPico[0]).padStart(2, '0') + ':00';\n    }\n    \n    // Taxa de aprova√ß√£o\n    const total = intercorrenciasFiltradas.length;\n    const aprovadas = intercorrenciasFiltradas.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const taxa = total > 0 ? Math.round((aprovadas / total) * 100) : 0;\n    document.getElementById('insightTaxaAprovacao').textContent = taxa + '%';\n    \n    // Tempo m√©dio de resposta\n    let tempoMedioMinutos = 0;\n    if (total > 0) {\n        const tempos = intercorrenciasFiltradas.map(item => {\n            const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n            const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n            if (match) {\n                const [, dias, horas, minutos] = match;\n                return parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            }\n            return 0;\n        });\n        \n        tempoMedioMinutos = Math.floor(tempos.reduce((sum, t) => sum + t, 0) / tempos.length);\n    }\n    \n    const horasMedia = Math.floor(tempoMedioMinutos / 60);\n    const minutosMedia = tempoMedioMinutos % 60;\n    document.getElementById('insightTempoResposta').textContent = \n        horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n}\n\n// ==================== AN√ÅLISE POR MOTOBOY ====================\n\nfunction inicializarAbaMotoboys() {\n    console.log('üèçÔ∏è Inicializando aba de Motoboys...');\n    \n    // Popular dropdown\n    const select = document.getElementById('selectMotoboy');\n    const motoboys = [...new Set(intercorrenciasOriginais.map(i => i.NOME_MOTOBOY))].sort();\n    \n    select.innerHTML = '<option value=\"\">Selecione um motoboy...</option>' + \n        motoboys.map(m => `<option value=\"${m}\">${m}</option>`).join('');\n    \n    // Gerar tabela de compara√ß√£o\n    gerarTabelaComparacaoMotoboys();\n}\n\nfunction analisarMotoboy(nome) {\n    if (!nome) return;\n    \n    console.log('üèçÔ∏è Analisando motoboy:', nome);\n    \n    const dados = intercorrenciasOriginais.filter(i => i.NOME_MOTOBOY === nome);\n    const total = dados.length;\n    const aprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const taxa = total > 0 ? Math.round((aprovadas / total) * 100) : 0;\n    \n    // Atualizar cards\n    document.getElementById('mbTotalIntercorrencias').textContent = total;\n    document.getElementById('mbTaxaAprovacao').textContent = taxa + '%';\n    \n    // Calcular tempo m√©dio\n    let tempoMedioMinutos = 0;\n    if (total > 0) {\n        const tempos = dados.map(item => {\n            const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n            const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n            if (match) {\n                const [, dias, horas, minutos] = match;\n                return parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            }\n            return 0;\n        });\n        tempoMedioMinutos = Math.floor(tempos.reduce((sum, t) => sum + t, 0) / tempos.length);\n    }\n    const horas = Math.floor(tempoMedioMinutos / 60);\n    const minutos = tempoMedioMinutos % 60;\n    document.getElementById('mbTempoMedio').textContent = horas + ':' + String(minutos).padStart(2, '0');\n    \n    // Gerar gr√°ficos\n    gerarGraficoStatusMotoboy(dados);\n    gerarGraficoCidadesMotoboy(dados);\n    gerarGraficoHorariosMotoboy(dados);\n    gerarGraficoProblemasMotoboy(dados);\n    gerarHistoricoMotoboy(dados);\n}\n\nfunction gerarGraficoStatusMotoboy(dados) {\n    const aprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = dados.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    const total = dados.length;\n    \n    document.getElementById('mbGraficoStatus').innerHTML = `\n        <div class=\"bar-chart\">\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">‚úÖ Aprovadas</div>\n                <div class=\"bar-bg\">\n                    <div class=\"bar-fill\" style=\"width: ${total > 0 ? (aprovadas / total) * 100 : 0}%; background: #10b981;\"></div>\n                </div>\n                <div class=\"bar-value\">${aprovadas}</div>\n            </div>\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">‚ùå Reprovadas</div>\n                <div class=\"bar-bg\">\n                    <div class=\"bar-fill\" style=\"width: ${total > 0 ? (reprovadas / total) * 100 : 0}%; background: #ef4444;\"></div>\n                </div>\n                <div class=\"bar-value\">${reprovadas}</div>\n            </div>\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">‚è≥ Pendentes</div>\n                <div class=\"bar-bg\">\n                    <div class=\"bar-fill\" style=\"width: ${total > 0 ? (pendentes / total) * 100 : 0}%; background: #f59e0b;\"></div>\n                </div>\n                <div class=\"bar-value\">${pendentes}</div>\n            </div>\n        </div>\n    `;\n}\n\nfunction gerarGraficoCidadesMotoboy(dados) {\n    const cidadesCount = {};\n    dados.forEach(item => {\n        cidadesCount[item.CIDADE] = (cidadesCount[item.CIDADE] || 0) + 1;\n    });\n    \n    const top5 = Object.entries(cidadesCount)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5);\n    \n    const maxVal = Math.max(...top5.map(c => c[1]), 1);\n    \n    document.getElementById('mbGraficoCidades').innerHTML = `\n        <div class=\"bar-chart\">\n            ${top5.map(([cidade, count]) => `\n                <div class=\"bar-item\">\n                    <div class=\"bar-label\">${cidade}</div>\n                    <div class=\"bar-bg\">\n                        <div class=\"bar-fill\" style=\"width: ${(count / maxVal) * 100}%; background: #3b82f6;\"></div>\n                    </div>\n                    <div class=\"bar-value\">${count}</div>\n                </div>\n            `).join('')}\n        </div>\n    `;\n}\n\nfunction gerarGraficoHorariosMotoboy(dados) {\n    const horarioStats = {};\n    for (let h = 0; h < 24; h++) horarioStats[h] = 0;\n    \n    dados.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            const data = parsearData(item.DATA_INTERCORRENCIA);\n            if (data) {\n                const hora = data.getHours();\n                if (hora >= 0 && hora < 24) {\n                    horarioStats[hora]++;\n                }\n            }\n        }\n    });\n    \n    const horariosComDados = Object.entries(horarioStats).filter(([h, c]) => c > 0);\n    \n    if (horariosComDados.length === 0) {\n        document.getElementById('mbGraficoHorarios').innerHTML = `\n            <div style=\"padding: 50px; text-align: center; background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%); border-radius: 12px; border: 2px dashed #d1d5db;\">\n                <div style=\"font-size: 64px; margin-bottom: 16px; opacity: 0.3;\">‚è∞</div>\n                <div style=\"font-size: 16px; font-weight: 700; color: #374151; margin-bottom: 8px;\">Sem Dados de Hor√°rio</div>\n                <div style=\"font-size: 13px; color: #6b7280;\">Intercorr√™ncias deste motoboy n√£o possuem registro de hor√°rio</div>\n            </div>\n        `;\n        return;\n    }\n    \n    const maxVal = Math.max(...horariosComDados.map(([h, c]) => c), 1);\n    \n    document.getElementById('mbGraficoHorarios').innerHTML = `\n        <div class=\"bar-chart\">\n            ${horariosComDados\n                .sort((a, b) => b[1] - a[1])\n                .slice(0, 8)\n                .map(([hora, count]) => `\n                    <div class=\"bar-item\">\n                        <div class=\"bar-label\">${String(hora).padStart(2, '0')}:00</div>\n                        <div class=\"bar-bg\">\n                            <div class=\"bar-fill\" style=\"width: ${(count / maxVal) * 100}%; background: #8b5cf6;\"></div>\n                        </div>\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                `).join('')}\n        </div>\n    `;\n}\n\nfunction gerarGraficoProblemasMotoboy(dados) {\n    const problemasCount = {};\n    dados.forEach(item => {\n        const problema = item.TIPO_PROBLEMA || item.DESCRICAO?.substring(0, 40) || 'Sem descri√ß√£o';\n        problemasCount[problema] = (problemasCount[problema] || 0) + 1;\n    });\n    \n    const top5 = Object.entries(problemasCount)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5);\n    \n    const maxVal = Math.max(...top5.map(p => p[1]), 1);\n    \n    // √çcones para diferentes tipos de problemas\n    const getIcone = (problema) => {\n        const p = problema.toLowerCase();\n        if (p.includes('atraso') || p.includes('atrasado')) return '‚è∞';\n        if (p.includes('endereco') || p.includes('endere√ßo')) return 'üìç';\n        if (p.includes('produto') || p.includes('mercadoria')) return 'üì¶';\n        if (p.includes('cliente')) return 'üë§';\n        if (p.includes('veiculo') || p.includes('ve√≠culo') || p.includes('moto')) return 'üèçÔ∏è';\n        if (p.includes('telefone') || p.includes('contato')) return 'üìû';\n        return '‚ö†Ô∏è';\n    };\n    \n    // Cores gradientes para diferentes posi√ß√µes\n    const getCor = (index) => {\n        const cores = [\n            'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)',\n            'linear-gradient(135deg, #f97316 0%, #ea580c 100%)',\n            'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',\n            'linear-gradient(135deg, #eab308 0%, #ca8a04 100%)',\n            'linear-gradient(135deg, #84cc16 0%, #65a30d 100%)'\n        ];\n        return cores[index] || cores[4];\n    };\n    \n    document.getElementById('mbGraficoProblemas').innerHTML = `\n        <div style=\"display: flex; flex-direction: column; gap: 12px;\">\n            ${top5.map(([problema, count], index) => {\n                const porcentagem = Math.round((count / dados.length) * 100);\n                const barWidth = (count / maxVal) * 100;\n                return `\n                    <div style=\"background: white; border-radius: 12px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 5px solid ${index === 0 ? '#ef4444' : index === 1 ? '#f97316' : '#f59e0b'}; transition: all 0.3s; cursor: pointer;\" \n                         onmouseover=\"this.style.transform='translateX(5px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)';\"\n                         onmouseout=\"this.style.transform='translateX(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.08)';\">\n                        <div style=\"display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;\">\n                            <div style=\"display: flex; align-items: center; gap: 12px; flex: 1;\">\n                                <div style=\"font-size: 28px; opacity: 0.8;\">${getIcone(problema)}</div>\n                                <div style=\"flex: 1;\">\n                                    <div style=\"font-size: 13px; font-weight: 700; color: #1f2937; margin-bottom: 4px; line-height: 1.4;\">${problema}</div>\n                                    <div style=\"font-size: 11px; color: #6b7280;\">${porcentagem}% do total</div>\n                                </div>\n                            </div>\n                            <div style=\"text-align: right;\">\n                                <div style=\"font-size: 24px; font-weight: 900; color: #ef4444;\">${count}</div>\n                                <div style=\"font-size: 10px; color: #6b7280; font-weight: 600;\">ocorr√™ncias</div>\n                            </div>\n                        </div>\n                        <div style=\"background: #f3f4f6; border-radius: 8px; height: 8px; overflow: hidden;\">\n                            <div style=\"background: ${getCor(index)}; height: 100%; width: ${barWidth}%; border-radius: 8px; transition: width 0.6s ease;\"></div>\n                        </div>\n                    </div>\n                `;\n            }).join('')}\n        </div>\n    `;\n}\n\nfunction gerarHistoricoMotoboy(dados) {\n    const recentes = dados\n        .sort((a, b) => {\n            const dataA = parsearData(a.DATA_INTERCORRENCIA);\n            const dataB = parsearData(b.DATA_INTERCORRENCIA);\n            if (!dataA || !dataB) return 0;\n            return dataB - dataA;\n        })\n        .slice(0, 10);\n    \n    document.getElementById('mbHistorico').innerHTML = recentes.map(item => {\n        const status = getStatusIntercorrencia(item);\n        const statusClass = status === 'APROVADO' ? 'status-aprovado' : \n                           status === 'REPROVADO' ? 'status-reprovado' : 'status-pendente';\n        const statusIcon = status === 'APROVADO' ? '‚úÖ' : \n                          status === 'REPROVADO' ? '‚ùå' : '‚è≥';\n        \n        return `\n            <div style=\"padding: 12px; background: #f9fafb; border-radius: 8px; margin-bottom: 8px; border-left: 4px solid ${status === 'APROVADO' ? '#10b981' : status === 'REPROVADO' ? '#ef4444' : '#f59e0b'};\">\n                <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;\">\n                    <div>\n                        <span style=\"font-weight: 700; color: #ef4444;\">#${item.ID_INTERCORRENCIA}</span> - \n                        <span style=\"font-weight: 600;\">${item.CIDADE}</span>\n                    </div>\n                    <span class=\"badge-status ${statusClass}\">${statusIcon} ${status}</span>\n                </div>\n                <div style=\"font-size: 12px; color: #6b7280; margin-bottom: 8px;\">\n                    ${formatarData(item.DATA_INTERCORRENCIA)} - ${item.TIPO_PROBLEMA || 'N/A'}\n                </div>\n                <button onclick='abrirModalDetalhes(${JSON.stringify(item).replace(/'/g, \"&apos;\")})' \n                        style=\"background: #7c3aed; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600; width: 100%;\"\n                        onmouseover=\"this.style.background='#6d28d9'\"\n                        onmouseout=\"this.style.background='#7c3aed'\">\n                    üìã Ver Detalhes Completos\n                </button>\n            </div>\n        `;\n    }).join('');\n}\n\nfunction gerarTabelaComparacaoMotoboys() {\n    const motoboyStats = {};\n    \n    intercorrenciasOriginais.forEach(item => {\n        const nome = item.NOME_MOTOBOY;\n        if (!motoboyStats[nome]) {\n            motoboyStats[nome] = { total: 0, aprovadas: 0, reprovadas: 0, pendentes: 0 };\n        }\n        motoboyStats[nome].total++;\n        const status = getStatusIntercorrencia(item);\n        if (status === 'APROVADO') motoboyStats[nome].aprovadas++;\n        else if (status === 'REPROVADO') motoboyStats[nome].reprovadas++;\n        else motoboyStats[nome].pendentes++;\n    });\n    \n    const ranking = Object.entries(motoboyStats)\n        .map(([nome, stats]) => ({\n            nome,\n            ...stats,\n            taxa: stats.total > 0 ? Math.round((stats.aprovadas / stats.total) * 100) : 0\n        }))\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 10);\n    \n    const getPosicaoIcone = (pos) => {\n        if (pos === 0) return 'ü•á';\n        if (pos === 1) return 'ü•à';\n        if (pos === 2) return 'ü•â';\n        return `${pos + 1}¬∫`;\n    };\n    \n    const getPosicaoCor = (pos) => {\n        if (pos === 0) return 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)';\n        if (pos === 1) return 'linear-gradient(135deg, #d1d5db 0%, #9ca3af 100%)';\n        if (pos === 2) return 'linear-gradient(135deg, #fca5a5 0%, #f87171 100%)';\n        return '#f9fafb';\n    };\n    \n    document.getElementById('tabelaComparacaoMotoboys').innerHTML = `\n        <div style=\"background: white; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.08);\">\n            <!-- Header da tabela -->\n            <div style=\"background: linear-gradient(135deg, #1890ff 0%, #0066cc 100%); padding: 20px; color: white;\">\n                <h3 style=\"margin: 0; font-size: 18px; font-weight: 800;\">üèÜ Ranking de Performance</h3>\n                <p style=\"margin: 8px 0 0 0; font-size: 12px; opacity: 0.9;\">Top 10 motoboys com mais intercorr√™ncias</p>\n            </div>\n            \n            <!-- Grid de cards ao inv√©s de tabela -->\n            <div style=\"padding: 20px;\">\n                ${ranking.map((item, i) => `\n                    <div style=\"background: ${getPosicaoCor(i)}; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: all 0.3s; cursor: pointer; border: 2px solid ${i < 3 ? '#fbbf24' : '#e5e7eb'};\"\n                         onmouseover=\"this.style.transform='scale(1.02)'; this.style.boxShadow='0 4px 16px rgba(0,0,0,0.12)';\"\n                         onmouseout=\"this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.06)';\"\n                         onclick=\"document.getElementById('selectMotoboy').value='${item.nome.replace(/'/g, \"\\\\'\")}'; analisarMotoboy('${item.nome.replace(/'/g, \"\\\\'\")}'); window.scrollTo({top: 0, behavior: 'smooth'});\">\n                        \n                        <!-- Linha superior: Posi√ß√£o e Nome -->\n                        <div style=\"display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;\">\n                            <div style=\"display: flex; align-items: center; gap: 12px;\">\n                                <div style=\"font-size: 32px; line-height: 1;\">${getPosicaoIcone(i)}</div>\n                                <div>\n                                    <div style=\"font-size: 14px; font-weight: 800; color: #1f2937;\">${item.nome}</div>\n                                    <div style=\"font-size: 11px; color: #6b7280; margin-top: 2px;\">${item.total} intercorr√™ncias registradas</div>\n                                </div>\n                            </div>\n                            <div style=\"text-align: right;\">\n                                <div style=\"font-size: 28px; font-weight: 900; color: #1890ff;\">${item.total}</div>\n                                <div style=\"font-size: 10px; color: #6b7280; font-weight: 600;\">TOTAL</div>\n                            </div>\n                        </div>\n                        \n                        <!-- Barra de progresso -->\n                        <div style=\"background: #e5e7eb; border-radius: 8px; height: 6px; margin-bottom: 12px; overflow: hidden;\">\n                            <div style=\"display: flex; height: 100%;\">\n                                ${item.aprovadas > 0 ? `<div style=\"background: #10b981; width: ${(item.aprovadas / item.total) * 100}%; transition: width 0.6s ease;\"></div>` : ''}\n                                ${item.reprovadas > 0 ? `<div style=\"background: #ef4444; width: ${(item.reprovadas / item.total) * 100}%; transition: width 0.6s ease;\"></div>` : ''}\n                                ${item.pendentes > 0 ? `<div style=\"background: #f59e0b; width: ${(item.pendentes / item.total) * 100}%; transition: width 0.6s ease;\"></div>` : ''}\n                            </div>\n                        </div>\n                        \n                        <!-- Estat√≠sticas detalhadas -->\n                        <div style=\"display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;\">\n                            <div style=\"text-align: center; padding: 8px; background: rgba(16, 185, 129, 0.1); border-radius: 8px;\">\n                                <div style=\"font-size: 18px; font-weight: 900; color: #10b981;\">${item.aprovadas}</div>\n                                <div style=\"font-size: 9px; color: #059669; font-weight: 600;\">‚úÖ APROV.</div>\n                            </div>\n                            <div style=\"text-align: center; padding: 8px; background: rgba(239, 68, 68, 0.1); border-radius: 8px;\">\n                                <div style=\"font-size: 18px; font-weight: 900; color: #ef4444;\">${item.reprovadas}</div>\n                                <div style=\"font-size: 9px; color: #dc2626; font-weight: 600;\">‚ùå REPROV.</div>\n                            </div>\n                            <div style=\"text-align: center; padding: 8px; background: rgba(245, 158, 11, 0.1); border-radius: 8px;\">\n                                <div style=\"font-size: 18px; font-weight: 900; color: #f59e0b;\">${item.pendentes}</div>\n                                <div style=\"font-size: 9px; color: #d97706; font-weight: 600;\">‚è≥ PEND.</div>\n                            </div>\n                            <div style=\"text-align: center; padding: 8px; background: rgba(24, 144, 255, 0.1); border-radius: 8px;\">\n                                <div style=\"font-size: 18px; font-weight: 900; color: #1890ff;\">${item.taxa}%</div>\n                                <div style=\"font-size: 9px; color: #0066cc; font-weight: 600;\">üìä TAXA</div>\n                            </div>\n                        </div>\n                    </div>\n                `).join('')}\n            </div>\n            \n            <!-- Footer com resumo -->\n            <div style=\"background: #f9fafb; padding: 16px; border-top: 2px solid #e5e7eb; text-align: center;\">\n                <div style=\"font-size: 11px; color: #6b7280;\">\n                    üí° <strong>Dica:</strong> Clique em qualquer card para ver an√°lise detalhada do motoboy\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n// ==================== AN√ÅLISE POR ESTADO/UF ====================\n\nfunction extrairUF(item) {\n    const cidade = (item.CIDADE || '').trim().toUpperCase();\n    \n    // Mapa de siglas de cidades para UFs\n    const cidadeParaUF = {\n        // Capitais e principais cidades\n        'SP': 'SP', 'SAO PAULO': 'SP', 'S√ÉO PAULO': 'SP',\n        'RJ': 'RJ', 'RIO DE JANEIRO': 'RJ',\n        'BH': 'MG', 'BELO HORIZONTE': 'MG',\n        'DF': 'DF', 'BRASILIA': 'DF', 'BRAS√çLIA': 'DF', 'BSB': 'DF',\n        'CTBA': 'PR', 'CURITIBA': 'PR', 'CWB': 'PR',\n        'POA': 'RS', 'PORTO ALEGRE': 'RS',\n        'RECIFE': 'PE', 'REC': 'PE',\n        'SALVADOR': 'BA', 'SSA': 'BA',\n        'FORTALEZA': 'CE',\n        'MANAUS': 'AM',\n        'BELEM': 'PA', 'BEL√âM': 'PA',\n        'GOIANIA': 'GO', 'GOI√ÇNIA': 'GO', 'GYN': 'GO',\n        'VITORIA': 'ES', 'VIT√ìRIA': 'ES', 'VIX': 'ES',\n        'FLORIPA': 'SC', 'FLORIANOPOLIS': 'SC', 'FLORIAN√ìPOLIS': 'SC', 'FLN': 'SC',\n        'NATAL': 'RN',\n        'JOAO PESSOA': 'PB', 'JO√ÉO PESSOA': 'PB',\n        'MACEIO': 'AL', 'MACEI√ì': 'AL',\n        'ARACAJU': 'SE',\n        'SAO LUIS': 'MA', 'S√ÉO LU√çS': 'MA',\n        'TERESINA': 'PI',\n        'CAMPO GRANDE': 'MS',\n        'CUIABA': 'MT', 'CUIAB√Å': 'MT',\n        'PALMAS': 'TO',\n        'RIO BRANCO': 'AC',\n        'MACAPA': 'AP', 'MACAP√Å': 'AP',\n        'BOA VISTA': 'RR',\n        'PORTO VELHO': 'RO'\n    };\n    \n    // Primeiro: verificar se cidade est√° no mapa\n    if (cidadeParaUF[cidade]) {\n        return cidadeParaUF[cidade];\n    }\n    \n    // Segundo: verificar se √© uma UF v√°lida de 2 letras\n    const ufsValidas = ['AC','AL','AP','AM','BA','CE','DF','ES','GO','MA','MT','MS','MG','PA','PB','PR','PE','PI','RJ','RN','RS','RO','RR','SC','SP','SE','TO'];\n    if (cidade.length === 2 && ufsValidas.includes(cidade)) {\n        return cidade;\n    }\n    \n    // Terceiro: tentar extrair UF do final da string (formato \"CIDADE - UF\")\n    const match = cidade.match(/[-\\/\\(,\\s]+([A-Z]{2})[\\),\\s]*$/);\n    if (match && match[1] && ufsValidas.includes(match[1])) {\n        return match[1];\n    }\n    \n    // Fallback: usar ID_FILIAL\n    const filialUFMap = {\n        1: 'SP', 2: 'SP', 3: 'RJ', 4: 'MG', 5: 'ES', 6: 'BA', 7: 'MG', 8: 'PE',\n        9: 'PB', 10: 'RN', 11: 'CE', 12: 'PR', 13: 'SP', 14: 'PA', 15: 'DF',\n        16: 'RJ', 17: 'RR', 18: 'AC', 19: 'RO', 20: 'MT', 21: 'MS', 22: 'GO',\n        23: 'DF', 24: 'TO', 25: 'PR', 26: 'SC', 27: 'RS'\n    };\n    \n    return filialUFMap[item.ID_FILIAL] || null;\n}\n\nfunction inicializarAbaEstados() {\n    console.log('üó∫Ô∏è Inicializando aba de Estados...');\n    \n    // Popular dropdown com UFs\n    const select = document.getElementById('selectEstado');\n    const ufsSet = new Set();\n    \n    intercorrenciasOriginais.forEach(item => {\n        const uf = extrairUF(item);\n        if (uf) ufsSet.add(uf);\n    });\n    \n    const ufs = Array.from(ufsSet).sort();\n    \n    select.innerHTML = '<option value=\"\">Selecione um estado...</option>' + \n        ufs.map(uf => `<option value=\"${uf}\">${uf}</option>`).join('');\n    \n    console.log('üó∫Ô∏è UFs detectadas:', ufs);\n    \n    // Gerar tabela de compara√ß√£o\n    gerarTabelaComparacaoEstados();\n}\n\nfunction analisarEstado(uf) {\n    if (!uf) return;\n    \n    console.log('üó∫Ô∏è Analisando estado:', uf);\n    \n    const dados = intercorrenciasOriginais.filter(i => extrairUF(i) === uf);\n    const total = dados.length;\n    const aprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const taxa = total > 0 ? Math.round((aprovadas / total) * 100) : 0;\n    const motoboys = new Set(dados.map(i => i.NOME_MOTOBOY)).size;\n    \n    // Atualizar cards\n    document.getElementById('estTotalIntercorrencias').textContent = total;\n    document.getElementById('estTaxaAprovacao').textContent = taxa + '%';\n    document.getElementById('estTotalMotoboys').textContent = motoboys;\n    \n    // Gerar gr√°ficos\n    gerarGraficoStatusEstado(dados);\n    gerarGraficoCidadesEstado(dados);\n    gerarGraficoMotoboysEstado(dados);\n    gerarGraficoProblemasEstado(dados);\n}\n\nfunction gerarGraficoStatusEstado(dados) {\n    const aprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = dados.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    const total = dados.length;\n    \n    document.getElementById('estGraficoStatus').innerHTML = `\n        <div class=\"bar-chart\">\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">‚úÖ Aprovadas</div>\n                <div class=\"bar-bg\">\n                    <div class=\"bar-fill\" style=\"width: ${total > 0 ? (aprovadas / total) * 100 : 0}%; background: #10b981;\"></div>\n                </div>\n                <div class=\"bar-value\">${aprovadas}</div>\n            </div>\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">‚ùå Reprovadas</div>\n                <div class=\"bar-bg\">\n                    <div class=\"bar-fill\" style=\"width: ${total > 0 ? (reprovadas / total) * 100 : 0}%; background: #ef4444;\"></div>\n                </div>\n                <div class=\"bar-value\">${reprovadas}</div>\n            </div>\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">‚è≥ Pendentes</div>\n                <div class=\"bar-bg\">\n                    <div class=\"bar-fill\" style=\"width: ${total > 0 ? (pendentes / total) * 100 : 0}%; background: #f59e0b;\"></div>\n                </div>\n                <div class=\"bar-value\">${pendentes}</div>\n            </div>\n        </div>\n    `;\n}\n\nfunction gerarGraficoCidadesEstado(dados) {\n    const cidadesCount = {};\n    dados.forEach(item => {\n        cidadesCount[item.CIDADE] = (cidadesCount[item.CIDADE] || 0) + 1;\n    });\n    \n    const top8 = Object.entries(cidadesCount)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 8);\n    \n    const maxVal = Math.max(...top8.map(c => c[1]), 1);\n    \n    document.getElementById('estGraficoCidades').innerHTML = `\n        <div class=\"bar-chart\">\n            ${top8.map(([cidade, count]) => `\n                <div class=\"bar-item\">\n                    <div class=\"bar-label\">${cidade}</div>\n                    <div class=\"bar-bg\">\n                        <div class=\"bar-fill\" style=\"width: ${(count / maxVal) * 100}%; background: #10b981;\"></div>\n                    </div>\n                    <div class=\"bar-value\">${count}</div>\n                </div>\n            `).join('')}\n        </div>\n    `;\n}\n\nfunction gerarGraficoMotoboysEstado(dados) {\n    const motoboyCount = {};\n    dados.forEach(item => {\n        motoboyCount[item.NOME_MOTOBOY] = (motoboyCount[item.NOME_MOTOBOY] || 0) + 1;\n    });\n    \n    const top8 = Object.entries(motoboyCount)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 8);\n    \n    const maxVal = Math.max(...top8.map(m => m[1]), 1);\n    \n    document.getElementById('estGraficoMotoboys').innerHTML = `\n        <div class=\"bar-chart\">\n            ${top8.map(([motoboy, count]) => `\n                <div class=\"bar-item\">\n                    <div class=\"bar-label\">${motoboy}</div>\n                    <div class=\"bar-bg\">\n                        <div class=\"bar-fill\" style=\"width: ${(count / maxVal) * 100}%; background: #1890ff;\"></div>\n                    </div>\n                    <div class=\"bar-value\">${count}</div>\n                </div>\n            `).join('')}\n        </div>\n    `;\n}\n\nfunction gerarGraficoProblemasEstado(dados) {\n    const problemasCount = {};\n    dados.forEach(item => {\n        const problema = item.TIPO_PROBLEMA || 'N√£o especificado';\n        problemasCount[problema] = (problemasCount[problema] || 0) + 1;\n    });\n    \n    const top5 = Object.entries(problemasCount)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5);\n    \n    const maxVal = Math.max(...top5.map(p => p[1]), 1);\n    \n    document.getElementById('estGraficoProblemas').innerHTML = `\n        <div class=\"bar-chart\">\n            ${top5.map(([problema, count]) => `\n                <div class=\"bar-item\">\n                    <div class=\"bar-label\">${problema}</div>\n                    <div class=\"bar-bg\">\n                        <div class=\"bar-fill\" style=\"width: ${(count / maxVal) * 100}%; background: #ef4444;\"></div>\n                    </div>\n                    <div class=\"bar-value\">${count}</div>\n                </div>\n            `).join('')}\n        </div>\n    `;\n}\n\nfunction gerarTabelaComparacaoEstados() {\n    const estadoStats = {};\n    \n    intercorrenciasOriginais.forEach(item => {\n        const uf = extrairUF(item);\n        if (!uf) return;\n        \n        if (!estadoStats[uf]) {\n            estadoStats[uf] = { total: 0, aprovadas: 0, reprovadas: 0, pendentes: 0 };\n        }\n        estadoStats[uf].total++;\n        const status = getStatusIntercorrencia(item);\n        if (status === 'APROVADO') estadoStats[uf].aprovadas++;\n        else if (status === 'REPROVADO') estadoStats[uf].reprovadas++;\n        else estadoStats[uf].pendentes++;\n    });\n    \n    const ranking = Object.entries(estadoStats)\n        .map(([uf, stats]) => ({\n            uf,\n            ...stats,\n            taxa: stats.total > 0 ? Math.round((stats.aprovadas / stats.total) * 100) : 0\n        }))\n        .sort((a, b) => b.total - a.total);\n    \n    const getPosicaoIcone = (pos) => {\n        if (pos === 0) return 'ü•á';\n        if (pos === 1) return 'ü•à';\n        if (pos === 2) return 'ü•â';\n        return `${pos + 1}¬∫`;\n    };\n    \n    const getPosicaoCor = (pos) => {\n        if (pos === 0) return 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)';\n        if (pos === 1) return 'linear-gradient(135deg, #d1d5db 0%, #9ca3af 100%)';\n        if (pos === 2) return 'linear-gradient(135deg, #fca5a5 0%, #f87171 100%)';\n        return '#f9fafb';\n    };\n    \n    const getUFBandeira = (uf) => {\n        // Emojis representativos (pode ajustar conforme necess√°rio)\n        const bandeiras = {\n            'SP': 'üèôÔ∏è', 'RJ': 'üèñÔ∏è', 'MG': '‚õ∞Ô∏è', 'ES': 'üåä', 'BA': 'ü••',\n            'SE': 'üå¥', 'AL': 'üèùÔ∏è', 'PE': 'üé≠', 'PB': 'üåÑ', 'RN': 'üèúÔ∏è',\n            'CE': '‚õ±Ô∏è', 'PI': 'üåæ', 'MA': 'üåø', 'PA': 'üå≥', 'AP': 'üå≤',\n            'AM': 'üå¥', 'RR': 'üèîÔ∏è', 'AC': 'üå≤', 'RO': 'üå≥', 'MT': 'üåæ',\n            'MS': 'üêü', 'GO': 'üåª', 'DF': 'üèõÔ∏è', 'TO': 'üåä', 'PR': 'üå≤',\n            'SC': 'üèîÔ∏è', 'RS': 'üç∑'\n        };\n        return bandeiras[uf] || 'üìç';\n    };\n    \n    document.getElementById('tabelaComparacaoEstados').innerHTML = `\n        <div style=\"background: white; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.08);\">\n            <!-- Header -->\n            <div style=\"background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 20px; color: white;\">\n                <h3 style=\"margin: 0; font-size: 18px; font-weight: 800;\">üó∫Ô∏è Ranking por Estado (UF)</h3>\n                <p style=\"margin: 8px 0 0 0; font-size: 12px; opacity: 0.9;\">${ranking.length} estados com intercorr√™ncias registradas</p>\n            </div>\n            \n            <!-- Grid de cards -->\n            <div style=\"padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 16px;\">\n                ${ranking.map((item, i) => `\n                    <div style=\"background: ${getPosicaoCor(i)}; border-radius: 12px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: all 0.3s; cursor: pointer; border: 2px solid ${i < 3 ? '#10b981' : '#e5e7eb'};\"\n                         onmouseover=\"this.style.transform='translateY(-5px)'; this.style.boxShadow='0 6px 20px rgba(0,0,0,0.15)';\"\n                         onmouseout=\"this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.06)';\"\n                         onclick=\"document.getElementById('selectEstado').value='${item.uf}'; analisarEstado('${item.uf}'); window.scrollTo({top: 0, behavior: 'smooth'});\">\n                        \n                        <!-- Header do card -->\n                        <div style=\"display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;\">\n                            <div style=\"display: flex; align-items: center; gap: 12px;\">\n                                <div style=\"font-size: 28px; line-height: 1;\">${getPosicaoIcone(i)}</div>\n                                <div style=\"font-size: 36px; line-height: 1;\">${getUFBandeira(item.uf)}</div>\n                                <div>\n                                    <div style=\"font-size: 24px; font-weight: 900; color: #1f2937; letter-spacing: 2px;\">${item.uf}</div>\n                                    <div style=\"font-size: 10px; color: #6b7280; font-weight: 600; text-transform: uppercase;\">Estado</div>\n                                </div>\n                            </div>\n                            <div style=\"text-align: right;\">\n                                <div style=\"font-size: 32px; font-weight: 900; color: #10b981;\">${item.total}</div>\n                                <div style=\"font-size: 9px; color: #6b7280; font-weight: 700;\">TOTAL</div>\n                            </div>\n                        </div>\n                        \n                        <!-- Barra de progresso multicolor -->\n                        <div style=\"background: #e5e7eb; border-radius: 8px; height: 8px; margin-bottom: 12px; overflow: hidden;\">\n                            <div style=\"display: flex; height: 100%;\">\n                                ${item.aprovadas > 0 ? `<div style=\"background: linear-gradient(90deg, #10b981, #059669); width: ${(item.aprovadas / item.total) * 100}%; transition: width 0.6s ease;\" title=\"${item.aprovadas} aprovadas\"></div>` : ''}\n                                ${item.reprovadas > 0 ? `<div style=\"background: linear-gradient(90deg, #ef4444, #dc2626); width: ${(item.reprovadas / item.total) * 100}%; transition: width 0.6s ease;\" title=\"${item.reprovadas} reprovadas\"></div>` : ''}\n                                ${item.pendentes > 0 ? `<div style=\"background: linear-gradient(90deg, #f59e0b, #d97706); width: ${(item.pendentes / item.total) * 100}%; transition: width 0.6s ease;\" title=\"${item.pendentes} pendentes\"></div>` : ''}\n                            </div>\n                        </div>\n                        \n                        <!-- Grid de estat√≠sticas -->\n                        <div style=\"display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px;\">\n                            <div style=\"text-align: center; padding: 8px 4px; background: rgba(16, 185, 129, 0.12); border-radius: 6px;\">\n                                <div style=\"font-size: 16px; font-weight: 900; color: #10b981;\">${item.aprovadas}</div>\n                                <div style=\"font-size: 8px; color: #059669; font-weight: 700; margin-top: 2px;\">‚úÖ</div>\n                            </div>\n                            <div style=\"text-align: center; padding: 8px 4px; background: rgba(239, 68, 68, 0.12); border-radius: 6px;\">\n                                <div style=\"font-size: 16px; font-weight: 900; color: #ef4444;\">${item.reprovadas}</div>\n                                <div style=\"font-size: 8px; color: #dc2626; font-weight: 700; margin-top: 2px;\">‚ùå</div>\n                            </div>\n                            <div style=\"text-align: center; padding: 8px 4px; background: rgba(245, 158, 11, 0.12); border-radius: 6px;\">\n                                <div style=\"font-size: 16px; font-weight: 900; color: #f59e0b;\">${item.pendentes}</div>\n                                <div style=\"font-size: 8px; color: #d97706; font-weight: 700; margin-top: 2px;\">‚è≥</div>\n                            </div>\n                            <div style=\"text-align: center; padding: 8px 4px; background: rgba(16, 185, 129, 0.12); border-radius: 6px;\">\n                                <div style=\"font-size: 16px; font-weight: 900; color: #10b981;\">${item.taxa}%</div>\n                                <div style=\"font-size: 8px; color: #059669; font-weight: 700; margin-top: 2px;\">üìä</div>\n                            </div>\n                        </div>\n                    </div>\n                `).join('')}\n            </div>\n            \n            <!-- Footer -->\n            <div style=\"background: #f9fafb; padding: 16px; border-top: 2px solid #e5e7eb; text-align: center;\">\n                <div style=\"font-size: 11px; color: #6b7280;\">\n                    üí° <strong>Dica:</strong> Clique em qualquer estado para ver an√°lise detalhada\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n// Toggle Analytics\nfunction toggleAnalytics() {\n    const content = document.getElementById('analyticsContent');\n    const btn = document.getElementById('btnToggleAnalytics');\n    \n    if (content.style.display === 'none') {\n        content.style.display = 'block';\n        btn.textContent = 'üìä Recolher';\n    } else {\n        content.style.display = 'none';\n        btn.textContent = 'üìä Expandir';\n    }\n}\n\n// Fun√ß√µes para filtrar pelos gr√°ficos\nfunction filtrarPorFilial(filial) {\n    console.log('üè¢ Filtrando por filial:', filial);\n    \n    // Limpar outros filtros e aplicar filtro de filial\n    document.getElementById('filtroAprovacao').value = '';\n    document.getElementById('filtroCidade').value = '';\n    document.getElementById('filtroMotoboy').value = '';\n    document.getElementById('filtroData').value = '';\n    document.getElementById('filtroPedido').value = '';\n    \n    // Aplicar filtro espec√≠fico por filial (usar campo correto)\n    intercorrenciasFiltradas = intercorrenciasOriginais.filter(item => item.ID_FILIAL === filial);\n    \n    atualizarEstatisticas();\n    renderizar();\n    atualizarResultados();\n    \n    console.log('‚úÖ Filtrado por filial ' + filial + ': ' + intercorrenciasFiltradas.length + ' registros');\n}\n\nfunction filtrarPorMotoboy(motoboy) {\n    console.log('üèçÔ∏è Filtrando por motoboy:', motoboy);\n    \n    // Limpar outros filtros\n    document.getElementById('filtroAprovacao').value = '';\n    document.getElementById('filtroCidade').value = '';\n    document.getElementById('filtroData').value = '';\n    document.getElementById('filtroPedido').value = '';\n    \n    // Aplicar filtro de motoboy\n    document.getElementById('filtroMotoboy').value = motoboy;\n    aplicarFiltros();\n}\n\nfunction filtrarPorCidade(cidade) {\n    console.log('üèôÔ∏è Filtrando por cidade:', cidade);\n    \n    // Limpar outros filtros  \n    document.getElementById('filtroAprovacao').value = '';\n    document.getElementById('filtroMotoboy').value = '';\n    document.getElementById('filtroData').value = '';\n    document.getElementById('filtroPedido').value = '';\n    \n    // Aplicar filtro de cidade\n    document.getElementById('filtroCidade').value = cidade;\n    aplicarFiltros();\n}\n\n// Alterar modo de visualiza√ß√£o\nfunction alterarModo(modo) {\n    modoVisualizacao = modo;\n    \n    document.getElementById('btnCards').classList.toggle('ativo', modo === 'cards');\n    document.getElementById('btnLista').classList.toggle('ativo', modo === 'lista');\n    \n    document.getElementById('intercorrenciasGrid').style.display = modo === 'cards' ? 'grid' : 'none';\n    document.getElementById('intercorrenciasLista').style.display = modo === 'lista' ? 'block' : 'none';\n    \n    renderizar();\n    console.log('üëÄ Modo alterado para:', modo);\n}\n\n// Limpar filtros\nfunction limparFiltros() {\n    document.getElementById('filtroAprovacao').value = '';\n    document.getElementById('filtroCidade').value = '';\n    document.getElementById('filtroMotoboy').value = '';\n    document.getElementById('filtroData').value = '';\n    document.getElementById('filtroPedido').value = '';\n    \n    aplicarFiltros();\n    console.log('üßπ Filtros limpos');\n}\n\n// Atualizar texto de resultados\nfunction atualizarResultados() {\n    const elemento = document.getElementById('resultadosFiltro');\n    if (intercorrenciasFiltradas.length === intercorrenciasOriginais.length) {\n        elemento.textContent = 'Mostrando todas as ' + intercorrenciasFiltradas.length + ' intercorr√™ncias';\n    } else {\n        elemento.textContent = 'Mostrando ' + intercorrenciasFiltradas.length + ' de ' + intercorrenciasOriginais.length + ' intercorr√™ncias';\n    }\n}\n\n// Abrir modal com imagem\nfunction abrirModal(urlImagem, idIntercorrencia) {\n    const modal = document.getElementById('modalImagem');\n    const conteudo = document.getElementById('modalImagemConteudo');\n    \n    conteudo.innerHTML = `\n        <div style=\"text-align: center;\">\n            <h3 style=\"color: #ef4444; margin-bottom: 16px;\">Intercorr√™ncia #${idIntercorrencia}</h3>\n            <img src=\"${urlImagem}\" \n                 alt=\"Foto da intercorr√™ncia\" \n                 style=\"max-width: 100%; max-height: 70vh; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2);\">\n            <div style=\"margin-top: 12px;\">\n                <a href=\"${urlImagem}\" target=\"_blank\" style=\"color: #1890ff; text-decoration: none; font-weight: 600;\">\n                    üîó Abrir em nova aba\n                </a>\n            </div>\n        </div>\n    `;\n    \n    modal.style.display = 'block';\n}\n\n// Fechar modal\nfunction fecharModal() {\n    document.getElementById('modalImagem').style.display = 'none';\n}\n\n// Selecionar item da lista\nfunction selecionarItem(index) {\n    const item = intercorrenciasFiltradas[index];\n    console.log('üìã Item selecionado:', item.ID_INTERCORRENCIA);\n    \n    // Remover sele√ß√£o anterior\n    document.querySelectorAll('.lista-item').forEach(el => {\n        el.style.background = '';\n        el.style.fontWeight = '';\n    });\n    \n    // Destacar item selecionado\n    const itemElement = document.querySelectorAll('.lista-item')[index];\n    if (itemElement) {\n        itemElement.style.background = '#eff6ff';\n        itemElement.style.fontWeight = '700';\n    }\n    \n    // Aqui voc√™ pode disparar outros eventos, como abrir modal de detalhes\n}\n\n// Atualizar dados\nfunction atualizarDados() {\n    console.log('üîÑ Atualizando dados...');\n    location.reload();\n}\n\n// Exportar dados\nfunction exportarDados() {\n    console.log('üìä Exportando dados...');\n    \n    const dadosExport = intercorrenciasFiltradas.map(item => ({\n        ID: item.ID_INTERCORRENCIA,\n        Cidade: item.CIDADE,\n        Motoboy: item.NOME_MOTOBOY,\n        Pedido: item.NUMPED,\n        Data: item.DATA_INTERCORRENCIA,\n        Tempo: formatarTempo(item.TEMPO_INTERCORRENCIA),\n        Descricao: item.DESCRICAO,\n        Status: item.APROVACAO_INTERCORRENCIA === 'TRUE' ? 'Aprovada' : 'Pendente',\n        Lancamento: item.NOME_LANCAMENTO\n    }));\n    \n    const csvContent = 'data:text/csv;charset=utf-8,' + \n        'ID,Cidade,Motoboy,Pedido,Data,Tempo,Descricao,Status,Lancamento\\n' +\n        dadosExport.map(row => Object.values(row).map(val => '\"' + (val || '').toString().replace(/\"/g, '\"\"') + '\"').join(',')).join('\\n');\n    \n    const encodedUri = encodeURI(csvContent);\n    const link = document.createElement('a');\n    link.setAttribute('href', encodedUri);\n    link.setAttribute('download', 'intercorrencias_' + new Date().toISOString().split('T')[0] + '.csv');\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    \n    console.log('üìä CSV exportado com ' + dadosExport.length + ' registros');\n}\n\n// Debug do sistema\nfunction debugSistema() {\n    console.log('üîç === DEBUG INTERCORR√äNCIAS BI 2.0 ===');\n    \n    const modal = document.getElementById('modalDebug');\n    const conteudo = document.getElementById('modalDebugConteudo');\n    \n    let html = '';\n    \n    // Dados B√°sicos\n    html += `\n        <div style=\"background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%); color: white; padding: 24px; border-radius: 12px; margin-bottom: 20px;\">\n            <h3 style=\"margin: 0 0 12px 0; font-size: 20px;\">üìä Resumo Geral</h3>\n            <div style=\"display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;\">\n                <div>\n                    <div style=\"font-size: 36px; font-weight: 900;\">${intercorrenciasOriginais.length}</div>\n                    <div style=\"opacity: 0.9;\">Registros Originais</div>\n                </div>\n                <div>\n                    <div style=\"font-size: 36px; font-weight: 900;\">${intercorrenciasFiltradas.length}</div>\n                    <div style=\"opacity: 0.9;\">Registros Filtrados</div>\n                </div>\n            </div>\n        </div>\n    `;\n    \n    if (intercorrenciasOriginais.length > 0) {\n        // Distribui√ß√£o de Status\n        const aprovadas = intercorrenciasOriginais.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n        const reprovadas = intercorrenciasOriginais.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n        const pendentes = intercorrenciasOriginais.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n        \n        html += `\n            <div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 5px solid #10b981;\">\n                <h3 style=\"color: #10b981; margin-bottom: 16px;\">üìä Distribui√ß√£o de Status</h3>\n                <div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;\">\n                    <div style=\"text-align: center; padding: 16px; background: #ecfdf5; border-radius: 8px;\">\n                        <div style=\"font-size: 32px; font-weight: 900; color: #065f46;\">${aprovadas}</div>\n                        <div style=\"font-size: 13px; color: #065f46;\">‚úÖ Aprovadas</div>\n                    </div>\n                    <div style=\"text-align: center; padding: 16px; background: #fee2e2; border-radius: 8px;\">\n                        <div style=\"font-size: 32px; font-weight: 900; color: #991b1b;\">${reprovadas}</div>\n                        <div style=\"font-size: 13px; color: #991b1b;\">‚ùå Reprovadas</div>\n                    </div>\n                    <div style=\"text-align: center; padding: 16px; background: #fef3c7; border-radius: 8px;\">\n                        <div style=\"font-size: 32px; font-weight: 900; color: #92400e;\">${pendentes}</div>\n                        <div style=\"font-size: 13px; color: #92400e;\">‚è≥ Pendentes</div>\n                    </div>\n                </div>\n            </div>\n        `;\n        \n        // Campos Dispon√≠veis\n        const campos = Object.keys(intercorrenciasOriginais[0]);\n        html += `\n            <div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 5px solid #f59e0b;\">\n                <h3 style=\"color: #f59e0b; margin-bottom: 16px;\">üîë Campos Dispon√≠veis (${campos.length})</h3>\n                <div style=\"display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;\">\n                    ${campos.map(campo => `\n                        <div style=\"background: #fef3c7; padding: 10px; border-radius: 6px; font-size: 11px; font-weight: 600; text-align: center;\">\n                            ${campo}\n                        </div>\n                    `).join('')}\n                </div>\n            </div>\n        `;\n        \n        // Exemplo de Registro\n        html += `\n            <div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 5px solid #8b5cf6;\">\n                <h3 style=\"color: #8b5cf6; margin-bottom: 16px;\">üìù Exemplo de Registro (Primeiro)</h3>\n                <pre style=\"background: #f9fafb; padding: 16px; border-radius: 8px; overflow-x: auto; font-size: 11px; max-height: 300px; overflow-y: auto;\">\n${JSON.stringify(intercorrenciasOriginais[0], null, 2)}\n                </pre>\n            </div>\n        `;\n        \n        // Analytics\n        const filiaisCount = document.getElementById('graficoFiliais')?.children.length || 0;\n        const motoboysCount = document.getElementById('graficoMotoboys')?.children.length || 0;\n        const cidadesCount = document.getElementById('graficoCidades')?.children.length || 0;\n        \n        html += `\n            <div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 5px solid #1890ff;\">\n                <h3 style=\"color: #1890ff; margin-bottom: 16px;\">üìà Analytics Gerados</h3>\n                <div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;\">\n                    <div style=\"text-align: center; padding: 16px; background: #f0f9ff; border-radius: 8px;\">\n                        <div style=\"font-size: 32px; font-weight: 900; color: #1890ff;\">${filiaisCount}</div>\n                        <div style=\"font-size: 13px; color: #1890ff;\">üè¢ Gr√°fico Filiais</div>\n                    </div>\n                    <div style=\"text-align: center; padding: 16px; background: #f0f9ff; border-radius: 8px;\">\n                        <div style=\"font-size: 32px; font-weight: 900; color: #1890ff;\">${motoboysCount}</div>\n                        <div style=\"font-size: 13px; color: #1890ff;\">üèçÔ∏è Gr√°fico Motoboys</div>\n                    </div>\n                    <div style=\"text-align: center; padding: 16px; background: #f0f9ff; border-radius: 8px;\">\n                        <div style=\"font-size: 32px; font-weight: 900; color: #1890ff;\">${cidadesCount}</div>\n                        <div style=\"font-size: 13px; color: #1890ff;\">üèôÔ∏è Gr√°fico Cidades</div>\n                    </div>\n                </div>\n            </div>\n        `;\n        \n        // Imagens\n        const comImagem = intercorrenciasOriginais.filter(i => i.URLS_FOTOS && i.URLS_FOTOS.trim()).length;\n        html += `\n            <div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 5px solid #ec4899;\">\n                <h3 style=\"color: #ec4899; margin-bottom: 16px;\">üì∑ Registros com Imagens</h3>\n                <div style=\"text-align: center; padding: 24px; background: #fce7f3; border-radius: 8px;\">\n                    <div style=\"font-size: 48px; font-weight: 900; color: #ec4899;\">${comImagem}</div>\n                    <div style=\"font-size: 14px; color: #ec4899;\">Intercorr√™ncias com fotos anexadas</div>\n                </div>\n            </div>\n        `;\n        \n        // UFs Detectadas\n        const ufsMap = {};\n        intercorrenciasOriginais.forEach(i => {\n            const uf = extrairUF(i);\n            if (uf) {\n                ufsMap[uf] = (ufsMap[uf] || 0) + 1;\n            }\n        });\n        const ufs = Object.keys(ufsMap).sort();\n        \n        html += `\n            <div style=\"background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 5px solid #14b8a6;\">\n                <h3 style=\"color: #14b8a6; margin-bottom: 16px;\">üó∫Ô∏è UFs Detectadas (${ufs.length})</h3>\n                ${ufs.length > 0 ? `\n                    <div style=\"display: grid; grid-template-columns: repeat(6, 1fr); gap: 12px;\">\n                        ${ufs.map(uf => `\n                            <div style=\"text-align: center; padding: 12px; background: #ccfbf1; border-radius: 8px;\">\n                                <div style=\"font-size: 24px; font-weight: 900; color: #14b8a6;\">${uf}</div>\n                                <div style=\"font-size: 11px; color: #14b8a6;\">${ufsMap[uf]} reg.</div>\n                            </div>\n                        `).join('')}\n                    </div>\n                ` : `\n                    <div style=\"padding: 20px; background: #fef3c7; border-radius: 8px; color: #92400e; text-align: center;\">\n                        ‚ö†Ô∏è Nenhuma UF foi detectada. Verifique o formato do campo CIDADE.\n                    </div>\n                `}\n            </div>\n        `;\n    } else {\n        html += `\n            <div style=\"background: #fee2e2; border-radius: 12px; padding: 40px; text-align: center; border-left: 5px solid #dc2626;\">\n                <div style=\"font-size: 64px; margin-bottom: 20px;\">‚ö†Ô∏è</div>\n                <h3 style=\"color: #dc2626; margin-bottom: 12px;\">Nenhum Dado Carregado!</h3>\n                <p style=\"color: #991b1b;\">A vari√°vel intercorrenciasOriginais est√° vazia.</p>\n                <p style=\"color: #991b1b;\">Verifique se intercorrencias_bi20 existe e cont√©m dados.</p>\n            </div>\n        `;\n    }\n    \n    conteudo.innerHTML = html;\n    modal.style.display = 'block';\n    \n    // Tamb√©m logar no console\n    console.log('üì¶ Dados originais:', intercorrenciasOriginais.length);\n    console.log('üîç Dados filtrados:', intercorrenciasFiltradas.length);\n    console.log('üîç === DEBUG FINALIZADO ===');\n}\n\n// Fechar modal de debug\nfunction fecharModalDebug() {\n    document.getElementById('modalDebug').style.display = 'none';\n}\n\n// Abrir modal de detalhes\nfunction abrirModalDetalhes(intercorrencia) {\n    const modal = document.getElementById('modalDetalhesIntercorrencia');\n    const conteudo = document.getElementById('modalDetalhesConteudo');\n    \n    if (!intercorrencia) {\n        console.error('Intercorr√™ncia n√£o encontrada');\n        return;\n    }\n    \n    const status = getStatusIntercorrencia(intercorrencia);\n    let statusBadge = '';\n    let statusColor = '';\n    \n    if (status === 'APROVADO') {\n        statusBadge = '<span style=\"background: #d1fae5; color: #065f46; padding: 8px 16px; border-radius: 8px; font-weight: 700; font-size: 14px;\">‚úÖ APROVADO</span>';\n        statusColor = '#10b981';\n    } else if (status === 'REPROVADO') {\n        statusBadge = '<span style=\"background: #fee2e2; color: #991b1b; padding: 8px 16px; border-radius: 8px; font-weight: 700; font-size: 14px;\">‚ùå REPROVADO</span>';\n        statusColor = '#dc2626';\n    } else {\n        statusBadge = '<span style=\"background: #fef3c7; color: #92400e; padding: 8px 16px; border-radius: 8px; font-weight: 700; font-size: 14px;\">‚è≥ PENDENTE</span>';\n        statusColor = '#f59e0b';\n    }\n    \n    let html = `\n        <!-- Card de Status Principal -->\n        <div style=\"background: linear-gradient(135deg, ${statusColor} 0%, ${statusColor}dd 100%); border-radius: 12px; padding: 24px; margin-bottom: 24px; color: white; box-shadow: 0 4px 12px rgba(0,0,0,0.15);\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;\">\n                <div>\n                    <div style=\"font-size: 14px; opacity: 0.9; margin-bottom: 8px;\">Intercorr√™ncia ID</div>\n                    <div style=\"font-size: 36px; font-weight: 900;\">#${intercorrencia.ID_INTERCORRENCIA}</div>\n                </div>\n                <div>\n                    ${statusBadge.replace(/color: #[^;]+/, 'color: white').replace(/background: #[^;]+/, 'background: rgba(255,255,255,0.2)')}\n                </div>\n            </div>\n        </div>\n        \n        <!-- Informa√ß√µes em Grid -->\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 24px;\">\n            <!-- Card Cliente -->\n            <div style=\"background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px;\">\n                <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 16px;\">\n                    <div style=\"font-size: 32px;\">üë§</div>\n                    <div style=\"font-size: 16px; font-weight: 700; color: #1f2937;\">Informa√ß√µes do Cliente</div>\n                </div>\n                <div style=\"display: flex; flex-direction: column; gap: 12px;\">\n                    <div>\n                        <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase;\">C√≥digo</div>\n                        <div style=\"font-size: 18px; font-weight: 700; color: #1f2937;\">${intercorrencia.CODIGO_CLIENTE || intercorrencia.CODCLI || 'N/A'}</div>\n                    </div>\n                    <div>\n                        <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase;\">Nome</div>\n                        <div style=\"font-size: 14px; font-weight: 600; color: #374151;\">${intercorrencia.NOME_CLIENTE || intercorrencia.CLIENTE || 'N/A'}</div>\n                    </div>\n                    <div>\n                        <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase;\">Cidade</div>\n                        <div style=\"font-size: 14px; font-weight: 600; color: #374151;\">${intercorrencia.CIDADE || 'N/A'}</div>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Card Vendedor -->\n            <div style=\"background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px;\">\n                <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 16px;\">\n                    <div style=\"font-size: 32px;\">üíº</div>\n                    <div style=\"font-size: 16px; font-weight: 700; color: #1f2937;\">Vendedor</div>\n                </div>\n                <div style=\"display: flex; flex-direction: column; gap: 12px;\">\n                    <div>\n                        <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase;\">C√≥digo</div>\n                        <div style=\"font-size: 18px; font-weight: 700; color: #1f2937;\">${intercorrencia.CODRCA || 'N/A'}</div>\n                    </div>\n                    <div>\n                        <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase;\">Nome</div>\n                        <div style=\"font-size: 14px; font-weight: 600; color: #374151;\">${intercorrencia.NOME_RCA || 'N/A'}</div>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Card Motoboy -->\n            <div style=\"background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px;\">\n                <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 16px;\">\n                    <div style=\"font-size: 32px;\">üèçÔ∏è</div>\n                    <div style=\"font-size: 16px; font-weight: 700; color: #1f2937;\">Motoboy</div>\n                </div>\n                <div style=\"display: flex; flex-direction: column; gap: 12px;\">\n                    <div>\n                        <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase;\">C√≥digo</div>\n                        <div style=\"font-size: 18px; font-weight: 700; color: #1f2937;\">${intercorrencia.COD_MOTOBOY || 'N/A'}</div>\n                    </div>\n                    <div>\n                        <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase;\">Nome</div>\n                        <div style=\"font-size: 14px; font-weight: 600; color: #374151;\">${intercorrencia.NOME_MOTOBOY || 'N/A'}</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <!-- Card Pedido e Categoria -->\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-bottom: 24px;\">\n            <div style=\"background: #dbeafe; border-radius: 8px; padding: 16px;\">\n                <div style=\"font-size: 11px; color: #1e40af; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">üì¶ N√∫mero do Pedido</div>\n                <div style=\"font-size: 24px; font-weight: 900; color: #1e3a8a;\">${intercorrencia.NUMPED || 'N/A'}</div>\n            </div>\n            <div style=\"background: #fef3c7; border-radius: 8px; padding: 16px;\">\n                <div style=\"font-size: 11px; color: #92400e; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">üè¢ ID Sa√≠da</div>\n                <div style=\"font-size: 24px; font-weight: 900; color: #78350f;\">${intercorrencia.SAIDA_ID || 'N/A'}</div>\n            </div>\n            <div style=\"background: #fee2e2; border-radius: 8px; padding: 16px;\">\n                <div style=\"font-size: 11px; color: #991b1b; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">üìç Categoria</div>\n                <div style=\"font-size: 14px; font-weight: 700; color: #7f1d1d;\">${intercorrencia.CATEGORIA_INTERCORRENCIA || 'N/A'}</div>\n            </div>\n            <div style=\"background: #f3e8ff; border-radius: 8px; padding: 16px;\">\n                <div style=\"font-size: 11px; color: #7c3aed; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">‚è±Ô∏è Tempo</div>\n                <div style=\"font-size: 24px; font-weight: 900; color: #6b21a8; font-family: monospace;\">${formatarTempo(intercorrencia.TEMPO_INTERCORRENCIA)}</div>\n            </div>\n        </div>\n        \n        <!-- Descri√ß√£o -->\n        <div style=\"background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px; margin-bottom: 24px;\">\n            <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 12px;\">\n                <div style=\"font-size: 24px;\">üìù</div>\n                <div style=\"font-size: 16px; font-weight: 700; color: #1f2937;\">Descri√ß√£o</div>\n            </div>\n            <div style=\"background: #f9fafb; padding: 16px; border-radius: 8px; font-size: 14px; line-height: 1.6; color: #374151;\">\n                ${intercorrencia.DESCRICAO || 'Sem descri√ß√£o'}\n            </div>\n        </div>\n        \n        <!-- Fotos -->\n        ${intercorrencia.URLS_FOTOS ? `\n            <div style=\"background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px; margin-bottom: 24px;\">\n                <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 12px;\">\n                    <div style=\"font-size: 24px;\">üì∑</div>\n                    <div style=\"font-size: 16px; font-weight: 700; color: #1f2937;\">Foto(s) da Intercorr√™ncia</div>\n                </div>\n                <div style=\"display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;\">\n                    ${intercorrencia.URLS_FOTOS.split(',').map(url => `\n                        <img src=\"${url.trim()}\" \n                             onclick=\"verImagemGrande('${url.trim()}')\"\n                             style=\"width: 100%; height: 200px; object-fit: cover; border-radius: 8px; cursor: pointer; transition: transform 0.2s; border: 2px solid #e5e7eb;\"\n                             onmouseover=\"this.style.transform='scale(1.05)'\"\n                             onmouseout=\"this.style.transform='scale(1)'\"\n                             onerror=\"this.src='data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27200%27 height=%27200%27%3E%3Crect fill=%27%23f3f4f6%27 width=%27200%27 height=%27200%27/%3E%3Ctext x=%2750%25%27 y=%2750%25%27 text-anchor=%27middle%27 dy=%27.3em%27 fill=%27%239ca3af%27 font-size=%2714%27%3ESem Imagem%3C/text%3E%3C/svg%3E'\">\n                    `).join('')}\n                </div>\n            </div>\n        ` : ''}\n        \n        <!-- Informa√ß√µes de Aprova√ß√£o -->\n        <div style=\"background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: 20px; margin-bottom: 24px;\">\n            <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 16px;\">\n                <div style=\"font-size: 24px;\">‚úÖ</div>\n                <div style=\"font-size: 16px; font-weight: 700; color: #1f2937;\">Aprova√ß√£o</div>\n            </div>\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;\">\n                <div>\n                    <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">Quem Aprovou</div>\n                    <div style=\"font-size: 14px; font-weight: 600; color: #374151;\">${intercorrencia.NOME_QUEM_APROVOU || 'N√£o aprovado ainda'}</div>\n                </div>\n                <div>\n                    <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">Data/Hora</div>\n                    <div style=\"font-size: 14px; font-weight: 600; color: #374151;\">${intercorrencia.DATA_HORA_APROVACAO ? formatarData(intercorrencia.DATA_HORA_APROVACAO) : 'N/A'}</div>\n                </div>\n                <div>\n                    <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">C√≥digo Aprovador</div>\n                    <div style=\"font-size: 14px; font-weight: 600; color: #374151;\">${intercorrencia.CODE_WINTHOR_QUEM_APROVOU || 'N/A'}</div>\n                </div>\n            </div>\n            ${intercorrencia.JUSTIFICATIVA_APROVACAO ? `\n                <div style=\"margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb;\">\n                    <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase; margin-bottom: 8px;\">Justificativa</div>\n                    <div style=\"background: #f9fafb; padding: 12px; border-radius: 8px; font-size: 14px; color: #374151;\">\n                        ${intercorrencia.JUSTIFICATIVA_APROVACAO}\n                    </div>\n                </div>\n            ` : ''}\n        </div>\n        \n        <!-- Informa√ß√µes T√©cnicas -->\n        <div style=\"background: #f9fafb; border-radius: 12px; padding: 20px;\">\n            <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 16px;\">\n                <div style=\"font-size: 24px;\">‚öôÔ∏è</div>\n                <div style=\"font-size: 16px; font-weight: 700; color: #1f2937;\">Informa√ß√µes T√©cnicas</div>\n            </div>\n            <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; font-size: 12px;\">\n                <div>\n                    <div style=\"color: #6b7280; font-weight: 600;\">Data Intercorr√™ncia:</div>\n                    <div style=\"font-weight: 600; color: #374151;\">${intercorrencia.DATA_INTERCORRENCIA || 'N/A'}</div>\n                </div>\n                <div>\n                    <div style=\"color: #6b7280; font-weight: 600;\">Filial ID:</div>\n                    <div style=\"font-weight: 600; color: #374151;\">${intercorrencia.ID_FILIAL || 'N/A'}</div>\n                </div>\n                <div>\n                    <div style=\"color: #6b7280; font-weight: 600;\">C√≥digo Filial:</div>\n                    <div style=\"font-weight: 600; color: #374151;\">${intercorrencia.CODIGO_FILIAL || 'N/A'}</div>\n                </div>\n                <div>\n                    <div style=\"color: #6b7280; font-weight: 600;\">Raz√£o Social Filial:</div>\n                    <div style=\"font-weight: 600; color: #374151;\">${intercorrencia.RAZAOSOCIAL_FILIAL || 'N/A'}</div>\n                </div>\n                <div>\n                    <div style=\"color: #6b7280; font-weight: 600;\">Lan√ßado por:</div>\n                    <div style=\"font-weight: 600; color: #374151;\">${intercorrencia.NOME_LANCAMENTO || 'N/A'}</div>\n                </div>\n                <div>\n                    <div style=\"color: #6b7280; font-weight: 600;\">C√≥digo Lan√ßamento:</div>\n                    <div style=\"font-weight: 600; color: #374151;\">${intercorrencia.CODWINTHOR_LANCAMENTO || 'N/A'}</div>\n                </div>\n            </div>\n        </div>\n    `;\n    \n    conteudo.innerHTML = html;\n    modal.style.display = 'block';\n}\n\n// Fechar modal de detalhes\nfunction fecharModalDetalhes() {\n    document.getElementById('modalDetalhesIntercorrencia').style.display = 'none';\n}\n\n// Fechar modal clicando fora\nwindow.onclick = function(event) {\n    const modalImagem = document.getElementById('modalImagem');\n    const modalTimeline = document.getElementById('modalTimelineHora');\n    const modalDebug = document.getElementById('modalDebug');\n    const modalDetalhes = document.getElementById('modalDetalhesIntercorrencia');\n    \n    if (event.target === modalImagem) {\n        modalImagem.style.display = 'none';\n    }\n    \n    if (event.target === modalTimeline) {\n        modalTimeline.style.display = 'none';\n    }\n    \n    if (event.target === modalDebug) {\n        modalDebug.style.display = 'none';\n    }\n    \n    if (event.target === modalDetalhes) {\n        modalDetalhes.style.display = 'none';\n    }\n}\n\n// ============================================\n// AN√ÅLISES DE DIVERG√äNCIAS\n// ============================================\n\nfunction gerarAnalisesDivergencias() {\n    console.log('‚ö†Ô∏è Gerando an√°lises de diverg√™ncias...');\n    \n    gerarTabelaClientes();\n    gerarTabelaVendedores();\n    gerarAnaliseClienteNovo();\n    gerarAnaliseEnderecoErrado();\n    gerarGraficosComparativos();\n    popularFiltrosDivergencias();\n    gerarAnaliseInteligente();\n}\n\n// Gerar tabela de clientes\nfunction gerarTabelaClientes() {\n    const clientesStats = {};\n    \n    intercorrenciasFiltradas.forEach(i => {\n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        if (!codCliente) return;\n        \n        if (!clientesStats[codCliente]) {\n            clientesStats[codCliente] = {\n                codigo: codCliente,\n                nome: i.NOME_CLIENTE || i.CLIENTE || 'N/A',\n                total: 0,\n                aprovadas: 0,\n                reprovadas: 0,\n                pendentes: 0,\n                cidades: new Set(),\n                vendedores: new Set()\n            };\n        }\n        \n        clientesStats[codCliente].total++;\n        \n        const status = getStatusIntercorrencia(i);\n        if (status === 'APROVADO') clientesStats[codCliente].aprovadas++;\n        else if (status === 'REPROVADO') clientesStats[codCliente].reprovadas++;\n        else clientesStats[codCliente].pendentes++;\n        \n        if (i.CIDADE) clientesStats[codCliente].cidades.add(i.CIDADE);\n        if (i.CODRCA) clientesStats[codCliente].vendedores.add(i.CODRCA);\n    });\n    \n    const clientes = Object.values(clientesStats)\n        .map(c => ({\n            ...c,\n            cidades: c.cidades.size,\n            vendedores: c.vendedores.size,\n            taxaAprovacao: c.total > 0 ? Math.round((c.aprovadas / c.total) * 100) : 0\n        }))\n        .sort((a, b) => b.total - a.total);\n    \n    let html = `\n        <table style=\"width: 100%; border-collapse: collapse; font-size: 12px;\">\n            <thead>\n                <tr style=\"background: #f9fafb; border-bottom: 2px solid #e5e7eb;\">\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #1f2937;\">Posi√ß√£o</th>\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #1f2937;\">C√≥digo</th>\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #1f2937;\">Cliente</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">Total</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">‚úÖ Aprovadas</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">‚è≥ Pendentes</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">‚ùå Reprovadas</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">Taxa Aprov.</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">üèôÔ∏è Cidades</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">Status</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">A√ß√µes</th>\n                </tr>\n            </thead>\n            <tbody>\n    `;\n    \n    clientes.forEach((cliente, index) => {\n        const isRecorrente = cliente.total >= 2;\n        const bgColor = isRecorrente ? '#fef3c7' : 'white';\n        const borderColor = isRecorrente ? '#f59e0b' : '#e5e7eb';\n        \n        // Buscar a primeira intercorr√™ncia deste cliente para mostrar detalhes\n        const intercorrenciaCliente = intercorrenciasFiltradas.find(i => (i.CODIGO_CLIENTE || i.CODCLI) === cliente.codigo);\n        const intercorrenciaJson = JSON.stringify(intercorrenciaCliente).replace(/\"/g, '&quot;');\n        \n        html += `\n            <tr style=\"background: ${bgColor}; border-bottom: 1px solid ${borderColor}; transition: all 0.2s;\" onmouseover=\"this.style.background='#f3f4f6'\" onmouseout=\"this.style.background='${bgColor}'\">\n                <td style=\"padding: 10px; text-align: center; font-weight: 700; color: #6b7280;\">${index + 1}¬∫</td>\n                <td style=\"padding: 10px; font-weight: 600; color: #1f2937;\">${cliente.codigo}</td>\n                <td style=\"padding: 10px; color: #374151; max-width: 200px; overflow: hidden; text-overflow: ellipsis;\">${cliente.nome}</td>\n                <td style=\"padding: 10px; text-align: center; font-weight: 700; color: #ef4444;\">${cliente.total}</td>\n                <td style=\"padding: 10px; text-align: center; color: #10b981;\">${cliente.aprovadas}</td>\n                <td style=\"padding: 10px; text-align: center; color: #f59e0b;\">${cliente.pendentes}</td>\n                <td style=\"padding: 10px; text-align: center; color: #dc2626;\">${cliente.reprovadas}</td>\n                <td style=\"padding: 10px; text-align: center; font-weight: 700; color: ${cliente.taxaAprovacao >= 70 ? '#10b981' : cliente.taxaAprovacao >= 40 ? '#f59e0b' : '#dc2626'};\">\n                    ${cliente.taxaAprovacao}%\n                </td>\n                <td style=\"padding: 10px; text-align: center;\">${cliente.cidades}</td>\n                <td style=\"padding: 10px; text-align: center;\">\n                    ${isRecorrente ? '<span style=\"background: #f59e0b; color: white; padding: 4px 8px; border-radius: 4px; font-size: 10px; font-weight: 700;\">üîÅ RECORRENTE</span>' : '<span style=\"color: #10b981;\">‚úì Normal</span>'}\n                </td>\n                <td style=\"padding: 10px; text-align: center;\">\n                    <button onclick='abrirModalDetalhes(${intercorrenciaJson})' \n                            style=\"background: #1890ff; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600; transition: all 0.2s; display: inline-flex; align-items: center; gap: 4px;\"\n                            onmouseover=\"this.style.background='#0066cc'; this.style.transform='scale(1.05)'\"\n                            onmouseout=\"this.style.background='#1890ff'; this.style.transform='scale(1)'\">\n                        üëÅÔ∏è Ver\n                    </button>\n                </td>\n            </tr>\n        `;\n    });\n    \n    html += `\n            </tbody>\n        </table>\n    `;\n    \n    document.getElementById('tabelaClientes').innerHTML = html;\n}\n\n// Gerar tabela de vendedores\nfunction gerarTabelaVendedores() {\n    const vendedoresStats = {};\n    \n    intercorrenciasFiltradas.forEach(i => {\n        if (!i.CODRCA) return;\n        \n        if (!vendedoresStats[i.CODRCA]) {\n            vendedoresStats[i.CODRCA] = {\n                codigo: i.CODRCA,\n                nome: i.NOME_RCA || 'N/A',\n                total: 0,\n                aprovadas: 0,\n                reprovadas: 0,\n                pendentes: 0,\n                clientes: new Set(),\n                cidades: new Set()\n            };\n        }\n        \n        vendedoresStats[i.CODRCA].total++;\n        \n        const status = getStatusIntercorrencia(i);\n        if (status === 'APROVADO') vendedoresStats[i.CODRCA].aprovadas++;\n        else if (status === 'REPROVADO') vendedoresStats[i.CODRCA].reprovadas++;\n        else vendedoresStats[i.CODRCA].pendentes++;\n        \n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        if (codCliente) vendedoresStats[i.CODRCA].clientes.add(codCliente);\n        if (i.CIDADE) vendedoresStats[i.CODRCA].cidades.add(i.CIDADE);\n    });\n    \n    const vendedores = Object.values(vendedoresStats)\n        .map(v => ({\n            ...v,\n            clientes: v.clientes.size,\n            cidades: v.cidades.size,\n            taxaAprovacao: v.total > 0 ? Math.round((v.aprovadas / v.total) * 100) : 0\n        }))\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 20); // Top 20\n    \n    let html = `\n        <table style=\"width: 100%; border-collapse: collapse; font-size: 12px;\">\n            <thead>\n                <tr style=\"background: #f9fafb; border-bottom: 2px solid #e5e7eb;\">\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #1f2937;\">Ranking</th>\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #1f2937;\">C√≥digo</th>\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #1f2937;\">Vendedor</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">Total</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">‚úÖ Aprovadas</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">‚è≥ Pendentes</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">‚ùå Reprovadas</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">Taxa Aprov.</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">üë• Clientes</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">üèôÔ∏è Cidades</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #1f2937;\">A√ß√µes</th>\n                </tr>\n            </thead>\n            <tbody>\n    `;\n    \n    vendedores.forEach((vendedor, index) => {\n        let medalha = '';\n        let bgColor = 'white';\n        \n        if (index === 0) {\n            medalha = 'ü•á';\n            bgColor = '#fef3c7';\n        } else if (index === 1) {\n            medalha = 'ü•à';\n            bgColor = '#f3f4f6';\n        } else if (index === 2) {\n            medalha = 'ü•â';\n            bgColor = '#fee2e2';\n        }\n        \n        // Buscar a primeira intercorr√™ncia deste vendedor para mostrar detalhes\n        const intercorrenciaVendedor = intercorrenciasFiltradas.find(i => i.CODRCA === vendedor.codigo);\n        const intercorrenciaJsonVend = JSON.stringify(intercorrenciaVendedor).replace(/\"/g, '&quot;');\n        \n        html += `\n            <tr style=\"background: ${bgColor}; border-bottom: 1px solid #e5e7eb; transition: all 0.2s;\" onmouseover=\"this.style.background='#f3f4f6'\" onmouseout=\"this.style.background='${bgColor}'\">\n                <td style=\"padding: 10px; text-align: center; font-weight: 700; font-size: 16px;\">${medalha} ${index + 1}¬∫</td>\n                <td style=\"padding: 10px; font-weight: 600; color: #1f2937;\">${vendedor.codigo}</td>\n                <td style=\"padding: 10px; color: #374151; max-width: 200px; overflow: hidden; text-overflow: ellipsis;\">${vendedor.nome}</td>\n                <td style=\"padding: 10px; text-align: center; font-weight: 700; color: #ef4444;\">${vendedor.total}</td>\n                <td style=\"padding: 10px; text-align: center; color: #10b981;\">${vendedor.aprovadas}</td>\n                <td style=\"padding: 10px; text-align: center; color: #f59e0b;\">${vendedor.pendentes}</td>\n                <td style=\"padding: 10px; text-align: center; color: #dc2626;\">${vendedor.reprovadas}</td>\n                <td style=\"padding: 10px; text-align: center; font-weight: 700; color: ${vendedor.taxaAprovacao >= 70 ? '#10b981' : vendedor.taxaAprovacao >= 40 ? '#f59e0b' : '#dc2626'};\">\n                    ${vendedor.taxaAprovacao}%\n                </td>\n                <td style=\"padding: 10px; text-align: center;\">${vendedor.clientes}</td>\n                <td style=\"padding: 10px; text-align: center;\">${vendedor.cidades}</td>\n                <td style=\"padding: 10px; text-align: center;\">\n                    <button onclick='abrirModalDetalhes(${intercorrenciaJsonVend})' \n                            style=\"background: #06b6d4; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600; transition: all 0.2s; display: inline-flex; align-items: center; gap: 4px;\"\n                            onmouseover=\"this.style.background='#0891b2'; this.style.transform='scale(1.05)'\"\n                            onmouseout=\"this.style.background='#06b6d4'; this.style.transform='scale(1)'\">\n                        üëÅÔ∏è Ver\n                    </button>\n                </td>\n            </tr>\n        `;\n    });\n    \n    html += `\n            </tbody>\n        </table>\n    `;\n    \n    document.getElementById('tabelaVendedores').innerHTML = html;\n}\n\n// Gerar an√°lise de Cliente Novo\nfunction gerarAnaliseClienteNovo() {\n    // Filtrar intercorr√™ncias da categoria \"CLIENTE NOVO\" (ID=6)\n    const clientesNovosDados = intercorrenciasFiltradas.filter(i => \n        i.ID_CATEGORIA_INTERCORRENCIA === '6' || \n        (i.CATEGORIA_INTERCORRENCIA && i.CATEGORIA_INTERCORRENCIA.toUpperCase().includes('CLIENTE NOVO'))\n    );\n    \n    const total = intercorrenciasFiltradas.length;\n    const totalClientesNovos = clientesNovosDados.length;\n    const percentual = total > 0 ? Math.round((totalClientesNovos / total) * 100) : 0;\n    \n    // Contar clientes √∫nicos\n    const clientesUnicos = new Set();\n    const clientesRecorrentes = new Set();\n    const contagemPorCliente = {};\n    \n    clientesNovosDados.forEach(i => {\n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        if (codCliente) {\n            clientesUnicos.add(codCliente);\n            contagemPorCliente[codCliente] = (contagemPorCliente[codCliente] || 0) + 1;\n            if (contagemPorCliente[codCliente] >= 2) {\n                clientesRecorrentes.add(codCliente);\n            }\n        }\n    });\n    \n    // Atualizar cards\n    document.getElementById('cnTotalClientesNovos').textContent = clientesUnicos.size;\n    document.getElementById('cnIntercorrencias').textContent = totalClientesNovos;\n    document.getElementById('cnRecorrentes').textContent = clientesRecorrentes.size;\n    document.getElementById('cnPercentual').textContent = percentual + '%';\n    \n    // Agrupar dados por cliente\n    const clienteStats = {};\n    clientesNovosDados.forEach(i => {\n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        const nomeCliente = i.NOME_CLIENTE || i.CLIENTE || 'N/A';\n        \n        if (codCliente) {\n            if (!clienteStats[codCliente]) {\n                clienteStats[codCliente] = {\n                    codigo: codCliente,\n                    nome: nomeCliente,\n                    total: 0,\n                    aprovadas: 0,\n                    reprovadas: 0,\n                    pendentes: 0,\n                    cidades: new Set(),\n                    vendedores: new Set(),\n                    intercorrencias: []\n                };\n            }\n            \n            clienteStats[codCliente].total++;\n            clienteStats[codCliente].intercorrencias.push(i);\n            \n            const status = getStatusIntercorrencia(i);\n            if (status === 'APROVADO') clienteStats[codCliente].aprovadas++;\n            else if (status === 'REPROVADO') clienteStats[codCliente].reprovadas++;\n            else clienteStats[codCliente].pendentes++;\n            \n            if (i.CIDADE) clienteStats[codCliente].cidades.add(i.CIDADE);\n            if (i.NOME_RCA) clienteStats[codCliente].vendedores.add(i.NOME_RCA);\n        }\n    });\n    \n    // Ordenar por total de intercorr√™ncias\n    const clientesOrdenados = Object.values(clienteStats)\n        .map(c => ({\n            ...c,\n            cidades: Array.from(c.cidades).join(', '),\n            vendedores: Array.from(c.vendedores).join(', '),\n            taxaAprovacao: c.total > 0 ? Math.round((c.aprovadas / c.total) * 100) : 0\n        }))\n        .sort((a, b) => b.total - a.total);\n    \n    // Gerar tabela\n    if (clientesOrdenados.length === 0) {\n        document.getElementById('tabelaClientesNovos').innerHTML = `\n            <div style=\"background: #ecfdf5; padding: 40px; text-align: center; border-radius: 8px; border: 2px solid #10b981;\">\n                <div style=\"font-size: 48px; margin-bottom: 16px;\">‚úÖ</div>\n                <div style=\"font-size: 18px; font-weight: 700; color: #065f46; margin-bottom: 8px;\">Excelente!</div>\n                <div style=\"font-size: 14px; color: #10b981;\">\n                    Nenhuma intercorr√™ncia de \"Cliente Novo\" no per√≠odo filtrado.\n                </div>\n            </div>\n        `;\n        return;\n    }\n    \n    let html = `\n        <table style=\"width: 100%; border-collapse: collapse; font-size: 12px;\">\n            <thead>\n                <tr style=\"background: #f9fafb; border-bottom: 2px solid #e5e7eb;\">\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #374151;\">#</th>\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #374151;\">C√≥digo</th>\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #374151;\">Cliente</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #374151;\">Total</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #374151;\">‚úÖ Aprovadas</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #374151;\">‚è≥ Pendentes</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #374151;\">‚ùå Reprovadas</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #374151;\">Taxa Aprov.</th>\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #374151;\">üèôÔ∏è Cidades</th>\n                    <th style=\"padding: 12px; text-align: left; font-weight: 700; color: #374151;\">üíº Vendedores</th>\n                    <th style=\"padding: 12px; text-align: center; font-weight: 700; color: #374151;\">A√ß√µes</th>\n                </tr>\n            </thead>\n            <tbody>\n    `;\n    \n    clientesOrdenados.forEach((cliente, index) => {\n        const corRecorrente = cliente.total >= 2 ? 'background: #fef3c7;' : '';\n        const badgeRecorrente = cliente.total >= 2 ? '<span style=\"background: #f59e0b; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 700; margin-left: 8px;\">üîÅ RECORRENTE</span>' : '';\n        \n        html += `\n            <tr style=\"border-bottom: 1px solid #e5e7eb; ${corRecorrente} transition: all 0.2s;\" \n                onmouseover=\"this.style.background='#f3f4f6'\" \n                onmouseout=\"this.style.background='${cliente.total >= 2 ? '#fef3c7' : 'white'}'\">\n                <td style=\"padding: 12px; font-weight: 700; color: #6b7280;\">${index + 1}¬∫</td>\n                <td style=\"padding: 12px; font-weight: 600;\">${cliente.codigo}</td>\n                <td style=\"padding: 12px; max-width: 200px;\">\n                    ${cliente.nome}\n                    ${badgeRecorrente}\n                </td>\n                <td style=\"padding: 12px; text-align: center; font-weight: 900; color: #1e40af; font-size: 16px;\">${cliente.total}</td>\n                <td style=\"padding: 12px; text-align: center; font-weight: 700; color: #10b981;\">${cliente.aprovadas}</td>\n                <td style=\"padding: 12px; text-align: center; font-weight: 700; color: #f59e0b;\">${cliente.pendentes}</td>\n                <td style=\"padding: 12px; text-align: center; font-weight: 700; color: #ef4444;\">${cliente.reprovadas}</td>\n                <td style=\"padding: 12px; text-align: center;\">\n                    <span style=\"background: ${cliente.taxaAprovacao >= 70 ? '#d1fae5' : cliente.taxaAprovacao >= 40 ? '#fef3c7' : '#fee2e2'}; \n                                 color: ${cliente.taxaAprovacao >= 70 ? '#065f46' : cliente.taxaAprovacao >= 40 ? '#92400e' : '#991b1b'}; \n                                 padding: 4px 8px; border-radius: 4px; font-weight: 700; font-size: 11px;\">\n                        ${cliente.taxaAprovacao}%\n                    </span>\n                </td>\n                <td style=\"padding: 12px; font-size: 11px; color: #6b7280; max-width: 120px; overflow: hidden; text-overflow: ellipsis;\" title=\"${cliente.cidades}\">\n                    ${cliente.cidades}\n                </td>\n                <td style=\"padding: 12px; font-size: 11px; color: #6b7280; max-width: 150px; overflow: hidden; text-overflow: ellipsis;\" title=\"${cliente.vendedores}\">\n                    ${cliente.vendedores}\n                </td>\n                <td style=\"padding: 12px; text-align: center;\">\n                    <button onclick='abrirModalDetalhes(${JSON.stringify(cliente.intercorrencias[0]).replace(/'/g, \"&apos;\")})' \n                            style=\"background: #7c3aed; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600; white-space: nowrap;\"\n                            onmouseover=\"this.style.background='#6d28d9'\"\n                            onmouseout=\"this.style.background='#7c3aed'\">\n                        üìã Ver\n                    </button>\n                </td>\n            </tr>\n        `;\n    });\n    \n    html += `\n            </tbody>\n        </table>\n        \n        <div style=\"background: #dbeafe; border: 2px solid #1e40af; border-radius: 8px; padding: 16px; margin-top: 20px;\">\n            <div style=\"font-size: 13px; font-weight: 700; color: #1e3a8a; margin-bottom: 8px;\">\n                üí° Sobre \"Cliente Novo\"\n            </div>\n            <div style=\"font-size: 12px; color: #1e40af; line-height: 1.6;\">\n                Esta categoria identifica intercorr√™ncias relacionadas a <strong>clientes novos com problemas de localiza√ß√£o, endere√ßo ou contato errado</strong>.\n                <br>Clientes marcados como üîÅ <strong>RECORRENTES</strong> tiveram 2 ou mais intercorr√™ncias deste tipo.\n            </div>\n        </div>\n    `;\n    \n    document.getElementById('tabelaClientesNovos').innerHTML = html;\n}\n\n// Gerar an√°lise de endere√ßo errado\nfunction gerarAnaliseEnderecoErrado() {\n    const enderecoErradoDados = intercorrenciasFiltradas.filter(i => \n        i.ID_CATEGORIA_INTERCORRENCIA === '4' || \n        (i.CATEGORIA_INTERCORRENCIA && i.CATEGORIA_INTERCORRENCIA.toUpperCase().includes('ENDERECO'))\n    );\n    \n    const total = intercorrenciasFiltradas.length;\n    const totalErros = enderecoErradoDados.length;\n    const percentual = total > 0 ? Math.round((totalErros / total) * 100) : 0;\n    \n    const aprovadas = enderecoErradoDados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const taxaAprovacao = totalErros > 0 ? Math.round((aprovadas / totalErros) * 100) : 0;\n    \n    // Atualizar cards\n    document.getElementById('endTotalErros').textContent = totalErros;\n    document.getElementById('endPercentual').textContent = percentual + '%';\n    document.getElementById('endClientesNovosEnd').textContent = '0'; // Implementar depois se tiver data de cadastro\n    document.getElementById('endTaxaAprovacao').textContent = taxaAprovacao + '%';\n    \n    // Estratifica√ß√£o detalhada (placeholder - podem ser implementadas com l√≥gica baseada em DESCRICAO)\n    document.getElementById('endClienteNovo').textContent = '0';\n    document.getElementById('endErroOperacional').textContent = '0';\n    document.getElementById('endErroDigitacao').textContent = '0';\n    document.getElementById('endErroVendedor').textContent = '0';\n    \n    // Gr√°fico por categoria (subcategoria se houver)\n    const porCategoria = {};\n    enderecoErradoDados.forEach(i => {\n        const cat = i.CATEGORIA_INTERCORRENCIA || 'Endere√ßo Errado';\n        porCategoria[cat] = (porCategoria[cat] || 0) + 1;\n    });\n    \n    let htmlCategoria = '';\n    Object.entries(porCategoria)\n        .sort((a, b) => b[1] - a[1])\n        .forEach(([cat, count]) => {\n            const perc = totalErros > 0 ? Math.round((count / totalErros) * 100) : 0;\n            htmlCategoria += `\n                <div class=\"bar-item\">\n                    <div class=\"bar-label\">${cat}</div>\n                    <div class=\"bar-wrapper\">\n                        <div class=\"bar-fill\" style=\"width: ${perc}%;\">\n                            <span class=\"bar-value\">${count} (${perc}%)</span>\n                        </div>\n                    </div>\n                </div>\n            `;\n        });\n    \n    document.getElementById('endCategoria').innerHTML = htmlCategoria;\n    \n    // Gr√°fico por cidade\n    const porCidade = {};\n    enderecoErradoDados.forEach(i => {\n        if (i.CIDADE) {\n            porCidade[i.CIDADE] = (porCidade[i.CIDADE] || 0) + 1;\n        }\n    });\n    \n    let htmlCidade = '';\n    Object.entries(porCidade)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 10)\n        .forEach(([cidade, count]) => {\n            const perc = totalErros > 0 ? Math.round((count / totalErros) * 100) : 0;\n            htmlCidade += `\n                <div class=\"bar-item\">\n                    <div class=\"bar-label\">${cidade}</div>\n                    <div class=\"bar-wrapper\">\n                        <div class=\"bar-fill\" style=\"width: ${perc}%;\">\n                            <span class=\"bar-value\">${count} (${perc}%)</span>\n                        </div>\n                    </div>\n                </div>\n            `;\n        });\n    \n    document.getElementById('endCidade').innerHTML = htmlCidade;\n    \n    // Lista detalhada\n    let htmlLista = `\n        <div style=\"max-height: 400px; overflow-y: auto;\">\n            <table style=\"width: 100%; border-collapse: collapse; font-size: 11px;\">\n                <thead style=\"position: sticky; top: 0; background: white;\">\n                    <tr style=\"background: #f9fafb; border-bottom: 2px solid #e5e7eb;\">\n                        <th style=\"padding: 8px; text-align: left;\">Pedido</th>\n                        <th style=\"padding: 8px; text-align: left;\">Cliente</th>\n                        <th style=\"padding: 8px; text-align: left;\">Cidade</th>\n                        <th style=\"padding: 8px; text-align: left;\">Vendedor</th>\n                        <th style=\"padding: 8px; text-align: left;\">Motoboy</th>\n                        <th style=\"padding: 8px; text-align: left;\">Descri√ß√£o</th>\n                        <th style=\"padding: 8px; text-align: center;\">Status</th>\n                        <th style=\"padding: 8px; text-align: center;\">A√ß√µes</th>\n                    </tr>\n                </thead>\n                <tbody>\n    `;\n    \n    enderecoErradoDados.forEach(i => {\n        const status = getStatusIntercorrencia(i);\n        let statusBadge = '';\n        \n        if (status === 'APROVADO') {\n            statusBadge = '<span style=\"background: #d1fae5; color: #065f46; padding: 4px 8px; border-radius: 4px; font-weight: 700;\">‚úÖ Aprovado</span>';\n        } else if (status === 'REPROVADO') {\n            statusBadge = '<span style=\"background: #fee2e2; color: #991b1b; padding: 4px 8px; border-radius: 4px; font-weight: 700;\">‚ùå Reprovado</span>';\n        } else {\n            statusBadge = '<span style=\"background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 4px; font-weight: 700;\">‚è≥ Pendente</span>';\n        }\n        \n        const intercorrenciaJson = JSON.stringify(i).replace(/\"/g, '&quot;');\n        \n        htmlLista += `\n            <tr style=\"border-bottom: 1px solid #e5e7eb; transition: all 0.2s;\" onmouseover=\"this.style.background='#f9fafb'\" onmouseout=\"this.style.background='white'\">\n                <td style=\"padding: 8px; font-weight: 600;\">${i.NUMPED || 'N/A'}</td>\n                <td style=\"padding: 8px;\">${i.NOME_CLIENTE || i.CLIENTE || 'N/A'}</td>\n                <td style=\"padding: 8px;\">${i.CIDADE || 'N/A'}</td>\n                <td style=\"padding: 8px;\">${i.NOME_RCA || 'N/A'}</td>\n                <td style=\"padding: 8px;\">${i.NOME_MOTOBOY || 'N/A'}</td>\n                <td style=\"padding: 8px; max-width: 200px; overflow: hidden; text-overflow: ellipsis;\">${i.DESCRICAO || 'N/A'}</td>\n                <td style=\"padding: 8px; text-align: center;\">${statusBadge}</td>\n                <td style=\"padding: 8px; text-align: center;\">\n                    <button onclick='abrirModalDetalhes(${intercorrenciaJson})' \n                            style=\"background: #dc2626; color: white; border: none; padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600; transition: all 0.2s; display: inline-flex; align-items: center; gap: 4px;\"\n                            onmouseover=\"this.style.background='#b91c1c'; this.style.transform='scale(1.05)'\"\n                            onmouseout=\"this.style.background='#dc2626'; this.style.transform='scale(1)'\">\n                        üëÅÔ∏è\n                    </button>\n                </td>\n            </tr>\n        `;\n    });\n    \n    htmlLista += `\n                </tbody>\n            </table>\n        </div>\n    `;\n    \n    document.getElementById('listaEnderecoErrado').innerHTML = htmlLista;\n}\n\n// Gerar gr√°ficos comparativos\nfunction gerarGraficosComparativos() {\n    // Clientes com maior recorr√™ncia\n    const clientesStats = {};\n    intercorrenciasFiltradas.forEach(i => {\n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        if (codCliente) {\n            if (!clientesStats[codCliente]) {\n                clientesStats[codCliente] = {\n                    nome: i.NOME_CLIENTE || i.CLIENTE || 'N/A',\n                    total: 0\n                };\n            }\n            clientesStats[codCliente].total++;\n        }\n    });\n    \n    const topClientes = Object.values(clientesStats)\n        .filter(c => c.total >= 2)\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 10);\n    \n    let htmlClientes = '';\n    const maxCliente = topClientes[0]?.total || 1;\n    \n    topClientes.forEach((cliente, index) => {\n        const perc = Math.round((cliente.total / maxCliente) * 100);\n        htmlClientes += `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\" style=\"max-width: 150px; overflow: hidden; text-overflow: ellipsis;\">${cliente.nome}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${perc}%; background: linear-gradient(90deg, #f59e0b, #dc2626);\">\n                        <span class=\"bar-value\">${cliente.total}x</span>\n                    </div>\n                </div>\n            </div>\n        `;\n    });\n    \n    document.getElementById('graficoClientesRecorrentes').innerHTML = htmlClientes || '<p style=\"text-align: center; color: #6b7280; padding: 20px;\">Nenhum cliente com recorr√™ncia encontrado</p>';\n    \n    // Top 10 vendedores\n    const vendedoresStats = {};\n    intercorrenciasFiltradas.forEach(i => {\n        if (i.CODRCA) {\n            if (!vendedoresStats[i.CODRCA]) {\n                vendedoresStats[i.CODRCA] = {\n                    nome: i.NOME_RCA || 'N/A',\n                    total: 0\n                };\n            }\n            vendedoresStats[i.CODRCA].total++;\n        }\n    });\n    \n    const topVendedores = Object.values(vendedoresStats)\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 10);\n    \n    let htmlVendedores = '';\n    const maxVendedor = topVendedores[0]?.total || 1;\n    \n    topVendedores.forEach((vendedor, index) => {\n        const perc = Math.round((vendedor.total / maxVendedor) * 100);\n        let cor = '#06b6d4';\n        if (index === 0) cor = '#ef4444';\n        else if (index === 1) cor = '#f59e0b';\n        else if (index === 2) cor = '#10b981';\n        \n        htmlVendedores += `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\" style=\"max-width: 150px; overflow: hidden; text-overflow: ellipsis;\">${vendedor.nome}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${perc}%; background: ${cor};\">\n                        <span class=\"bar-value\">${vendedor.total}</span>\n                    </div>\n                </div>\n            </div>\n        `;\n    });\n    \n    document.getElementById('graficoTopVendedores').innerHTML = htmlVendedores || '<p style=\"text-align: center; color: #6b7280; padding: 20px;\">Nenhum vendedor encontrado</p>';\n}\n\n// ============================================\n// AN√ÅLISE INTELIGENTE DE PADR√ïES\n// ============================================\n\n// Popular filtros de an√°lise\nfunction popularFiltrosDivergencias() {\n    // Vendedores\n    const vendedores = [...new Set(intercorrenciasFiltradas.map(i => i.NOME_RCA).filter(v => v))].sort();\n    const selectVendedor = document.getElementById('filtroDivVendedor');\n    selectVendedor.innerHTML = '<option value=\"\">Todos</option>';\n    vendedores.forEach(v => {\n        selectVendedor.innerHTML += `<option value=\"${v}\">${v}</option>`;\n    });\n    \n    // Filiais\n    const filiais = [...new Set(intercorrenciasFiltradas.map(i => i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL).filter(f => f))].sort();\n    const selectFilial = document.getElementById('filtroDivFilial');\n    selectFilial.innerHTML = '<option value=\"\">Todas</option>';\n    filiais.forEach(f => {\n        selectFilial.innerHTML += `<option value=\"${f}\">${f}</option>`;\n    });\n    \n    // Motoboys\n    const motoboys = [...new Set(intercorrenciasFiltradas.map(i => i.NOME_MOTOBOY).filter(m => m))].sort();\n    const selectMotoboy = document.getElementById('filtroDivMotoboy');\n    selectMotoboy.innerHTML = '<option value=\"\">Todos</option>';\n    motoboys.forEach(m => {\n        selectMotoboy.innerHTML += `<option value=\"${m}\">${m}</option>`;\n    });\n    \n    // Categorias\n    const categorias = [...new Set(intercorrenciasFiltradas.map(i => i.CATEGORIA_INTERCORRENCIA).filter(c => c))].sort();\n    const selectCategoria = document.getElementById('filtroDivCategoria');\n    selectCategoria.innerHTML = '<option value=\"\">Todas</option>';\n    categorias.forEach(c => {\n        selectCategoria.innerHTML += `<option value=\"${c}\">${c}</option>`;\n    });\n}\n\n// Aplicar filtros e reanalizar\nfunction aplicarFiltrosDivergencias() {\n    const vendedor = document.getElementById('filtroDivVendedor').value;\n    const filial = document.getElementById('filtroDivFilial').value;\n    const motoboy = document.getElementById('filtroDivMotoboy').value;\n    const categoria = document.getElementById('filtroDivCategoria').value;\n    \n    // Filtrar dados\n    let dadosFiltrados = intercorrenciasFiltradas;\n    \n    if (vendedor) {\n        dadosFiltrados = dadosFiltrados.filter(i => i.NOME_RCA === vendedor);\n    }\n    if (filial) {\n        dadosFiltrados = dadosFiltrados.filter(i => (i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL) === filial);\n    }\n    if (motoboy) {\n        dadosFiltrados = dadosFiltrados.filter(i => i.NOME_MOTOBOY === motoboy);\n    }\n    if (categoria) {\n        dadosFiltrados = dadosFiltrados.filter(i => i.CATEGORIA_INTERCORRENCIA === categoria);\n    }\n    \n    // Gerar an√°lise com dados filtrados\n    gerarAnaliseInteligente(dadosFiltrados);\n}\n\n// Gerar an√°lise inteligente completa\nfunction gerarAnaliseInteligente(dados = null) {\n    const dadosAnalise = dados || intercorrenciasFiltradas;\n    \n    gerarPadroesProblematicos(dadosAnalise);\n    gerarMatrizCorrelacoes(dadosAnalise);\n    gerarInsightsRecorrencia(dadosAnalise);\n    gerarTabelaCombinacoesCriticas(dadosAnalise);\n    gerarTimelineTendencias(dadosAnalise);\n    gerarRecomendacoesAutomaticas(dadosAnalise);\n    gerarComparativoPerformance(dadosAnalise);\n    gerarAnaliseImpacto(dadosAnalise);\n}\n\n// Identificar padr√µes problem√°ticos\nfunction gerarPadroesProblematicos(dados) {\n    const padroes = [];\n    \n    // Padr√£o 1: Vendedor com alta taxa de problemas em filial espec√≠fica\n    const vendedorFilial = {};\n    dados.forEach(i => {\n        const key = `${i.NOME_RCA}|||${i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL || 'N/A'}`;\n        if (!vendedorFilial[key]) {\n            vendedorFilial[key] = {\n                vendedor: i.NOME_RCA,\n                filial: i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL || 'N/A',\n                total: 0\n            };\n        }\n        vendedorFilial[key].total++;\n    });\n    \n    Object.values(vendedorFilial)\n        .filter(p => p.total >= 3)\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 5)\n        .forEach(p => {\n            padroes.push({\n                tipo: 'Vendedor + Filial',\n                descricao: `${p.vendedor} + ${p.filial}`,\n                ocorrencias: p.total,\n                severidade: p.total >= 10 ? 'CR√çTICA' : p.total >= 5 ? 'ALTA' : 'M√âDIA',\n                icon: 'üíºüè¢',\n                cor: p.total >= 10 ? '#dc2626' : p.total >= 5 ? '#f59e0b' : '#10b981'\n            });\n        });\n    \n    // Padr√£o 2: Motoboy com problemas em categoria espec√≠fica\n    const motoboyCategoria = {};\n    dados.forEach(i => {\n        const key = `${i.NOME_MOTOBOY}|||${i.CATEGORIA_INTERCORRENCIA}`;\n        if (!motoboyCategoria[key]) {\n            motoboyCategoria[key] = {\n                motoboy: i.NOME_MOTOBOY,\n                categoria: i.CATEGORIA_INTERCORRENCIA,\n                total: 0\n            };\n        }\n        motoboyCategoria[key].total++;\n    });\n    \n    Object.values(motoboyCategoria)\n        .filter(p => p.total >= 3)\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 5)\n        .forEach(p => {\n            padroes.push({\n                tipo: 'Motoboy + Categoria',\n                descricao: `${p.motoboy} + ${p.categoria}`,\n                ocorrencias: p.total,\n                severidade: p.total >= 10 ? 'CR√çTICA' : p.total >= 5 ? 'ALTA' : 'M√âDIA',\n                icon: 'üèçÔ∏èüìç',\n                cor: p.total >= 10 ? '#dc2626' : p.total >= 5 ? '#f59e0b' : '#10b981'\n            });\n        });\n    \n    // Padr√£o 3: Filial com categoria recorrente\n    const filialCategoria = {};\n    dados.forEach(i => {\n        const key = `${i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL}|||${i.CATEGORIA_INTERCORRENCIA}`;\n        if (!filialCategoria[key]) {\n            filialCategoria[key] = {\n                filial: i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL || 'N/A',\n                categoria: i.CATEGORIA_INTERCORRENCIA,\n                total: 0\n            };\n        }\n        filialCategoria[key].total++;\n    });\n    \n    Object.values(filialCategoria)\n        .filter(p => p.total >= 3)\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 5)\n        .forEach(p => {\n            padroes.push({\n                tipo: 'Filial + Categoria',\n                descricao: `${p.filial} + ${p.categoria}`,\n                ocorrencias: p.total,\n                severidade: p.total >= 10 ? 'CR√çTICA' : p.total >= 5 ? 'ALTA' : 'M√âDIA',\n                icon: 'üè¢üìç',\n                cor: p.total >= 10 ? '#dc2626' : p.total >= 5 ? '#f59e0b' : '#10b981'\n            });\n        });\n    \n    // Renderizar padr√µes\n    let html = '';\n    \n    if (padroes.length === 0) {\n        html = `\n            <div style=\"background: #ecfdf5; border: 2px solid #10b981; border-radius: 8px; padding: 24px; text-align: center;\">\n                <div style=\"font-size: 48px; margin-bottom: 12px;\">‚úÖ</div>\n                <div style=\"font-size: 18px; font-weight: 700; color: #065f46; margin-bottom: 8px;\">Nenhum Padr√£o Cr√≠tico Identificado</div>\n                <div style=\"font-size: 14px; color: #10b981;\">N√£o h√° combina√ß√µes com alta recorr√™ncia de problemas.</div>\n            </div>\n        `;\n    } else {\n        html = `<div style=\"display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px;\">`;\n        \n        padroes.forEach(p => {\n            html += `\n                <div style=\"background: white; border: 2px solid ${p.cor}; border-radius: 8px; padding: 16px; transition: all 0.2s; cursor: pointer;\"\n                     onmouseover=\"this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'\"\n                     onmouseout=\"this.style.transform='translateY(0)'; this.style.boxShadow='none'\">\n                    <div style=\"display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;\">\n                        <div style=\"font-size: 32px;\">${p.icon}</div>\n                        <div style=\"background: ${p.cor}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 10px; font-weight: 700;\">\n                            ${p.severidade}\n                        </div>\n                    </div>\n                    <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">${p.tipo}</div>\n                    <div style=\"font-size: 14px; font-weight: 600; color: #1f2937; margin-bottom: 8px; line-height: 1.4;\">${p.descricao}</div>\n                    <div style=\"display: flex; align-items: center; gap: 8px;\">\n                        <div style=\"flex: 1; height: 4px; background: #e5e7eb; border-radius: 2px; overflow: hidden;\">\n                            <div style=\"height: 100%; background: ${p.cor}; width: ${Math.min(p.ocorrencias * 10, 100)}%;\"></div>\n                        </div>\n                        <div style=\"font-size: 18px; font-weight: 900; color: ${p.cor};\">${p.ocorrencias}</div>\n                    </div>\n                </div>\n            `;\n        });\n        \n        html += `</div>`;\n    }\n    \n    document.getElementById('padroesProblematicos').innerHTML = html;\n}\n\n// Gerar matriz de correla√ß√µes\nfunction gerarMatrizCorrelacoes(dados) {\n    const categorias = [...new Set(dados.map(i => i.CATEGORIA_INTERCORRENCIA).filter(c => c))];\n    const vendedores = [...new Set(dados.map(i => i.NOME_RCA).filter(v => v))].slice(0, 10); // Top 10\n    \n    let html = `\n        <div style=\"overflow-x: auto;\">\n            <table style=\"width: 100%; border-collapse: collapse; font-size: 11px;\">\n                <thead>\n                    <tr>\n                        <th style=\"padding: 8px; border: 1px solid #e5e7eb; background: #f9fafb; position: sticky; left: 0; z-index: 10;\">Vendedor / Categoria</th>\n                        ${categorias.map(cat => `\n                            <th style=\"padding: 8px; border: 1px solid #e5e7eb; background: #f9fafb; text-align: center; min-width: 80px;\">\n                                ${cat}\n                            </th>\n                        `).join('')}\n                        <th style=\"padding: 8px; border: 1px solid #e5e7eb; background: #f9fafb; text-align: center; font-weight: 700;\">Total</th>\n                    </tr>\n                </thead>\n                <tbody>\n    `;\n    \n    vendedores.forEach(vendedor => {\n        let total = 0;\n        html += `<tr>`;\n        html += `<td style=\"padding: 8px; border: 1px solid #e5e7eb; font-weight: 600; background: #f9fafb; position: sticky; left: 0;\">${vendedor}</td>`;\n        \n        categorias.forEach(cat => {\n            const count = dados.filter(i => i.NOME_RCA === vendedor && i.CATEGORIA_INTERCORRENCIA === cat).length;\n            total += count;\n            \n            let bgColor = 'white';\n            if (count >= 10) bgColor = '#fee2e2';\n            else if (count >= 5) bgColor = '#fef3c7';\n            else if (count >= 2) bgColor = '#dbeafe';\n            \n            html += `\n                <td style=\"padding: 8px; border: 1px solid #e5e7eb; text-align: center; background: ${bgColor}; font-weight: ${count > 0 ? '700' : '400'};\">\n                    ${count > 0 ? count : '-'}\n                </td>\n            `;\n        });\n        \n        html += `<td style=\"padding: 8px; border: 1px solid #e5e7eb; text-align: center; font-weight: 900; color: #ef4444;\">${total}</td>`;\n        html += `</tr>`;\n    });\n    \n    html += `\n                </tbody>\n            </table>\n        </div>\n        <div style=\"display: flex; align-items: center; gap: 16px; margin-top: 12px; font-size: 11px; flex-wrap: wrap;\">\n            <div style=\"display: flex; align-items: center; gap: 4px;\">\n                <div style=\"width: 20px; height: 20px; background: white; border: 1px solid #e5e7eb; border-radius: 4px;\"></div>\n                <span>0-1</span>\n            </div>\n            <div style=\"display: flex; align-items: center; gap: 4px;\">\n                <div style=\"width: 20px; height: 20px; background: #dbeafe; border-radius: 4px;\"></div>\n                <span>2-4</span>\n            </div>\n            <div style=\"display: flex; align-items: center; gap: 4px;\">\n                <div style=\"width: 20px; height: 20px; background: #fef3c7; border-radius: 4px;\"></div>\n                <span>5-9</span>\n            </div>\n            <div style=\"display: flex; align-items: center; gap: 4px;\">\n                <div style=\"width: 20px; height: 20px; background: #fee2e2; border-radius: 4px;\"></div>\n                <span>10+</span>\n            </div>\n        </div>\n    `;\n    \n    document.getElementById('matrizCorrelacoes').innerHTML = html;\n}\n\n// Gerar insights de recorr√™ncia\nfunction gerarInsightsRecorrencia(dados) {\n    const insights = [];\n    \n    // Insight 1: Clientes com mesmo problema repetido\n    const clienteProblema = {};\n    dados.forEach(i => {\n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        if (codCliente) {\n            const key = `${codCliente}|||${i.CATEGORIA_INTERCORRENCIA}`;\n            if (!clienteProblema[key]) {\n                clienteProblema[key] = {\n                    cliente: i.NOME_CLIENTE || i.CLIENTE || 'N/A',\n                    categoria: i.CATEGORIA_INTERCORRENCIA,\n                    total: 0\n                };\n            }\n            clienteProblema[key].total++;\n        }\n    });\n    \n    const clientesRecorrentes = Object.values(clienteProblema).filter(p => p.total >= 2).length;\n    if (clientesRecorrentes > 0) {\n        insights.push({\n            icon: 'üîÅ',\n            titulo: 'Clientes com Problemas Recorrentes',\n            valor: clientesRecorrentes,\n            descricao: `${clientesRecorrentes} cliente(s) t√™m o mesmo tipo de problema mais de uma vez`,\n            cor: '#f59e0b'\n        });\n    }\n    \n    // Insight 2: Taxa de recorr√™ncia por categoria\n    const categoriaStats = {};\n    dados.forEach(i => {\n        if (!categoriaStats[i.CATEGORIA_INTERCORRENCIA]) {\n            categoriaStats[i.CATEGORIA_INTERCORRENCIA] = { total: 0, clientes: new Set() };\n        }\n        categoriaStats[i.CATEGORIA_INTERCORRENCIA].total++;\n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        if (codCliente) {\n            categoriaStats[i.CATEGORIA_INTERCORRENCIA].clientes.add(codCliente);\n        }\n    });\n    \n    let categoriaRecorrente = null;\n    let maxRecorrencia = 0;\n    \n    Object.entries(categoriaStats).forEach(([cat, stats]) => {\n        const taxaRecorrencia = stats.clientes.size > 0 ? stats.total / stats.clientes.size : 0;\n        if (taxaRecorrencia > maxRecorrencia) {\n            maxRecorrencia = taxaRecorrencia;\n            categoriaRecorrente = cat;\n        }\n    });\n    \n    if (categoriaRecorrente && maxRecorrencia > 1.5) {\n        insights.push({\n            icon: 'üìç',\n            titulo: 'Categoria com Maior Recorr√™ncia',\n            valor: categoriaRecorrente,\n            descricao: `M√©dia de ${maxRecorrencia.toFixed(1)} intercorr√™ncias por cliente`,\n            cor: '#dc2626'\n        });\n    }\n    \n    // Insight 3: Dia da semana com mais problemas\n    const diasSemana = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];\n    const porDia = {};\n    \n    dados.forEach(i => {\n        if (i.DATA_INTERCORRENCIA) {\n            const data = parsearData(i.DATA_INTERCORRENCIA);\n            if (data) {\n                const dia = diasSemana[data.getDay()];\n                porDia[dia] = (porDia[dia] || 0) + 1;\n            }\n        }\n    });\n    \n    const diaMax = Object.entries(porDia).sort((a, b) => b[1] - a[1])[0];\n    if (diaMax) {\n        insights.push({\n            icon: 'üìÖ',\n            titulo: 'Dia com Mais Intercorr√™ncias',\n            valor: diaMax[0],\n            descricao: `${diaMax[1]} intercorr√™ncias registradas`,\n            cor: '#7c3aed'\n        });\n    }\n    \n    // Insight 4: Motoboy com mais variedade de problemas\n    const motoboyVariedade = {};\n    dados.forEach(i => {\n        if (!motoboyVariedade[i.NOME_MOTOBOY]) {\n            motoboyVariedade[i.NOME_MOTOBOY] = new Set();\n        }\n        motoboyVariedade[i.NOME_MOTOBOY].add(i.CATEGORIA_INTERCORRENCIA);\n    });\n    \n    const motoboyMax = Object.entries(motoboyVariedade)\n        .map(([nome, cats]) => ({ nome, variedade: cats.size }))\n        .sort((a, b) => b.variedade - a.variedade)[0];\n    \n    if (motoboyMax && motoboyMax.variedade > 2) {\n        insights.push({\n            icon: 'üèçÔ∏è',\n            titulo: 'Motoboy com Maior Variedade',\n            valor: motoboyMax.nome,\n            descricao: `${motoboyMax.variedade} tipos diferentes de problemas`,\n            cor: '#06b6d4'\n        });\n    }\n    \n    // Renderizar insights\n    let html = `<div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;\">`;\n    \n    if (insights.length === 0) {\n        html += `\n            <div style=\"grid-column: 1 / -1; background: #f9fafb; border: 2px dashed #d1d5db; border-radius: 8px; padding: 24px; text-align: center;\">\n                <div style=\"font-size: 48px; margin-bottom: 12px;\">üìä</div>\n                <div style=\"font-size: 16px; font-weight: 600; color: #6b7280;\">N√£o h√° insights suficientes para an√°lise</div>\n            </div>\n        `;\n    } else {\n        insights.forEach(insight => {\n            html += `\n                <div style=\"background: white; border: 2px solid ${insight.cor}; border-radius: 8px; padding: 20px;\">\n                    <div style=\"font-size: 36px; margin-bottom: 12px;\">${insight.icon}</div>\n                    <div style=\"font-size: 12px; color: #6b7280; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">${insight.titulo}</div>\n                    <div style=\"font-size: 18px; font-weight: 900; color: ${insight.cor}; margin-bottom: 8px; word-break: break-word;\">${insight.valor}</div>\n                    <div style=\"font-size: 12px; color: #6b7280; line-height: 1.4;\">${insight.descricao}</div>\n                </div>\n            `;\n        });\n    }\n    \n    html += `</div>`;\n    \n    document.getElementById('insightsRecorrencia').innerHTML = html;\n}\n\n// Gerar tabela de combina√ß√µes cr√≠ticas\nfunction gerarTabelaCombinacoesCriticas(dados) {\n    const combinacoes = {};\n    \n    dados.forEach(i => {\n        const key = `${i.NOME_RCA}|||${i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL}|||${i.NOME_MOTOBOY}`;\n        if (!combinacoes[key]) {\n            combinacoes[key] = {\n                vendedor: i.NOME_RCA,\n                filial: i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL || 'N/A',\n                motoboy: i.NOME_MOTOBOY,\n                total: 0,\n                aprovadas: 0,\n                categorias: {}\n            };\n        }\n        combinacoes[key].total++;\n        if (getStatusIntercorrencia(i) === 'APROVADO') {\n            combinacoes[key].aprovadas++;\n        }\n        \n        const cat = i.CATEGORIA_INTERCORRENCIA;\n        combinacoes[key].categorias[cat] = (combinacoes[key].categorias[cat] || 0) + 1;\n    });\n    \n    const topCombinacoes = Object.values(combinacoes)\n        .map(c => ({\n            ...c,\n            taxaAprovacao: c.total > 0 ? Math.round((c.aprovadas / c.total) * 100) : 0,\n            categoriaPrincipal: Object.entries(c.categorias).sort((a, b) => b[1] - a[1])[0]\n        }))\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 20);\n    \n    let html = `\n        <table style=\"width: 100%; border-collapse: collapse; font-size: 11px;\">\n            <thead>\n                <tr style=\"background: #f9fafb; border-bottom: 2px solid #e5e7eb;\">\n                    <th style=\"padding: 10px; text-align: left; font-weight: 700;\">#</th>\n                    <th style=\"padding: 10px; text-align: left; font-weight: 700;\">Vendedor</th>\n                    <th style=\"padding: 10px; text-align: left; font-weight: 700;\">Filial</th>\n                    <th style=\"padding: 10px; text-align: left; font-weight: 700;\">Motoboy</th>\n                    <th style=\"padding: 10px; text-align: center; font-weight: 700;\">Total</th>\n                    <th style=\"padding: 10px; text-align: center; font-weight: 700;\">Taxa Aprov.</th>\n                    <th style=\"padding: 10px; text-align: left; font-weight: 700;\">Categoria Principal</th>\n                    <th style=\"padding: 10px; text-align: center; font-weight: 700;\">Risco</th>\n                </tr>\n            </thead>\n            <tbody>\n    `;\n    \n    topCombinacoes.forEach((comb, index) => {\n        let nivelRisco = 'BAIXO';\n        let corRisco = '#10b981';\n        \n        if (comb.total >= 10) {\n            nivelRisco = 'CR√çTICO';\n            corRisco = '#dc2626';\n        } else if (comb.total >= 5) {\n            nivelRisco = 'ALTO';\n            corRisco = '#f59e0b';\n        } else if (comb.total >= 3) {\n            nivelRisco = 'M√âDIO';\n            corRisco = '#06b6d4';\n        }\n        \n        html += `\n            <tr style=\"border-bottom: 1px solid #e5e7eb; transition: all 0.2s;\" \n                onmouseover=\"this.style.background='#f9fafb'\" \n                onmouseout=\"this.style.background='white'\">\n                <td style=\"padding: 10px; font-weight: 700; color: #6b7280;\">${index + 1}¬∫</td>\n                <td style=\"padding: 10px; max-width: 150px; overflow: hidden; text-overflow: ellipsis;\">${comb.vendedor || 'N/A'}</td>\n                <td style=\"padding: 10px; max-width: 120px; overflow: hidden; text-overflow: ellipsis;\">${comb.filial}</td>\n                <td style=\"padding: 10px; max-width: 120px; overflow: hidden; text-overflow: ellipsis;\">${comb.motoboy || 'N/A'}</td>\n                <td style=\"padding: 10px; text-align: center; font-weight: 900; color: #ef4444;\">${comb.total}</td>\n                <td style=\"padding: 10px; text-align: center; font-weight: 700; color: ${comb.taxaAprovacao >= 70 ? '#10b981' : comb.taxaAprovacao >= 40 ? '#f59e0b' : '#dc2626'};\">\n                    ${comb.taxaAprovacao}%\n                </td>\n                <td style=\"padding: 10px;\">${comb.categoriaPrincipal ? `${comb.categoriaPrincipal[0]} (${comb.categoriaPrincipal[1]})` : 'N/A'}</td>\n                <td style=\"padding: 10px; text-align: center;\">\n                    <span style=\"background: ${corRisco}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 10px; font-weight: 700;\">\n                        ${nivelRisco}\n                    </span>\n                </td>\n            </tr>\n        `;\n    });\n    \n    html += `\n            </tbody>\n        </table>\n    `;\n    \n    document.getElementById('tabelaCombinacoesCriticas').innerHTML = html;\n}\n\n// Gerar timeline de tend√™ncias\nfunction gerarTimelineTendencias(dados) {\n    // Agrupar por data\n    const porData = {};\n    \n    dados.forEach(i => {\n        if (i.DATA_INTERCORRENCIA) {\n            const data = parsearData(i.DATA_INTERCORRENCIA);\n            if (data) {\n                const dataStr = formatarData(data);\n                if (!porData[dataStr]) {\n                    porData[dataStr] = {\n                        total: 0,\n                        aprovadas: 0,\n                        categorias: {}\n                    };\n                }\n                porData[dataStr].total++;\n                if (getStatusIntercorrencia(i) === 'APROVADO') {\n                    porData[dataStr].aprovadas++;\n                }\n                const cat = i.CATEGORIA_INTERCORRENCIA;\n                porData[dataStr].categorias[cat] = (porData[dataStr].categorias[cat] || 0) + 1;\n            }\n        }\n    });\n    \n    const datasOrdenadas = Object.entries(porData)\n        .sort((a, b) => {\n            const dataA = parsearData(a[0]);\n            const dataB = parsearData(b[0]);\n            return dataA - dataB;\n        })\n        .slice(-14); // √öltimos 14 dias\n    \n    if (datasOrdenadas.length === 0) {\n        document.getElementById('timelineTendencias').innerHTML = `\n            <div style=\"text-align: center; padding: 40px; color: #6b7280;\">\n                <div style=\"font-size: 48px; margin-bottom: 12px;\">üìä</div>\n                <div>Dados insuficientes para an√°lise temporal</div>\n            </div>\n        `;\n        return;\n    }\n    \n    const maxTotal = Math.max(...datasOrdenadas.map(d => d[1].total));\n    \n    let html = `\n        <div style=\"display: flex; flex-direction: column; gap: 12px;\">\n    `;\n    \n    datasOrdenadas.forEach(([data, stats]) => {\n        const taxaAprovacao = stats.total > 0 ? Math.round((stats.aprovadas / stats.total) * 100) : 0;\n        const largura = (stats.total / maxTotal) * 100;\n        const categoriaPrincipal = Object.entries(stats.categorias).sort((a, b) => b[1] - a[1])[0];\n        \n        html += `\n            <div style=\"background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 12px; transition: all 0.2s;\"\n                 onmouseover=\"this.style.borderColor='#8b5cf6'; this.style.transform='translateX(4px)'\"\n                 onmouseout=\"this.style.borderColor='#e5e7eb'; this.style.transform='translateX(0)'\">\n                <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;\">\n                    <div style=\"font-weight: 700; color: #1f2937;\">${data}</div>\n                    <div style=\"display: flex; align-items: center; gap: 12px; font-size: 12px;\">\n                        <div style=\"color: #6b7280;\">Total: <strong style=\"color: #ef4444;\">${stats.total}</strong></div>\n                        <div style=\"color: #6b7280;\">Taxa: <strong style=\"color: ${taxaAprovacao >= 70 ? '#10b981' : taxaAprovacao >= 40 ? '#f59e0b' : '#dc2626'};\">${taxaAprovacao}%</strong></div>\n                        ${categoriaPrincipal ? `<div style=\"background: #f3f4f6; padding: 4px 8px; border-radius: 4px; font-size: 10px; font-weight: 600;\">${categoriaPrincipal[0]}</div>` : ''}\n                    </div>\n                </div>\n                <div style=\"width: 100%; height: 8px; background: #f3f4f6; border-radius: 4px; overflow: hidden;\">\n                    <div style=\"height: 100%; background: linear-gradient(90deg, #8b5cf6 0%, #7c3aed 100%); width: ${largura}%; transition: width 0.3s;\"></div>\n                </div>\n            </div>\n        `;\n    });\n    \n    html += `</div>`;\n    \n    // An√°lise de tend√™ncia\n    if (datasOrdenadas.length >= 2) {\n        const primeiroPeriodo = datasOrdenadas.slice(0, Math.floor(datasOrdenadas.length / 2));\n        const segundoPeriodo = datasOrdenadas.slice(Math.floor(datasOrdenadas.length / 2));\n        \n        const mediaPrimeiro = primeiroPeriodo.reduce((sum, d) => sum + d[1].total, 0) / primeiroPeriodo.length;\n        const mediaSegundo = segundoPeriodo.reduce((sum, d) => sum + d[1].total, 0) / segundoPeriodo.length;\n        \n        const tendencia = mediaSegundo > mediaPrimeiro ? 'AUMENTANDO' : mediaSegundo < mediaPrimeiro ? 'DIMINUINDO' : 'EST√ÅVEL';\n        const variacao = mediaPrimeiro > 0 ? Math.abs(((mediaSegundo - mediaPrimeiro) / mediaPrimeiro) * 100).toFixed(1) : 0;\n        \n        const corTendencia = tendencia === 'DIMINUINDO' ? '#10b981' : tendencia === 'AUMENTANDO' ? '#dc2626' : '#6b7280';\n        const iconTendencia = tendencia === 'DIMINUINDO' ? 'üìâ' : tendencia === 'AUMENTANDO' ? 'üìà' : '‚û°Ô∏è';\n        \n        html += `\n            <div style=\"background: linear-gradient(135deg, ${tendencia === 'DIMINUINDO' ? '#ecfdf5' : tendencia === 'AUMENTANDO' ? '#fee2e2' : '#f9fafb'} 0%, ${tendencia === 'DIMINUINDO' ? '#d1fae5' : tendencia === 'AUMENTANDO' ? '#fecaca' : '#f3f4f6'} 100%); border: 2px solid ${corTendencia}; border-radius: 8px; padding: 16px; margin-top: 16px;\">\n                <div style=\"display: flex; align-items: center; gap: 12px;\">\n                    <div style=\"font-size: 32px;\">${iconTendencia}</div>\n                    <div>\n                        <div style=\"font-weight: 700; color: ${corTendencia}; font-size: 16px;\">Tend√™ncia: ${tendencia}</div>\n                        <div style=\"font-size: 12px; color: #6b7280;\">Varia√ß√£o de ${variacao}% em rela√ß√£o ao per√≠odo anterior</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }\n    \n    document.getElementById('timelineTendencias').innerHTML = html;\n}\n\n// Gerar recomenda√ß√µes autom√°ticas\nfunction gerarRecomendacoesAutomaticas(dados) {\n    const recomendacoes = [];\n    \n    // Recomenda√ß√£o 1: Categorias com alta incid√™ncia\n    const porCategoria = {};\n    dados.forEach(i => {\n        porCategoria[i.CATEGORIA_INTERCORRENCIA] = (porCategoria[i.CATEGORIA_INTERCORRENCIA] || 0) + 1;\n    });\n    \n    const categoriaTop = Object.entries(porCategoria).sort((a, b) => b[1] - a[1])[0];\n    if (categoriaTop && categoriaTop[1] >= 5) {\n        recomendacoes.push({\n            prioridade: 'ALTA',\n            titulo: `Foco em: ${categoriaTop[0]}`,\n            descricao: `Esta categoria representa ${categoriaTop[1]} intercorr√™ncias (${Math.round((categoriaTop[1] / dados.length) * 100)}%). Recomenda-se treinamento espec√≠fico.`,\n            acao: 'Criar programa de treinamento focado nesta categoria',\n            icon: 'üéØ',\n            cor: '#dc2626'\n        });\n    }\n    \n    // Recomenda√ß√£o 2: Vendedores com baixa aprova√ß√£o\n    const vendedorStats = {};\n    dados.forEach(i => {\n        if (!vendedorStats[i.NOME_RCA]) {\n            vendedorStats[i.NOME_RCA] = { total: 0, aprovadas: 0 };\n        }\n        vendedorStats[i.NOME_RCA].total++;\n        if (getStatusIntercorrencia(i) === 'APROVADO') {\n            vendedorStats[i.NOME_RCA].aprovadas++;\n        }\n    });\n    \n    const vendedoresBaixaAprovacao = Object.entries(vendedorStats)\n        .map(([nome, stats]) => ({\n            nome,\n            taxa: stats.total > 0 ? (stats.aprovadas / stats.total) * 100 : 0,\n            total: stats.total\n        }))\n        .filter(v => v.taxa < 50 && v.total >= 3);\n    \n    if (vendedoresBaixaAprovacao.length > 0) {\n        recomendacoes.push({\n            prioridade: 'M√âDIA',\n            titulo: 'Suporte a Vendedores',\n            descricao: `${vendedoresBaixaAprovacao.length} vendedor(es) com taxa de aprova√ß√£o abaixo de 50%. Considere acompanhamento individualizado.`,\n            acao: 'Agendar reuni√µes de feedback e suporte',\n            icon: 'üë•',\n            cor: '#f59e0b'\n        });\n    }\n    \n    // Recomenda√ß√£o 3: Filiais problem√°ticas\n    const filialStats = {};\n    dados.forEach(i => {\n        const filial = i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL || 'N/A';\n        filialStats[filial] = (filialStats[filial] || 0) + 1;\n    });\n    \n    const filialTop = Object.entries(filialStats).sort((a, b) => b[1] - a[1])[0];\n    if (filialTop && filialTop[1] >= 10) {\n        recomendacoes.push({\n            prioridade: 'ALTA',\n            titulo: `Aten√ß√£o: Filial ${filialTop[0]}`,\n            descricao: `Esta filial concentra ${filialTop[1]} intercorr√™ncias. Investigue poss√≠veis problemas sist√™micos.`,\n            acao: 'Realizar auditoria operacional da filial',\n            icon: 'üè¢',\n            cor: '#dc2626'\n        });\n    }\n    \n    // Recomenda√ß√£o 4: Cliente recorrente\n    const clienteProblemas = {};\n    dados.forEach(i => {\n        const codCliente = i.CODIGO_CLIENTE || i.CODCLI;\n        if (codCliente) {\n            clienteProblemas[codCliente] = (clienteProblemas[codCliente] || 0) + 1;\n        }\n    });\n    \n    const clientesRecorrentes = Object.values(clienteProblemas).filter(c => c >= 3).length;\n    if (clientesRecorrentes > 0) {\n        recomendacoes.push({\n            prioridade: 'M√âDIA',\n            titulo: 'Clientes Recorrentes',\n            descricao: `${clientesRecorrentes} cliente(s) com 3+ problemas. Considere a√ß√£o proativa de relacionamento.`,\n            acao: 'Contato preventivo com clientes problem√°ticos',\n            icon: 'üîÅ',\n            cor: '#06b6d4'\n        });\n    }\n    \n    // Recomenda√ß√£o 5: Endere√ßo errado\n    const enderecoErrado = dados.filter(i => i.CATEGORIA_INTERCORRENCIA === 'ENDERECO ERRADO').length;\n    if (enderecoErrado >= 5) {\n        recomendacoes.push({\n            prioridade: 'ALTA',\n            titulo: 'Valida√ß√£o de Endere√ßos',\n            descricao: `${enderecoErrado} casos de endere√ßo errado. Implemente valida√ß√£o autom√°tica no cadastro.`,\n            acao: 'Integrar API de valida√ß√£o de endere√ßos',\n            icon: 'üìç',\n            cor: '#dc2626'\n        });\n    }\n    \n    // Renderizar\n    let html = '';\n    \n    if (recomendacoes.length === 0) {\n        html = `\n            <div style=\"text-align: center; padding: 40px;\">\n                <div style=\"font-size: 64px; margin-bottom: 16px;\">‚úÖ</div>\n                <div style=\"font-size: 20px; font-weight: 700; color: #065f46; margin-bottom: 8px;\">Excelente!</div>\n                <div style=\"font-size: 14px; color: #6b7280;\">Nenhuma recomenda√ß√£o cr√≠tica no momento. Continue o bom trabalho!</div>\n            </div>\n        `;\n    } else {\n        // Ordenar por prioridade\n        const ordem = { 'ALTA': 1, 'M√âDIA': 2, 'BAIXA': 3 };\n        recomendacoes.sort((a, b) => ordem[a.prioridade] - ordem[b.prioridade]);\n        \n        html = `<div style=\"display: flex; flex-direction: column; gap: 16px;\">`;\n        \n        recomendacoes.forEach((rec, index) => {\n            const bgPrioridade = rec.prioridade === 'ALTA' ? '#fee2e2' : rec.prioridade === 'M√âDIA' ? '#fef3c7' : '#dbeafe';\n            \n            html += `\n                <div style=\"background: white; border-left: 5px solid ${rec.cor}; border-radius: 8px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);\">\n                    <div style=\"display: flex; gap: 16px;\">\n                        <div style=\"font-size: 48px; flex-shrink: 0;\">${rec.icon}</div>\n                        <div style=\"flex: 1;\">\n                            <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 8px;\">\n                                <div style=\"background: ${bgPrioridade}; color: ${rec.cor}; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 700; text-transform: uppercase;\">\n                                    ${rec.prioridade}\n                                </div>\n                                <div style=\"font-size: 18px; font-weight: 700; color: #1f2937;\">${rec.titulo}</div>\n                            </div>\n                            <div style=\"font-size: 14px; color: #6b7280; margin-bottom: 12px; line-height: 1.5;\">${rec.descricao}</div>\n                            <div style=\"background: #f9fafb; border: 2px dashed ${rec.cor}; border-radius: 6px; padding: 12px;\">\n                                <div style=\"font-size: 11px; color: #6b7280; font-weight: 600; text-transform: uppercase; margin-bottom: 4px;\">‚úì A√ß√£o Recomendada:</div>\n                                <div style=\"font-size: 13px; color: #1f2937; font-weight: 600;\">${rec.acao}</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `;\n        });\n        \n        html += `</div>`;\n    }\n    \n    document.getElementById('recomendacoesAutomaticas').innerHTML = html;\n}\n\n// Gerar comparativo de performance\nfunction gerarComparativoPerformance(dados) {\n    const vendedorStats = {};\n    \n    dados.forEach(i => {\n        if (!vendedorStats[i.NOME_RCA]) {\n            vendedorStats[i.NOME_RCA] = { total: 0, aprovadas: 0, reprovadas: 0 };\n        }\n        vendedorStats[i.NOME_RCA].total++;\n        const status = getStatusIntercorrencia(i);\n        if (status === 'APROVADO') {\n            vendedorStats[i.NOME_RCA].aprovadas++;\n        } else if (status === 'REPROVADO') {\n            vendedorStats[i.NOME_RCA].reprovadas++;\n        }\n    });\n    \n    const vendedoresComTaxa = Object.entries(vendedorStats)\n        .filter(([nome, stats]) => stats.total >= 2) // M√≠nimo 2 intercorr√™ncias\n        .map(([nome, stats]) => ({\n            nome,\n            total: stats.total,\n            taxaAprovacao: (stats.aprovadas / stats.total) * 100,\n            taxaReprovacao: (stats.reprovadas / stats.total) * 100\n        }));\n    \n    // Top 5 melhores\n    const melhores = vendedoresComTaxa\n        .sort((a, b) => b.taxaAprovacao - a.taxaAprovacao)\n        .slice(0, 5);\n    \n    let htmlMelhores = '';\n    if (melhores.length === 0) {\n        htmlMelhores = '<div style=\"text-align: center; padding: 20px; color: #6b7280;\">Dados insuficientes</div>';\n    } else {\n        melhores.forEach((v, index) => {\n            htmlMelhores += `\n                <div style=\"background: white; border: 2px solid #d1fae5; border-radius: 8px; padding: 16px; margin-bottom: 12px;\">\n                    <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;\">\n                        <div style=\"display: flex; align-items: center; gap: 12px;\">\n                            <div style=\"font-size: 24px; font-weight: 900; color: #10b981;\">${index + 1}¬∫</div>\n                            <div style=\"font-size: 14px; font-weight: 600; color: #1f2937;\">${v.nome}</div>\n                        </div>\n                        <div style=\"font-size: 20px; font-weight: 900; color: #10b981;\">${v.taxaAprovacao.toFixed(0)}%</div>\n                    </div>\n                    <div style=\"display: flex; align-items: center; gap: 8px; font-size: 11px; color: #6b7280;\">\n                        <span>Total: ${v.total}</span>\n                        <span>‚Ä¢</span>\n                        <span style=\"color: #10b981; font-weight: 600;\">‚úì ${Math.round((v.taxaAprovacao / 100) * v.total)} aprovadas</span>\n                    </div>\n                </div>\n            `;\n        });\n    }\n    \n    // Top 5 necessitam aten√ß√£o\n    const precisamAtencao = vendedoresComTaxa\n        .sort((a, b) => b.taxaReprovacao - a.taxaReprovacao)\n        .slice(0, 5);\n    \n    let htmlAtencao = '';\n    if (precisamAtencao.length === 0) {\n        htmlAtencao = '<div style=\"text-align: center; padding: 20px; color: #6b7280;\">Dados insuficientes</div>';\n    } else {\n        precisamAtencao.forEach((v, index) => {\n            htmlAtencao += `\n                <div style=\"background: white; border: 2px solid #fecaca; border-radius: 8px; padding: 16px; margin-bottom: 12px;\">\n                    <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;\">\n                        <div style=\"display: flex; align-items: center; gap: 12px;\">\n                            <div style=\"font-size: 24px; font-weight: 900; color: #dc2626;\">${index + 1}¬∫</div>\n                            <div style=\"font-size: 14px; font-weight: 600; color: #1f2937;\">${v.nome}</div>\n                        </div>\n                        <div style=\"font-size: 20px; font-weight: 900; color: #dc2626;\">${v.taxaReprovacao.toFixed(0)}%</div>\n                    </div>\n                    <div style=\"display: flex; align-items: center; gap: 8px; font-size: 11px; color: #6b7280;\">\n                        <span>Total: ${v.total}</span>\n                        <span>‚Ä¢</span>\n                        <span style=\"color: #dc2626; font-weight: 600;\">‚úó ${Math.round((v.taxaReprovacao / 100) * v.total)} reprovadas</span>\n                    </div>\n                </div>\n            `;\n        });\n    }\n    \n    document.getElementById('topMelhoresPerformers').innerHTML = htmlMelhores;\n    document.getElementById('topNecessitamAtencao').innerHTML = htmlAtencao;\n}\n\n// Gerar an√°lise de impacto\nfunction gerarAnaliseImpacto(dados) {\n    const totalIntercorrencias = dados.length;\n    const totalPedidos = new Set(dados.map(i => i.NUMPED)).size;\n    const totalClientes = new Set(dados.map(i => i.CODIGO_CLIENTE || i.CODCLI).filter(c => c)).size;\n    \n    // Calcular tempo m√©dio de intercorr√™ncia\n    let tempoTotal = 0;\n    let tempoCount = 0;\n    dados.forEach(i => {\n        if (i.TEMPO_INTERCORRENCIA) {\n            const minutos = converterTempoParaMinutos(i.TEMPO_INTERCORRENCIA);\n            if (minutos > 0) {\n                tempoTotal += minutos;\n                tempoCount++;\n            }\n        }\n    });\n    const tempoMedio = tempoCount > 0 ? Math.round(tempoTotal / tempoCount) : 0;\n    \n    // Estimar impacto\n    const impactoPedidos = ((totalPedidos / totalIntercorrencias) * 100).toFixed(1);\n    const impactoClientes = ((totalClientes / totalIntercorrencias) * 100).toFixed(1);\n    \n    const html = `\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;\">\n            <div style=\"background: white; border: 2px solid #dbeafe; border-radius: 8px; padding: 20px; text-align: center;\">\n                <div style=\"font-size: 32px; margin-bottom: 8px;\">üì¶</div>\n                <div style=\"font-size: 28px; font-weight: 900; color: #1e40af; margin-bottom: 4px;\">${totalPedidos}</div>\n                <div style=\"font-size: 12px; color: #6b7280;\">Pedidos Afetados</div>\n            </div>\n            <div style=\"background: white; border: 2px solid #fef3c7; border-radius: 8px; padding: 20px; text-align: center;\">\n                <div style=\"font-size: 32px; margin-bottom: 8px;\">üë•</div>\n                <div style=\"font-size: 28px; font-weight: 900; color: #f59e0b; margin-bottom: 4px;\">${totalClientes}</div>\n                <div style=\"font-size: 12px; color: #6b7280;\">Clientes Impactados</div>\n            </div>\n            <div style=\"background: white; border: 2px solid #fecaca; border-radius: 8px; padding: 20px; text-align: center;\">\n                <div style=\"font-size: 32px; margin-bottom: 8px;\">‚è±Ô∏è</div>\n                <div style=\"font-size: 28px; font-weight: 900; color: #dc2626; margin-bottom: 4px;\">${tempoMedio}min</div>\n                <div style=\"font-size: 12px; color: #6b7280;\">Tempo M√©dio</div>\n            </div>\n            <div style=\"background: white; border: 2px solid #d1fae5; border-radius: 8px; padding: 20px; text-align: center;\">\n                <div style=\"font-size: 32px; margin-bottom: 8px;\">üí∞</div>\n                <div style=\"font-size: 28px; font-weight: 900; color: #059669; margin-bottom: 4px;\">${(tempoTotal / 60).toFixed(1)}h</div>\n                <div style=\"font-size: 12px; color: #6b7280;\">Tempo Total Gasto</div>\n            </div>\n        </div>\n        \n        <div style=\"background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%); border-radius: 8px; padding: 20px; margin-top: 20px;\">\n            <div style=\"font-size: 14px; font-weight: 700; color: #5b21b6; margin-bottom: 12px;\">üìä An√°lise de Impacto</div>\n            <div style=\"display: flex; flex-direction: column; gap: 8px; font-size: 13px; color: #6d28d9;\">\n                <div style=\"display: flex; align-items: center; gap: 8px;\">\n                    <span style=\"font-size: 20px;\">‚Ä¢</span>\n                    <span>Cada intercorr√™ncia afeta em m√©dia <strong>${impactoPedidos}%</strong> dos pedidos</span>\n                </div>\n                <div style=\"display: flex; align-items: center; gap: 8px;\">\n                    <span style=\"font-size: 20px;\">‚Ä¢</span>\n                    <span>Aproximadamente <strong>${impactoClientes}%</strong> dos clientes foram impactados</span>\n                </div>\n                <div style=\"display: flex; align-items: center; gap: 8px;\">\n                    <span style=\"font-size: 20px;\">‚Ä¢</span>\n                    <span>Tempo total investido em resolu√ß√£o: <strong>${(tempoTotal / 60).toFixed(1)} horas</strong></span>\n                </div>\n                ${tempoMedio > 30 ? `\n                <div style=\"display: flex; align-items: center; gap: 8px; color: #dc2626; font-weight: 600;\">\n                    <span style=\"font-size: 20px;\">‚ö†Ô∏è</span>\n                    <span>Tempo m√©dio acima do ideal (30min). Recomenda-se otimiza√ß√£o de processos.</span>\n                </div>\n                ` : ''}\n            </div>\n        </div>\n    `;\n    \n    document.getElementById('analiseImpacto').innerHTML = html;\n}\n\n// Fun√ß√£o auxiliar para converter tempo em minutos\nfunction converterTempoParaMinutos(tempoStr) {\n    if (!tempoStr) return 0;\n    \n    // Formato esperado: \"0 0:4:0.0\" ou similar\n    try {\n        const partes = tempoStr.toString().split(' ');\n        if (partes.length >= 2) {\n            const tempo = partes[1].split(':');\n            const horas = parseInt(tempo[0]) || 0;\n            const minutos = parseInt(tempo[1]) || 0;\n            return (horas * 60) + minutos;\n        }\n    } catch (e) {\n        console.warn('Erro ao converter tempo:', tempoStr, e);\n    }\n    return 0;\n}\n\n// ============================================\n// FIM AN√ÅLISE INTELIGENTE DE PADR√ïES\n// ============================================\n\n// ============================================\n// FIM AN√ÅLISES DE DIVERG√äNCIAS\n// ============================================\n\n// ============================================\n// ESTRATIFICA√á√ÉO PERCENTUAL\n// ============================================\n\nfunction gerarEstrategiaPercentual() {\n    console.log('üìä Gerando estratifica√ß√£o percentual...');\n    \n    gerarPercCategoria();\n    gerarPercStatus();\n    gerarPercFilial();\n    gerarPercCidade();\n    gerarPercMotoboy();\n    gerarPercVendedor();\n    gerarPercDiaSemana();\n    gerarPercPeriodoDia();\n    gerarResumoPercentual();\n}\n\n// Fun√ß√£o auxiliar para gerar barra percentual\nfunction gerarBarraPercentual(label, count, total, cor, icone = '') {\n    const perc = total > 0 ? ((count / total) * 100).toFixed(1) : 0;\n    return `\n        <div style=\"margin-bottom: 16px; padding: 12px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;\">\n                <div style=\"display: flex; align-items: center; gap: 8px;\">\n                    ${icone ? `<span style=\"font-size: 20px;\">${icone}</span>` : ''}\n                    <span style=\"font-weight: 600; color: #1f2937; font-size: 13px;\">${label}</span>\n                </div>\n                <div style=\"display: flex; align-items: center; gap: 12px;\">\n                    <span style=\"font-weight: 700; color: ${cor}; font-size: 16px;\">${perc}%</span>\n                    <span style=\"color: #6b7280; font-size: 12px;\">(${count})</span>\n                </div>\n            </div>\n            <div style=\"width: 100%; height: 12px; background: #f3f4f6; border-radius: 6px; overflow: hidden;\">\n                <div style=\"height: 100%; background: ${cor}; width: ${perc}%; transition: width 0.5s ease; box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);\"></div>\n            </div>\n        </div>\n    `;\n}\n\n// Percentual por Categoria\nfunction gerarPercCategoria() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    const categoriaCount = {};\n    \n    dados.forEach(i => {\n        const cat = i.CATEGORIA_INTERCORRENCIA || 'N√£o Categorizado';\n        categoriaCount[cat] = (categoriaCount[cat] || 0) + 1;\n    });\n    \n    const cores = ['#ef4444', '#f97316', '#f59e0b', '#eab308', '#84cc16', '#22c55e', '#10b981'];\n    const sorted = Object.entries(categoriaCount).sort((a, b) => b[1] - a[1]);\n    \n    let html = '';\n    sorted.forEach(([cat, count], index) => {\n        const cor = cores[index % cores.length];\n        html += gerarBarraPercentual(cat, count, total, cor, 'üìç');\n    });\n    \n    document.getElementById('percCategoria').innerHTML = html;\n}\n\n// Percentual por Status\nfunction gerarPercStatus() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    \n    const aprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = dados.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    \n    let html = '';\n    html += gerarBarraPercentual('Aprovadas', aprovadas, total, '#10b981', '‚úÖ');\n    html += gerarBarraPercentual('Pendentes', pendentes, total, '#f59e0b', '‚è≥');\n    html += gerarBarraPercentual('Reprovadas', reprovadas, total, '#ef4444', '‚ùå');\n    \n    document.getElementById('percStatus').innerHTML = html;\n}\n\n// Percentual por Filial\nfunction gerarPercFilial() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    const filialCount = {};\n    \n    dados.forEach(i => {\n        const filial = i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL || i.ID_FILIAL || 'N/A';\n        filialCount[filial] = (filialCount[filial] || 0) + 1;\n    });\n    \n    const cores = ['#3b82f6', '#2563eb', '#1d4ed8', '#1e40af', '#1e3a8a'];\n    const sorted = Object.entries(filialCount).sort((a, b) => b[1] - a[1]);\n    \n    let html = '';\n    sorted.forEach(([filial, count], index) => {\n        const cor = cores[index % cores.length];\n        html += gerarBarraPercentual(filial, count, total, cor, 'üè¢');\n    });\n    \n    document.getElementById('percFilial').innerHTML = html;\n}\n\n// Percentual por Cidade\nfunction gerarPercCidade() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    const cidadeCount = {};\n    \n    dados.forEach(i => {\n        const cidade = i.CIDADE || 'N/A';\n        cidadeCount[cidade] = (cidadeCount[cidade] || 0) + 1;\n    });\n    \n    const cores = ['#f59e0b', '#f97316', '#ea580c', '#dc2626', '#c2410c'];\n    const sorted = Object.entries(cidadeCount).sort((a, b) => b[1] - a[1]);\n    \n    let html = '';\n    sorted.forEach(([cidade, count], index) => {\n        const cor = cores[index % cores.length];\n        html += gerarBarraPercentual(cidade, count, total, cor, 'üèôÔ∏è');\n    });\n    \n    document.getElementById('percCidade').innerHTML = html;\n}\n\n// Percentual por Motoboy (Top 10)\nfunction gerarPercMotoboy() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    const motoboyCount = {};\n    \n    dados.forEach(i => {\n        const motoboy = i.NOME_MOTOBOY || 'N/A';\n        motoboyCount[motoboy] = (motoboyCount[motoboy] || 0) + 1;\n    });\n    \n    const cores = ['#8b5cf6', '#7c3aed', '#6d28d9', '#5b21b6', '#4c1d95'];\n    const sorted = Object.entries(motoboyCount).sort((a, b) => b[1] - a[1]).slice(0, 10);\n    \n    let html = '';\n    sorted.forEach(([motoboy, count], index) => {\n        const cor = cores[index % cores.length];\n        html += gerarBarraPercentual(motoboy, count, total, cor, 'üèçÔ∏è');\n    });\n    \n    document.getElementById('percMotoboy').innerHTML = html;\n}\n\n// Percentual por Vendedor (Top 10)\nfunction gerarPercVendedor() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    const vendedorCount = {};\n    \n    dados.forEach(i => {\n        const vendedor = i.NOME_RCA || 'N/A';\n        vendedorCount[vendedor] = (vendedorCount[vendedor] || 0) + 1;\n    });\n    \n    const cores = ['#06b6d4', '#0891b2', '#0e7490', '#155e75', '#164e63'];\n    const sorted = Object.entries(vendedorCount).sort((a, b) => b[1] - a[1]).slice(0, 10);\n    \n    let html = '';\n    sorted.forEach(([vendedor, count], index) => {\n        const cor = cores[index % cores.length];\n        html += gerarBarraPercentual(vendedor, count, total, cor, 'üíº');\n    });\n    \n    document.getElementById('percVendedor').innerHTML = html;\n}\n\n// Percentual por Dia da Semana\nfunction gerarPercDiaSemana() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    const diasSemana = ['Domingo', 'Segunda-feira', 'Ter√ßa-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'S√°bado'];\n    const diaCount = {};\n    \n    diasSemana.forEach(dia => diaCount[dia] = 0);\n    \n    dados.forEach(i => {\n        if (i.DATA_INTERCORRENCIA) {\n            const data = parsearData(i.DATA_INTERCORRENCIA);\n            if (data) {\n                const dia = diasSemana[data.getDay()];\n                diaCount[dia]++;\n            }\n        }\n    });\n    \n    const cores = ['#ec4899', '#db2777', '#be185d', '#9d174d', '#831843', '#f472b6', '#f9a8d4'];\n    \n    let html = '';\n    diasSemana.forEach((dia, index) => {\n        const count = diaCount[dia];\n        const cor = cores[index % cores.length];\n        html += gerarBarraPercentual(dia, count, total, cor, 'üìÖ');\n    });\n    \n    document.getElementById('percDiaSemana').innerHTML = html;\n}\n\n// Percentual por Per√≠odo do Dia\nfunction gerarPercPeriodoDia() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    const periodoCount = {\n        'Madrugada (00h-06h)': 0,\n        'Manh√£ (06h-12h)': 0,\n        'Tarde (12h-18h)': 0,\n        'Noite (18h-00h)': 0\n    };\n    \n    dados.forEach(i => {\n        if (i.DATA_INTERCORRENCIA) {\n            const data = parsearData(i.DATA_INTERCORRENCIA);\n            if (data) {\n                const hora = data.getHours();\n                if (hora >= 0 && hora < 6) periodoCount['Madrugada (00h-06h)']++;\n                else if (hora >= 6 && hora < 12) periodoCount['Manh√£ (06h-12h)']++;\n                else if (hora >= 12 && hora < 18) periodoCount['Tarde (12h-18h)']++;\n                else periodoCount['Noite (18h-00h)']++;\n            }\n        }\n    });\n    \n    const cores = ['#14b8a6', '#0d9488', '#0f766e', '#115e59'];\n    const icones = ['üåô', 'üåÖ', '‚òÄÔ∏è', 'üåÜ'];\n    \n    let html = '';\n    Object.entries(periodoCount).forEach(([periodo, count], index) => {\n        html += gerarBarraPercentual(periodo, count, total, cores[index], icones[index]);\n    });\n    \n    document.getElementById('percPeriodoDia').innerHTML = html;\n}\n\n// Resumo Geral Percentual\nfunction gerarResumoPercentual() {\n    const dados = intercorrenciasFiltradas;\n    const total = dados.length;\n    \n    // Taxa de Aprova√ß√£o\n    const aprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const taxaAprovacao = total > 0 ? ((aprovadas / total) * 100).toFixed(1) : 0;\n    \n    // Categoria mais comum\n    const categoriaCount = {};\n    dados.forEach(i => {\n        const cat = i.CATEGORIA_INTERCORRENCIA || 'N/A';\n        categoriaCount[cat] = (categoriaCount[cat] || 0) + 1;\n    });\n    const categoriaTop = Object.entries(categoriaCount).sort((a, b) => b[1] - a[1])[0];\n    const categoriaPrincipalPerc = categoriaTop && total > 0 ? ((categoriaTop[1] / total) * 100).toFixed(1) : 0;\n    \n    // Filial mais afetada\n    const filialCount = {};\n    dados.forEach(i => {\n        const filial = i.RAZAOSOCIAL_FILIAL || i.CODIGO_FILIAL || 'N/A';\n        filialCount[filial] = (filialCount[filial] || 0) + 1;\n    });\n    const filialTop = Object.entries(filialCount).sort((a, b) => b[1] - a[1])[0];\n    const filialPrincipalPerc = filialTop && total > 0 ? ((filialTop[1] / total) * 100).toFixed(1) : 0;\n    \n    // Cidade mais afetada\n    const cidadeCount = {};\n    dados.forEach(i => {\n        const cidade = i.CIDADE || 'N/A';\n        cidadeCount[cidade] = (cidadeCount[cidade] || 0) + 1;\n    });\n    const cidadeTop = Object.entries(cidadeCount).sort((a, b) => b[1] - a[1])[0];\n    const cidadePrincipalPerc = cidadeTop && total > 0 ? ((cidadeTop[1] / total) * 100).toFixed(1) : 0;\n    \n    const html = `\n        <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;\">\n            <div style=\"background: white; border-radius: 12px; padding: 20px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-top: 4px solid #10b981;\">\n                <div style=\"font-size: 36px; margin-bottom: 12px;\">‚úÖ</div>\n                <div style=\"font-size: 14px; color: #6b7280; font-weight: 600; margin-bottom: 8px;\">Taxa de Aprova√ß√£o Geral</div>\n                <div style=\"font-size: 36px; font-weight: 900; color: #10b981; margin-bottom: 4px;\">${taxaAprovacao}%</div>\n                <div style=\"font-size: 12px; color: #6b7280;\">${aprovadas} de ${total} intercorr√™ncias</div>\n            </div>\n            \n            <div style=\"background: white; border-radius: 12px; padding: 20px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-top: 4px solid #ef4444;\">\n                <div style=\"font-size: 36px; margin-bottom: 12px;\">üìç</div>\n                <div style=\"font-size: 14px; color: #6b7280; font-weight: 600; margin-bottom: 8px;\">Categoria Mais Comum</div>\n                <div style=\"font-size: 18px; font-weight: 700; color: #1f2937; margin-bottom: 8px;\">${categoriaTop ? categoriaTop[0] : 'N/A'}</div>\n                <div style=\"font-size: 28px; font-weight: 900; color: #ef4444; margin-bottom: 4px;\">${categoriaPrincipalPerc}%</div>\n                <div style=\"font-size: 12px; color: #6b7280;\">${categoriaTop ? categoriaTop[1] : 0} intercorr√™ncias</div>\n            </div>\n            \n            <div style=\"background: white; border-radius: 12px; padding: 20px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-top: 4px solid #3b82f6;\">\n                <div style=\"font-size: 36px; margin-bottom: 12px;\">üè¢</div>\n                <div style=\"font-size: 14px; color: #6b7280; font-weight: 600; margin-bottom: 8px;\">Filial Mais Afetada</div>\n                <div style=\"font-size: 16px; font-weight: 700; color: #1f2937; margin-bottom: 8px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;\" title=\"${filialTop ? filialTop[0] : 'N/A'}\">${filialTop ? filialTop[0] : 'N/A'}</div>\n                <div style=\"font-size: 28px; font-weight: 900; color: #3b82f6; margin-bottom: 4px;\">${filialPrincipalPerc}%</div>\n                <div style=\"font-size: 12px; color: #6b7280;\">${filialTop ? filialTop[1] : 0} intercorr√™ncias</div>\n            </div>\n            \n            <div style=\"background: white; border-radius: 12px; padding: 20px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-top: 4px solid #f59e0b;\">\n                <div style=\"font-size: 36px; margin-bottom: 12px;\">üèôÔ∏è</div>\n                <div style=\"font-size: 14px; color: #6b7280; font-weight: 600; margin-bottom: 8px;\">Cidade Mais Afetada</div>\n                <div style=\"font-size: 18px; font-weight: 700; color: #1f2937; margin-bottom: 8px;\">${cidadeTop ? cidadeTop[0] : 'N/A'}</div>\n                <div style=\"font-size: 28px; font-weight: 900; color: #f59e0b; margin-bottom: 4px;\">${cidadePrincipalPerc}%</div>\n                <div style=\"font-size: 12px; color: #6b7280;\">${cidadeTop ? cidadeTop[1] : 0} intercorr√™ncias</div>\n            </div>\n        </div>\n    `;\n    \n    document.getElementById('resumoPercentual').innerHTML = html;\n}\n\n// ============================================\n// FIM ESTRATIFICA√á√ÉO PERCENTUAL\n// ============================================\n\n// Inicializar sistema\nsetTimeout(() => {\n    console.log('‚ö†Ô∏è Inicializando Central de Intercorr√™ncias BI 2.0...');\n    console.log('üì¶ Dados carregados:', intercorrenciasOriginais.length, 'intercorr√™ncias');\n    \n    if (intercorrenciasOriginais.length > 0) {\n        console.log('üîç Exemplo de intercorr√™ncia:', intercorrenciasOriginais[0]);\n        console.log('üîë Campos dispon√≠veis:', Object.keys(intercorrenciasOriginais[0]));\n        \n        // Debug de formato de data\n        if (intercorrenciasOriginais[0].DATA_INTERCORRENCIA) {\n            console.log('üìÖ Formato de DATA_INTERCORRENCIA:', \n                       typeof intercorrenciasOriginais[0].DATA_INTERCORRENCIA, \n                       '=', \n                       intercorrenciasOriginais[0].DATA_INTERCORRENCIA);\n            const dataParsed = parsearData(intercorrenciasOriginais[0].DATA_INTERCORRENCIA);\n            console.log('üìÖ Data parseada:', dataParsed);\n            console.log('üìÖ Data formatada:', formatarData(intercorrenciasOriginais[0].DATA_INTERCORRENCIA));\n            if (dataParsed) {\n                console.log('‚è∞ Hora extra√≠da:', dataParsed.getHours() + ':' + String(dataParsed.getMinutes()).padStart(2, '0'));\n            }\n        }\n        \n        // Debug de extra√ß√£o de UF\n        console.log('üó∫Ô∏è Exemplo de CIDADE:', intercorrenciasOriginais[0].CIDADE, '‚Üí UF:', extrairUF(intercorrenciasOriginais[0]));\n        const cidadesUnicas = [...new Set(intercorrenciasOriginais.map(i => i.CIDADE))];\n        console.log('üèôÔ∏è Cidades √∫nicas:', cidadesUnicas);\n        const mapeamentoUF = {};\n        cidadesUnicas.forEach(c => {\n            const item = intercorrenciasOriginais.find(i => i.CIDADE === c);\n            mapeamentoUF[c] = extrairUF(item);\n        });\n        console.log('üìç Mapeamento Cidade ‚Üí UF:', mapeamentoUF);\n        \n        // Verificar aprova√ß√µes\n        const aprovadas = intercorrenciasOriginais.filter(i => i.APROVACAO_INTERCORRENCIA === 'TRUE').length;\n        const pendentes = intercorrenciasOriginais.filter(i => i.APROVACAO_INTERCORRENCIA !== 'TRUE').length;\n        const reprovadas = intercorrenciasOriginais.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n        console.log('üìä Status inicial: ' + aprovadas + ' aprovadas, ' + reprovadas + ' reprovadas, ' + pendentes + ' pendentes');\n        \n        popularFiltros();\n        intercorrenciasFiltradas = intercorrenciasOriginais;\n        atualizarEstatisticas();\n        renderizarCards();\n        atualizarResultados();\n        gerarGraficos();\n    } else {\n        document.getElementById('intercorrenciasGrid').innerHTML = `\n            <div class=\"sem-intercorrencias\">\n                <div class=\"sem-intercorrencias-icon\">‚úÖ</div>\n                <div class=\"sem-intercorrencias-texto\">Nenhuma intercorr√™ncia registrada</div>\n                <div class=\"sem-intercorrencias-subtexto\">Excelente! Sistema funcionando sem problemas.</div>\n            </div>\n        `;\n    }\n    \n    console.log('‚úÖ Central de Intercorr√™ncias BI 2.0 inicializada');\n    console.log('üîç Use o bot√£o \"Debug\" no header para an√°lise detalhada');\n}, 500);\n</script>\n\n{{''}}\n",
  "topRow": 4,
  "type": "IFRAME_WIDGET",
  "version": 1,
  "widgetId": "ekz2tqwfot",
  "widgetName": "Iframe11"
}