{
  "animateLoading": true,
  "borderOpacity": 100,
  "borderRadius": "{{appsmith.theme.borderRadius.appBorderRadius}}",
  "borderWidth": 1,
  "bottomRow": 298,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "dynamicBindingPathList": [
    {
      "key": "borderRadius"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "srcDoc"
    }
  ],
  "dynamicTriggerPathList": [],
  "flexVerticalAlignment": "start",
  "isLoading": false,
  "isVisible": true,
  "key": "gw9rz40e8t",
  "leftColumn": 0,
  "mobileBottomRow": 33,
  "mobileLeftColumn": 19,
  "mobileRightColumn": 43,
  "mobileTopRow": 1,
  "needsErrorInfo": false,
  "originalBottomRow": 161,
  "originalTopRow": 20,
  "parentColumnSpace": 20.25,
  "parentId": "udvxef4in5",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "responsiveBehavior": "fill",
  "rightColumn": 63,
  "source": "https://www.example.com",
  "srcDoc": "<style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    \n    body {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;\n        background: #f5f7fa;\n        padding: 12px;\n        font-size: 11px;\n    }\n    \n    .dashboard-container {\n        max-width: 100%;\n        background: white;\n        border-radius: 8px;\n        padding: 16px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n    }\n    \n    /* Filters */\n    .filters-row {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));\n        gap: 10px;\n        margin-bottom: 16px;\n        padding-bottom: 12px;\n        border-bottom: 2px solid #e5e7eb;\n    }\n    \n    .filter-group {\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n    }\n    \n    .filter-label {\n        font-size: 9px;\n        font-weight: 700;\n        color: #6b7280;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    .filter-value {\n        padding: 6px 10px;\n        background: #f9fafb;\n        border: 1px solid #e5e7eb;\n        border-radius: 6px;\n        font-size: 11px;\n        color: #111827;\n        font-weight: 600;\n    }\n    \n    /* KPIs */\n    .kpis-row {\n        display: grid;\n        grid-template-columns: repeat(2, 1fr);\n        gap: 16px;\n        margin-bottom: 16px;\n    }\n    \n    .kpi-box {\n        background: white;\n        border: 2px solid #1890ff;\n        border-radius: 8px;\n        padding: 12px;\n        text-align: center;\n    }\n    \n    .kpi-value {\n        font-size: 32px;\n        font-weight: 900;\n        color: #1890ff;\n        line-height: 1;\n        margin-bottom: 6px;\n    }\n    \n    .kpi-label {\n        font-size: 10px;\n        font-weight: 700;\n        color: #6b7280;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    /* Legends */\n    .legends-box {\n        background: #f9fafb;\n        border: 1px solid #e5e7eb;\n        border-radius: 8px;\n        padding: 10px;\n        margin-bottom: 16px;\n    }\n    \n    .legend-item {\n        font-size: 9px;\n        color: #6b7280;\n        margin-bottom: 4px;\n        line-height: 1.3;\n    }\n    \n    .legend-item strong {\n        color: #111827;\n        font-weight: 700;\n    }\n    \n    /* Tables */\n    table {\n        width: 100%;\n        border-collapse: collapse;\n        font-size: 10px;\n        margin-bottom: 20px;\n    }\n    \n    thead th {\n        background: #1e40af;\n        color: white;\n        padding: 8px 6px;\n        text-align: left;\n        font-weight: 700;\n        font-size: 9px;\n        text-transform: uppercase;\n        letter-spacing: 0.3px;\n        border: 1px solid #1e3a8a;\n        white-space: nowrap;\n    }\n    \n    tbody td {\n        padding: 6px;\n        border: 1px solid #e5e7eb;\n        font-size: 10px;\n    }\n    \n    tbody tr:hover {\n        background: #f9fafb;\n    }\n    \n    /* REGRAS DE COLORA√á√ÉO CORRETAS (baseadas na imagem) */\n    .cell-green {\n        background: #d1fae5 !important;\n        color: #065f46 !important;\n        font-weight: 700 !important;\n    }\n    \n    .cell-blue {\n        background: #dbeafe !important;\n        color: #1e40af !important;\n        font-weight: 700 !important;\n    }\n    \n    .cell-yellow {\n        background: #fef3c7 !important;\n        color: #92400e !important;\n        font-weight: 700 !important;\n    }\n    \n    .cell-red {\n        background: #fee2e2 !important;\n        color: #991b1b !important;\n        font-weight: 700 !important;\n    }\n    \n    .cell-pink {\n        background: #fce7f3 !important;\n        color: #831843 !important;\n        font-weight: 700 !important;\n    }\n    \n    .cell-black {\n        background: #1f2937 !important;\n        color: white !important;\n        font-weight: 700 !important;\n    }\n    \n    /* Status icons */\n    .status-ok::before {\n        content: '‚úì';\n        color: #10b981;\n        font-weight: 900;\n        margin-right: 4px;\n    }\n    \n    .status-warning::before {\n        content: '‚úó';\n        color: #ef4444;\n        font-weight: 900;\n        margin-right: 4px;\n    }\n    \n    .text-center { text-align: center; }\n    .text-muted { color: #6b7280; }\n    .text-bold { font-weight: 700; }\n    \n    /* Section titles */\n    .section-title {\n        font-size: 13px;\n        font-weight: 800;\n        color: #1890ff;\n        margin: 16px 0 10px 0;\n        padding-bottom: 6px;\n        border-bottom: 2px solid #1890ff;\n    }\n    \n    /* Filter selects */\n    .filter-select {\n        padding: 6px 10px;\n        background: white;\n        border: 1px solid #1890ff;\n        border-radius: 6px;\n        font-size: 11px;\n        color: #111827;\n        font-weight: 600;\n        cursor: pointer;\n        width: 100%;\n    }\n    \n    .filter-select:focus {\n        outline: none;\n        border-color: #0050b3;\n        box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);\n    }\n    \n    /* Pagination */\n    .pagination-container {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-top: 12px;\n        padding: 10px;\n        background: #f9fafb;\n        border-radius: 6px;\n    }\n    \n    .pagination-info {\n        font-size: 11px;\n        color: #6b7280;\n        font-weight: 600;\n    }\n    \n    .pagination-controls {\n        display: flex;\n        gap: 8px;\n    }\n    \n    .pagination-btn {\n        padding: 6px 12px;\n        background: #1890ff;\n        color: white;\n        border: none;\n        border-radius: 6px;\n        font-size: 11px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .pagination-btn:hover:not(:disabled) {\n        background: #0050b3;\n        transform: translateY(-1px);\n    }\n    \n    .pagination-btn:disabled {\n        background: #e5e7eb;\n        color: #9ca3af;\n        cursor: not-allowed;\n    }\n    \n    .pagination-btn:active:not(:disabled) {\n        transform: translateY(0);\n    }\n    \n    /* Clear filters button */\n    .clear-filters-btn {\n        padding: 8px 16px;\n        background: #ef4444;\n        color: white;\n        border: none;\n        border-radius: 6px;\n        font-size: 11px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n        margin-top: 8px;\n    }\n    \n    .clear-filters-btn:hover {\n        background: #dc2626;\n        transform: translateY(-1px);\n    }\n    \n    .clear-filters-btn:active {\n        transform: translateY(0);\n    }\n    \n    .filters-info {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 8px;\n        padding: 8px;\n        background: #f0f9ff;\n        border: 1px solid #1890ff;\n        border-radius: 6px;\n    }\n    \n    .filters-count {\n        font-size: 11px;\n        color: #0050b3;\n        font-weight: 700;\n    }\n    \n    /* Modal de Detalhes da Sa√≠da */\n    .modal-overlay {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0, 0, 0, 0.7);\n        z-index: 9999;\n        justify-content: center;\n        align-items: center;\n        padding: 20px;\n        animation: fadeIn 0.2s;\n    }\n    \n    .modal-overlay.active {\n        display: flex;\n    }\n    \n    @keyframes fadeIn {\n        from { opacity: 0; }\n        to { opacity: 1; }\n    }\n    \n    .modal-content {\n        background: white;\n        border-radius: 16px;\n        max-width: 1200px;\n        width: 100%;\n        max-height: 90vh;\n        overflow: hidden;\n        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n        display: flex;\n        flex-direction: column;\n        animation: slideUp 0.3s;\n    }\n    \n    @keyframes slideUp {\n        from { transform: translateY(30px); opacity: 0; }\n        to { transform: translateY(0); opacity: 1; }\n    }\n    \n    .modal-header {\n        background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);\n        color: white;\n        padding: 20px 24px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        border-bottom: 3px solid #0050b3;\n    }\n    \n    .modal-title {\n        font-size: 20px;\n        font-weight: 900;\n        display: flex;\n        align-items: center;\n        gap: 10px;\n    }\n    \n    .modal-close {\n        background: rgba(255, 255, 255, 0.2);\n        border: none;\n        color: white;\n        width: 36px;\n        height: 36px;\n        border-radius: 50%;\n        font-size: 24px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s;\n        font-weight: 700;\n    }\n    \n    .modal-close:hover {\n        background: rgba(255, 255, 255, 0.3);\n        transform: rotate(90deg);\n    }\n    \n    .modal-body {\n        padding: 24px;\n        overflow-y: auto;\n        flex: 1;\n    }\n    \n    .modal-info-box {\n        background: #f0f9ff;\n        border: 2px solid #1890ff;\n        border-radius: 12px;\n        padding: 16px;\n        margin-bottom: 20px;\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 12px;\n    }\n    \n    .modal-info-item {\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n    }\n    \n    .modal-info-label {\n        font-size: 10px;\n        font-weight: 700;\n        color: #6b7280;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    .modal-info-value {\n        font-size: 14px;\n        font-weight: 700;\n        color: #1890ff;\n    }\n    \n    .pedidos-list {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n    }\n    \n    .pedido-item {\n        background: white;\n        border: 2px solid #e5e7eb;\n        border-radius: 12px;\n        padding: 16px;\n        transition: all 0.2s;\n    }\n    \n    .pedido-item:hover {\n        border-color: #1890ff;\n        box-shadow: 0 4px 12px rgba(24, 144, 255, 0.15);\n        transform: translateY(-2px);\n    }\n    \n    .pedido-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 12px;\n        padding-bottom: 12px;\n        border-bottom: 2px solid #f3f4f6;\n    }\n    \n    .pedido-numero {\n        font-size: 16px;\n        font-weight: 900;\n        color: #1890ff;\n    }\n    \n    .pedido-badge {\n        padding: 6px 12px;\n        border-radius: 999px;\n        font-size: 10px;\n        font-weight: 800;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    .pedido-badge.dentro {\n        background: #d1fae5;\n        color: #065f46;\n        border: 1px solid #a7f3d0;\n    }\n    \n    .pedido-badge.fora {\n        background: #fee2e2;\n        color: #991b1b;\n        border: 1px solid #fecaca;\n    }\n    \n    .pedido-badge.nao-entregue {\n        background: #fef3c7;\n        color: #92400e;\n        border: 1px solid #fde68a;\n    }\n    \n    .pedido-details {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 12px;\n        font-size: 11px;\n    }\n    \n    .pedido-detail-item {\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n    }\n    \n    .pedido-detail-label {\n        font-size: 9px;\n        font-weight: 700;\n        color: #9ca3af;\n        text-transform: uppercase;\n    }\n    \n    .pedido-detail-value {\n        font-size: 12px;\n        font-weight: 600;\n        color: #111827;\n    }\n    \n    .saidaid-link {\n        cursor: pointer;\n        color: #1890ff;\n        font-weight: 700;\n        text-decoration: underline;\n        transition: all 0.2s;\n    }\n    \n    .saidaid-link:hover {\n        color: #0050b3;\n        text-shadow: 0 0 8px rgba(24, 144, 255, 0.3);\n    }\n</style>\n\n<div class=\"dashboard-container\" id=\"dashboardContainer\">\n    <!-- Filters Info -->\n    <div class=\"filters-info\" id=\"filtersInfo\" style=\"display: none;\">\n        <span class=\"filters-count\" id=\"filtersCount\">Nenhum filtro ativo</span>\n        <button class=\"clear-filters-btn\" onclick=\"clearFilters()\">üóëÔ∏è Limpar Filtros</button>\n    </div>\n    \n    <!-- Filters Row -->\n    <div class=\"filters-row\">\n        <div class=\"filter-group\">\n            <div class=\"filter-label\">ROTA</div>\n            <select class=\"filter-select\" id=\"filterRota\" onchange=\"applyFilters()\">\n                <option value=\"\">Todos</option>\n            </select>\n        </div>\n        <div class=\"filter-group\">\n            <div class=\"filter-label\">CIDADE</div>\n            <select class=\"filter-select\" id=\"filterCidade\" onchange=\"applyFilters()\">\n                <option value=\"\">Todos</option>\n            </select>\n        </div>\n        <div class=\"filter-group\">\n            <div class=\"filter-label\">MOTOBOY</div>\n            <select class=\"filter-select\" id=\"filterMotoboy\" onchange=\"applyFilters()\">\n                <option value=\"\">Todos</option>\n            </select>\n        </div>\n        <div class=\"filter-group\">\n            <div class=\"filter-label\">PER√çODO</div>\n            <select class=\"filter-select\" id=\"filterPeriodo\" onchange=\"applyFilters()\">\n                <option value=\"hoje\">Hoje</option>\n                <option value=\"ontem\" selected>Ontem</option>\n                <option value=\"semana\">Esta Semana</option>\n                <option value=\"mes\">Este M√™s</option>\n            </select>\n        </div>\n        <div class=\"filter-group\">\n            <div class=\"filter-label\">STATUS_FIM_ROTA</div>\n            <select class=\"filter-select\" id=\"filterStatus\" onchange=\"applyFilters()\">\n                <option value=\"\">Todos</option>\n                <option value=\"FINALIZADO\" selected>FINALIZADO</option>\n                <option value=\"EM ANDAMENTO\">EM ANDAMENTO</option>\n                <option value=\"PENDENTE\">PENDENTE</option>\n            </select>\n        </div>\n        <div class=\"filter-group\">\n            <div class=\"filter-label\">ENT_MESMO_DIA</div>\n            <select class=\"filter-select\" id=\"filterMesmoDia\" onchange=\"applyFilters()\">\n                <option value=\"\">Todos</option>\n                <option value=\"SIM\" selected>SIM</option>\n                <option value=\"NAO\">N√ÉO</option>\n            </select>\n        </div>\n        <div class=\"filter-group\">\n            <div class=\"filter-label\">HORA</div>\n            <select class=\"filter-select\" id=\"filterHora\" onchange=\"applyFilters()\">\n                <option value=\"\">Todos</option>\n            </select>\n        </div>\n        <div class=\"filter-group\">\n            <div class=\"filter-label\">DATA</div>\n            <input type=\"date\" class=\"filter-select\" id=\"filterData\" onchange=\"applyFilters()\" \n                   value=\"{{new Date().toISOString().split('T')[0]}}\">\n        </div>\n    </div>\n    \n    <!-- KPIs Row -->\n    <div class=\"kpis-row\">\n        <div class=\"kpi-box\">\n            <div class=\"kpi-value\">{{\n                (()=>{\n                    const d = pedidos_e_saidas_do_dia?.data || [];\n                    return new Set(d.map(x => x.SAIDAID)).size;\n                })()\n            }}</div>\n            <div class=\"kpi-label\">QTY SA√çDAS</div>\n        </div>\n        \n        <div class=\"kpi-box\">\n            <div class=\"kpi-value\">{{(pedidos_e_saidas_do_dia?.data || []).length}}</div>\n            <div class=\"kpi-label\">QTY ENTREGAS</div>\n        </div>\n    </div>\n    \n    <!-- Legends Box -->\n    <div class=\"legends-box\">\n        <div class=\"legend-item\" style=\"background: #e0f2fe; padding: 8px; border-radius: 4px; margin-bottom: 8px; border-left: 3px solid #1890ff;\">\n            <strong>‚ö° C√ÅLCULO PEDIDO A PEDIDO:</strong> 1¬∫ pedido = ENTREGA_CLIENTE - INICIO_ROTA | Demais = ENTREGA_CLIENTE atual - ENTREGA_CLIENTE anterior\n        </div>\n        <div class=\"legend-item\"><strong>PREV.ENTR + 5MIN</strong> - Tempo previsto Google Maps + 5 minutos por pedido (soma sequencial)</div>\n        <div class=\"legend-item\"><strong>TTE</strong> - Tempo total de entrega calculado pedido a pedido (sequencial)</div>\n        <div class=\"legend-item\"><strong>% ENT</strong> - TTE / PREV.ENTR+5MIN (efici√™ncia de entrega)</div>\n        <div class=\"legend-item\"><strong>PREV.RETORN</strong> - Tempo previsto retorno para filial (Google Maps + 1 min)</div>\n        <div class=\"legend-item\"><strong>TEMP.RETORN</strong> - Tempo real de retorno (√∫ltima entrega at√© FIM_ROTA)</div>\n        <div class=\"legend-item\"><strong>% RET</strong> - TEMP.RETORN / PREV.RETORN</div>\n        <div class=\"legend-item\"><strong>% TEMP.ROTA</strong> - TEMP.ROTA / PREV.ROTA (efici√™ncia total da rota)</div>\n        <div class=\"legend-item\" style=\"margin-top:8px;\"><strong>CORES:</strong> üîµ Excelente (<80%) | üü¢ √ìtimo (80-105%) | üü° Aceit√°vel (105-120%) | üî¥ Ruim (120-150%) | ‚ö´ Cr√≠tico (>150%)</div>\n    </div>\n    \n    <!-- Main Table - Por Rota -->\n    <div class=\"section-title\">üìä An√°lise por Rota/Motoboy</div>\n    <div style=\"overflow-x: auto;\">\n        <table id=\"tableRotas\">\n            <thead>\n                <tr>\n                    <th>SAIDAID</th>\n                    <th>MOTOBOY</th>\n                    <th>IN√çCIO ROTA</th>\n                    <th>KM</th>\n                    <th>PARADAS</th>\n                    <th>PREV.ENTR<br>+ 5MIN</th>\n                    <th>TTE</th>\n                    <th>% ENT</th>\n                    <th>PREV.<br>RETORN</th>\n                    <th>TEMP.<br>RETORN</th>\n                    <th>% RET</th>\n                    <th>PREV.<br>ROTA</th>\n                    <th>TEMP.<br>ROTA</th>\n                    <th>% TEMP.<br>ROTA</th>\n                    <th>DIF.TEMP.<br>ROTA</th>\n                    <th>STATUS TEMPO</th>\n                </tr>\n            </thead>\n            <tbody>\n                {{\n                    (()=>{\n                        const d = pedidos_e_saidas_do_dia?.data || [];\n                        const calc = calculo_do_google?.data?.logistica_motoboy || [];\n                        const rotas = dmaplicativo_prod_rotas_otimiz?.data || [];\n                        \n                        // Agrupar por SAIDAID e MOTOBOY (pegar o primeiro motoboy que aparece)\n                        const groupedBySaida = {};\n                        d.forEach(item => {\n                            const saidaId = item.SAIDAID;\n                            if (!groupedBySaida[saidaId]) {\n                                groupedBySaida[saidaId] = {\n                                    SAIDAID: saidaId,\n                                    MOTOBOY: item.MOTOBOY, // Motoboy dos PEDIDOS, n√£o da rota otimizada\n                                    CODIGO_MOTORISTA: item.RCA, // C√≥digo do motorista\n                                    INICIO_ROTA: item.INICIO_ROTA,\n                                    items: [],\n                                    totalKM: 0,\n                                    paradas: 0,\n                                    clientesUnicos: new Set()\n                                };\n                            }\n                            groupedBySaida[saidaId].items.push(item);\n                            groupedBySaida[saidaId].paradas++;\n                            groupedBySaida[saidaId].clientesUnicos.add(item.COD_CLI);\n                        });\n                        \n                        // Fun√ß√£o para converter segundos para formato D.HH:MM:SS\n                        const formatarTempo = (segundos) => {\n                            if (!segundos || segundos < 0) segundos = 0;\n                            const dias = Math.floor(segundos / 86400);\n                            const resto = segundos % 86400;\n                            const horas = Math.floor(resto / 3600);\n                            const minutos = Math.floor((resto % 3600) / 60);\n                            const segs = Math.floor(resto % 60);\n                            return dias + '.' + \n                                   String(horas).padStart(2, '0') + ':' + \n                                   String(minutos).padStart(2, '0') + ':' + \n                                   String(segs).padStart(2, '0');\n                        };\n                        \n                        // REGRAS DE COLORA√á√ÉO (baseadas na imagem):\n                        // >= 0 e < 0.8 = Azul\n                        // >= 0.8 e <= 1.05 = Verde\n                        // > 1.05 e <= 1.2 = Amarelo\n                        // > 1.2 e <= 1.5 = Vermelho\n                        // > 1.5 (ou \"Infinito\") = Preto\n                        const getColorClass = (valor) => {\n                            if (valor === null || valor === undefined || isNaN(valor)) return '';\n                            const v = parseFloat(valor);\n                            \n                            if (v >= 0 && v < 0.8) return 'cell-blue';       // Azul\n                            if (v >= 0.8 && v <= 1.05) return 'cell-green';  // Verde\n                            if (v > 1.05 && v <= 1.2) return 'cell-yellow';  // Amarelo\n                            if (v > 1.2 && v <= 1.5) return 'cell-red';      // Vermelho\n                            if (v > 1.5) return 'cell-black';                // Preto (Infinito)\n                            \n                            return '';\n                        };\n                        \n                        // Calcular m√©tricas por rota\n                        const allRotas = Object.values(groupedBySaida);\n                        console.log('=== DETALHES M - AN√ÅLISE PEDIDO A PEDIDO ===');\n                        console.log(`üèóÔ∏è Gerando ${allRotas.length} linhas de Rotas`);\n                        \n                        // Debug: Ver totais de classifica√ß√£o\n                        let totalDentroGeral = 0;\n                        let totalForaGeral = 0;\n                        let totalNaoEntregueGeral = 0;\n                        \n                        const rows = allRotas.map((rota, rowIndex) => {\n                            // Buscar dados da rota otimizada (pegar o √∫ltimo registro = maior num_ordem)\n                            const rotaOtimizada = rotas.filter(r => r.saida_numero === rota.SAIDAID)\n                                .sort((a, b) => b.num_ordem - a.num_ordem); // Ordenar do maior para o menor\n                            \n                            // Usar dados da rota otimizada (√∫ltimo ponto = maior num_ordem)\n                            const ultimoPonto = rotaOtimizada[0];\n                            \n                            // KM total = distancia_total_rota_metros / 1000\n                            let totalKM = ultimoPonto?.distancia_total_rota_metros ? \n                                (ultimoPonto.distancia_total_rota_metros / 1000) : 0;\n                            \n                            // Tempo previsto = duracao_total_rota_seg (j√° inclui ida + volta + paradas)\n                            let duracaoTotalRotaSeg = ultimoPonto?.duracao_total_rota_seg || 0;\n                            \n                            // Se n√£o tem rota otimizada, calcular manualmente\n                            if (totalKM === 0 || duracaoTotalRotaSeg === 0) {\n                                rota.items.forEach(item => {\n                                    const log = calc.find(l => l.PEDIDO === item.PEDIDO || l.SAIDAID === parseInt(item.SAIDAID));\n                                    if (log) {\n                                        totalKM += parseFloat(log.KM || 0);\n                                        const tempoMin = parseInt(log.TEMPO || 0);\n                                        duracaoTotalRotaSeg += tempoMin * 60;\n                                    }\n                                });\n                            }\n                            \n                            rota.totalKM = totalKM;\n                            \n                            // =====================================\n                            // C√ÅLCULOS COM NOVA L√ìGICA PEDIDO A PEDIDO (Google Maps + 5min)\n                            // =====================================\n                            \n                            const qtdClientesUnicos = rota.clientesUnicos.size;\n                            \n                            // Ordenar pedidos por ENTREGA_CLIENTE para an√°lise sequencial\n                            const pedidosOrdenados = [...rota.items].sort((a, b) => {\n                                if (!a.ENTREGA_CLIENTE) return 1;\n                                if (!b.ENTREGA_CLIENTE) return -1;\n                                return new Date(a.ENTREGA_CLIENTE) - new Date(b.ENTREGA_CLIENTE);\n                            });\n                            \n                            // PREV.ENTR + 5MIN e TTE calculados PEDIDO A PEDIDO\n                            let prevEntrMais5Min = 0;\n                            let tteSegundos = 0;\n                            let dentroCount = 0;\n                            let foraCount = 0;\n                            let naoEntregueCount = 0;\n                            \n                            pedidosOrdenados.forEach((item, index) => {\n                                // Buscar Google\n                                const log = calc.find(l => l.PEDIDO == item.PEDIDO);\n                                \n                                // Se n√£o tem Google = N√£o Entregue\n                                if (!log) {\n                                    naoEntregueCount++;\n                                    return;\n                                }\n                                \n                                // Tempo Google + 5min\n                                const tempoGoogle = Number((log.TEMPO || \"0\").toString().replace(/\\D+/g, '')) + 5;\n                                prevEntrMais5Min += tempoGoogle * 60; // em segundos\n                                \n                                // Calcular tempo local SEQUENCIAL\n                                let tempoLocalMin = 0;\n                                if (item.ENTREGA_CLIENTE && item.INICIO_ROTA) {\n                                    if (index === 0) {\n                                        // 1¬∫ pedido: ENTREGA_CLIENTE - INICIO_ROTA\n                                        tempoLocalMin = (new Date(item.ENTREGA_CLIENTE) - new Date(item.INICIO_ROTA)) / 60000;\n                                    } else {\n                                        // Pedidos seguintes: ENTREGA_CLIENTE atual - ENTREGA_CLIENTE anterior\n                                        const anterior = pedidosOrdenados[index - 1];\n                                        if (anterior.ENTREGA_CLIENTE) {\n                                            tempoLocalMin = (new Date(item.ENTREGA_CLIENTE) - new Date(anterior.ENTREGA_CLIENTE)) / 60000;\n                                        }\n                                    }\n                                    tteSegundos += tempoLocalMin * 60; // converter para segundos\n                                }\n                                \n                                // Classificar pedido\n                                if (tempoLocalMin > 0 && tempoGoogle > 0) {\n                                    if (tempoLocalMin <= tempoGoogle) {\n                                        dentroCount++;\n                                    } else {\n                                        foraCount++;\n                                    }\n                                } else {\n                                    naoEntregueCount++;\n                                }\n                            });\n                            \n                            // % ENT = TTE / PREV.ENTR+5MIN\n                            const percEnt = prevEntrMais5Min > 0 ? \n                                (tteSegundos / prevEntrMais5Min) : 0;\n                            \n                            // Coletar datas de entrega para c√°lculo de retorno\n                            const datasEntrega = rota.items\n                                .map(item => item.ENTREGA_CLIENTE)\n                                .filter(d => d && d !== 'null' && d !== null)\n                                .map(d => new Date(d));\n                            \n                            // PREV.RETORN = Buscar tempo de retorno no Google + 1min\n                            let prevRetornoSegundos = 0;\n                            rota.items.forEach(item => {\n                                const log = calc.find(l => l.PEDIDO === item.PEDIDO);\n                                if (log && log.RETORNO) {\n                                    const tempoRetornoGoogle = Number((log.RETORNO || \"0\").toString().replace(/\\D+/g, ''));\n                                    if (tempoRetornoGoogle > 0) {\n                                        prevRetornoSegundos = (tempoRetornoGoogle + 1) * 60; // +1min para retornos\n                                    }\n                                }\n                            });\n                            \n                            // TEMP.RETORN = tempo real de retorno (√∫ltima entrega at√© fim da rota)\n                            const datasFim = rota.items\n                                .map(item => item.FIM_ROTA)\n                                .filter(d => d && d !== 'null' && d !== null)\n                                .map(d => new Date(d));\n                            \n                            let tempRetornoSegundos = 0;\n                            if (datasEntrega.length > 0 && datasFim.length > 0) {\n                                const ultimaEntrega = new Date(Math.max(...datasEntrega));\n                                const fimRota = new Date(Math.max(...datasFim));\n                                tempRetornoSegundos = Math.max(0, Math.floor((fimRota - ultimaEntrega) / 1000));\n                            }\n                            \n                            // % RET = TEMP.RETORN / PREV.RETORN\n                            const percRet = prevRetornoSegundos > 0 ? \n                                (tempRetornoSegundos / prevRetornoSegundos) : 0;\n                            \n                            // PREV.ROTA = PREV.ENTR+5MIN + PREV.RETORN\n                            const prevRotaSegundos = prevEntrMais5Min + prevRetornoSegundos;\n                            \n                            // TEMP.ROTA = TTE + TEMP.RETORN\n                            const tempRotaSegundos = tteSegundos + tempRetornoSegundos;\n                            \n                            // % TEMP.ROTA = TEMP.ROTA / PREV.ROTA\n                            const percTempRota = prevRotaSegundos > 0 ? \n                                (tempRotaSegundos / prevRotaSegundos) : 0;\n                            \n                            // DIF.TEMP.ROTA = TEMP.ROTA - PREV.ROTA\n                            const difTempRotaSegundos = tempRotaSegundos - prevRotaSegundos;\n                            \n                            const statusClass = percTempRota <= 1 ? 'status-ok' : 'status-warning';\n                            const statusText = percTempRota <= 1 ? 'Abaixo do previsto' : 'Acima do previsto';\n                            \n                            // IN√çCIO ROTA = updated_at da rota otimizada (priorit√°rio)\n                            const rotaData = rotaOtimizada[0];\n                            const inicioRotaData = rotaData?.updated_at || rota.INICIO_ROTA;\n                            const inicioRota = inicioRotaData ? new Date(inicioRotaData).toLocaleString('pt-BR', {\n                                day: '2-digit',\n                                month: '2-digit',\n                                year: 'numeric',\n                                hour: '2-digit',\n                                minute: '2-digit',\n                                second: '2-digit',\n                                timeZone: 'America/Sao_Paulo'\n                            }).replace(',', '') : '--';\n                            \n                            // Acumular totais gerais\n                            totalDentroGeral += dentroCount;\n                            totalForaGeral += foraCount;\n                            totalNaoEntregueGeral += naoEntregueCount;\n                            \n                            // Formatar percentuais\n                            const formatPerc = (val) => {\n                                if (val > 10) return 'Infinito';\n                                return (val * 100).toFixed(2) + '%';\n                            };\n                            \n                            return `<tr data-saidaid=\"${rota.SAIDAID}\" data-row-index=\"${rowIndex}\">\n                                <td class=\"text-bold text-center\">\n                                    <span class=\"saidaid-link\" data-saidaid=\"${rota.SAIDAID}\">${rota.SAIDAID}</span>\n                                </td>\n                                <td>${(rota.MOTOBOY || '').trim()}</td>\n                                <td class=\"text-muted\">${inicioRota}</td>\n                                <td class=\"text-center\">${totalKM.toFixed(2)}</td>\n                                <td class=\"text-center\">${rota.paradas}</td>\n                                <td class=\"text-center\">${formatarTempo(prevEntrMais5Min)}</td>\n                                <td class=\"text-center\">${formatarTempo(tteSegundos)}</td>\n                                <td class=\"text-center ${getColorClass(percEnt)}\">${formatPerc(percEnt)}</td>\n                                <td class=\"text-center\">${formatarTempo(prevRetornoSegundos)}</td>\n                                <td class=\"text-center\">${formatarTempo(tempRetornoSegundos)}</td>\n                                <td class=\"text-center ${getColorClass(percRet)}\">${formatPerc(percRet)}</td>\n                                <td class=\"text-center\">${formatarTempo(prevRotaSegundos)}</td>\n                                <td class=\"text-center\">${formatarTempo(tempRotaSegundos)}</td>\n                                <td class=\"text-center ${getColorClass(percTempRota)}\">${formatPerc(percTempRota)}</td>\n                                <td class=\"text-center\">${difTempRotaSegundos >= 0 ? '+' : ''}${formatarTempo(Math.abs(difTempRotaSegundos))}</td>\n                                <td class=\"${statusClass}\">${statusText}</td>\n                            </tr>`;\n                        }).join('');\n                        \n                        // Mostrar totais no console\n                        const totalPedidosGeral = totalDentroGeral + totalForaGeral + totalNaoEntregueGeral;\n                        console.log('üìä TOTAIS GERAIS (deve bater com TOTAL ENTREGAS RESUMO):');\n                        console.log('  ‚úÖ Dentro do Prazo:', totalDentroGeral, `(${((totalDentroGeral / totalPedidosGeral) * 100).toFixed(2)}%)`);\n                        console.log('  ‚ùå Fora do Prazo:', totalForaGeral, `(${((totalForaGeral / totalPedidosGeral) * 100).toFixed(2)}%)`);\n                        console.log('  üü† N√£o Entregue:', totalNaoEntregueGeral, `(${((totalNaoEntregueGeral / totalPedidosGeral) * 100).toFixed(2)}%)`);\n                        console.log('  üì¶ Total de Pedidos:', totalPedidosGeral);\n                        console.log('  ‚úîÔ∏è Soma:', totalDentroGeral + totalForaGeral + totalNaoEntregueGeral, '(deve ser igual ao total)');\n                        \n                        return rows || `<tr><td colspan=\"16\" class=\"text-center text-muted\">Sem dados dispon√≠veis</td></tr>`;\n                    })()\n                }}\n            </tbody>\n        </table>\n        \n        <!-- Pagination for Rotas -->\n        <div class=\"pagination-container\">\n            <div class=\"pagination-info\" id=\"paginationInfoRotas\">\n                Mostrando 0 de 0 registros\n            </div>\n            <div class=\"pagination-controls\">\n                <button class=\"pagination-btn\" id=\"btnPrevRotas\" onclick=\"previousPageRotas()\" disabled>\n                    ‚Üê Anterior\n                </button>\n                <button class=\"pagination-btn\" id=\"btnNextRotas\" onclick=\"nextPageRotas()\" disabled>\n                    Pr√≥ximo ‚Üí\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Secondary Table - Por Cliente -->\n    <div class=\"section-title\">üì¶ Detalhamento por Entrega/Cliente</div>\n    <div style=\"background: #fef3c7; padding: 8px; border-radius: 4px; margin-bottom: 12px; border-left: 3px solid #f59e0b; font-size: 10px;\">\n        <strong>üí° Tempo calculado sequencialmente:</strong> Cada pedido mostra o tempo desde o pedido anterior (ou desde INICIO_ROTA se for o 1¬∫)\n    </div>\n    <div style=\"overflow-x: auto;\">\n        <table id=\"tableClientes\">\n            <thead>\n                <tr>\n                    <th>COD.CLI</th>\n                    <th>PARADAS</th>\n                    <th>PEDIDO</th>\n                    <th>MOTOBOY</th>\n                    <th>ROTA</th>\n                    <th>PED.DISPON√çVEL</th>\n                    <th>DISP.SAIDA</th>\n                    <th>IN√çCIO ROTA</th>\n                    <th>SAID.ENTR</th>\n                    <th>ENTREGA CLIENTE</th>\n                    <th>KM</th>\n                    <th>PREV.ENTR<br>+ 5MIN</th>\n                    <th>TEMP ENT</th>\n                    <th>% TEMPO ENT</th>\n                    <th>FIM ROTA</th>\n                    <th>TEMP.ROTA</th>\n                </tr>\n            </thead>\n            <tbody>\n                {{\n                    (()=>{\n                        const d = pedidos_e_saidas_do_dia?.data || [];\n                        const calc = calculo_do_google?.data?.logistica_motoboy || [];\n                        const rotas = dmaplicativo_prod_rotas_otimiz?.data || [];\n                        \n                        const formatarTempo = (segundos) => {\n                            if (!segundos || segundos < 0) segundos = 0;\n                            const dias = Math.floor(segundos / 86400);\n                            const resto = segundos % 86400;\n                            const horas = Math.floor(resto / 3600);\n                            const minutos = Math.floor((resto % 3600) / 60);\n                            const segs = Math.floor(resto % 60);\n                            return dias + '.' + \n                                   String(horas).padStart(2, '0') + ':' + \n                                   String(minutos).padStart(2, '0') + ':' + \n                                   String(segs).padStart(2, '0');\n                        };\n                        \n                        const getColorClass = (valor) => {\n                            if (valor === null || valor === undefined || isNaN(valor)) return '';\n                            const v = parseFloat(valor);\n                            \n                            if (v >= 0 && v < 0.8) return 'cell-blue';\n                            if (v >= 0.8 && v <= 1.05) return 'cell-green';\n                            if (v > 1.05 && v <= 1.2) return 'cell-yellow';\n                            if (v > 1.2 && v <= 1.5) return 'cell-red';\n                            if (v > 1.5) return 'cell-black';\n                            \n                            return '';\n                        };\n                        \n                            // Agrupar por SAIDAID para c√°lculo sequencial\n                        const groupedBySaidaClientes = {};\n                        d.forEach(item => {\n                            const saidaId = item.SAIDAID;\n                            if (!groupedBySaidaClientes[saidaId]) {\n                                groupedBySaidaClientes[saidaId] = [];\n                            }\n                            groupedBySaidaClientes[saidaId].push(item);\n                        });\n                        \n                        // Ordenar cada sa√≠da por ENTREGA_CLIENTE\n                        Object.keys(groupedBySaidaClientes).forEach(saidaId => {\n                            groupedBySaidaClientes[saidaId].sort((a, b) => {\n                                return new Date(a.ENTREGA_CLIENTE) - new Date(b.ENTREGA_CLIENTE);\n                            });\n                        });\n                        \n                        const rows = d.map((delivery, idx) => {\n                            const log = calc.find(l => l.PEDIDO === delivery.PEDIDO || l.SAIDAID === parseInt(delivery.SAIDAID));\n                            const rotaOpt = rotas.find(r => r.pedido_numero === delivery.PEDIDO);\n                            \n                            // Tempo previsto (Google Maps + 5min)\n                            const tempoGoogle = log ? Number((log.TEMPO || \"0\").toString().replace(/\\D+/g, '')) : 0;\n                            const tempoPrevSegundos = (tempoGoogle + 5) * 60; // +5min e converter para segundos\n                            \n                            // Tempo real SEQUENCIAL (pedido a pedido)\n                            let tempoRealSegundos = 0;\n                            const pedidosDaSaida = groupedBySaidaClientes[delivery.SAIDAID] || [];\n                            const indexNaSaida = pedidosDaSaida.findIndex(p => p.PEDIDO === delivery.PEDIDO);\n                            \n                            if (delivery.ENTREGA_CLIENTE && delivery.INICIO_ROTA && indexNaSaida >= 0) {\n                                if (indexNaSaida === 0) {\n                                    // 1¬∫ pedido: ENTREGA_CLIENTE - INICIO_ROTA\n                                    const entrega = new Date(delivery.ENTREGA_CLIENTE);\n                                    const inicio = new Date(delivery.INICIO_ROTA);\n                                    tempoRealSegundos = Math.floor((entrega - inicio) / 1000);\n                                } else {\n                                    // Pedidos seguintes: ENTREGA_CLIENTE atual - ENTREGA_CLIENTE anterior\n                                    const pedidoAnterior = pedidosDaSaida[indexNaSaida - 1];\n                                    if (pedidoAnterior.ENTREGA_CLIENTE) {\n                                        const entregaAtual = new Date(delivery.ENTREGA_CLIENTE);\n                                        const entregaAnterior = new Date(pedidoAnterior.ENTREGA_CLIENTE);\n                                        tempoRealSegundos = Math.floor((entregaAtual - entregaAnterior) / 1000);\n                                    }\n                                }\n                            }\n                            \n                            // % TEMPO ENT\n                            const percTempoEnt = tempoPrevSegundos > 0 ? \n                                (tempoRealSegundos / tempoPrevSegundos) : 0;\n                            \n                            const formatData = (dataStr) => {\n                                if (!dataStr || dataStr === 'null') return '--';\n                                return new Date(dataStr).toLocaleString('pt-BR', {\n                                    day: '2-digit',\n                                    month: '2-digit',\n                                    year: 'numeric',\n                                    hour: '2-digit',\n                                    minute: '2-digit',\n                                    second: '2-digit',\n                                    timeZone: 'America/Sao_Paulo'\n                                }).replace(',', '');\n                            };\n                            \n                            const km = rotaOpt ? (rotaOpt.metros_ate_o_ponto / 1000).toFixed(2) : \n                                (log?.KM || '--');\n                            \n                            const formatPerc = (val) => {\n                                if (val > 10) return 'Infinito';\n                                return (val * 100).toFixed(2) + '%';\n                            };\n                            \n                            // IN√çCIO ROTA = data_criacao_rota, FIM ROTA = updated_at\n                            const inicioRotaData = rotaOpt?.data_criacao_rota || delivery.INICIO_ROTA;\n                            const fimRotaData = rotaOpt?.updated_at || delivery.FIM_ROTA;\n                            const horaSaidaFilial = rotaOpt?.hora_saida_filial;\n                            \n                            return `<tr data-row-index=\"${idx}\">\n                                <td class=\"text-bold text-center\">${delivery.COD_CLI || '--'}</td>\n                                <td class=\"text-center\">1</td>\n                                <td class=\"text-bold text-center\">${delivery.PEDIDO}</td>\n                                <td>${(delivery.MOTOBOY || '').trim() || '--'}</td>\n                                <td class=\"text-muted\">${delivery.CIDADEFILIAL || '--'}</td>\n                                <td class=\"text-muted\" style=\"font-size:9px;\">${formatData(inicioRotaData)}</td>\n                                <td class=\"text-muted\" style=\"font-size:9px;\">${formatData(horaSaidaFilial)}</td>\n                                <td class=\"text-muted\" style=\"font-size:9px;\">${formatData(inicioRotaData)}</td>\n                                <td class=\"text-muted\" style=\"font-size:9px;\">--</td>\n                                <td class=\"text-muted\" style=\"font-size:9px;\">${formatData(delivery.ENTREGA_CLIENTE)}</td>\n                                <td class=\"text-center\">${km}</td>\n                                <td class=\"text-center\">${formatarTempo(tempoPrevSegundos)}</td>\n                                <td class=\"text-center\">${formatarTempo(tempoRealSegundos)}</td>\n                                <td class=\"text-center ${getColorClass(percTempoEnt)}\">${formatPerc(percTempoEnt)}</td>\n                                <td class=\"text-muted\" style=\"font-size:9px;\">${formatData(fimRotaData)}</td>\n                                <td class=\"text-center\">${formatarTempo(tempoRealSegundos)}</td>\n                            </tr>`;\n                        }).join('');\n                        \n                        return rows || `<tr><td colspan=\"16\" class=\"text-center text-muted\">Sem dados dispon√≠veis</td></tr>`;\n                    })()\n                }}\n            </tbody>\n        </table>\n        \n        <!-- Pagination for Clientes -->\n        <div class=\"pagination-container\">\n            <div class=\"pagination-info\" id=\"paginationInfoClientes\">\n                Mostrando 0 de 0 registros\n            </div>\n            <div class=\"pagination-controls\">\n                <button class=\"pagination-btn\" id=\"btnPrevClientes\" onclick=\"previousPageClientes()\" disabled>\n                    ‚Üê Anterior\n                </button>\n                <button class=\"pagination-btn\" id=\"btnNextClientes\" onclick=\"nextPageClientes()\" disabled>\n                    Pr√≥ximo ‚Üí\n                </button>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Modal de Detalhes da Sa√≠da -->\n<div class=\"modal-overlay\" id=\"saidaModal\" onclick=\"if(event.target === this) fecharModalSaida()\">\n    <div class=\"modal-content\">\n        <div class=\"modal-header\">\n            <div class=\"modal-title\">\n                üöö <span id=\"modalSaidaTitulo\">Detalhes da Sa√≠da</span>\n            </div>\n            <button class=\"modal-close\" onclick=\"fecharModalSaida()\">√ó</button>\n        </div>\n        <div class=\"modal-body\" id=\"modalSaidaBody\">\n            <!-- Conte√∫do ser√° preenchido dinamicamente -->\n        </div>\n    </div>\n</div>\n\n<script>\n// Dados globais\nlet allRotasData = [];\nlet allClientesData = [];\nlet globalPedidosData = [];\nlet globalCalcData = [];\nlet globalRotasData = [];\nlet currentPageRotas = 1;\nlet currentPageClientes = 1;\nconst itemsPerPage = 10;\n\n// Pagina√ß√£o para Rotas\nfunction updatePaginationRotas() {\n    const totalPages = Math.ceil(allRotasData.length / itemsPerPage);\n    const start = (currentPageRotas - 1) * itemsPerPage + 1;\n    const end = Math.min(currentPageRotas * itemsPerPage, allRotasData.length);\n    \n    document.getElementById('paginationInfoRotas').textContent = \n        `Mostrando ${start}-${end} de ${allRotasData.length} registros (P√°gina ${currentPageRotas}/${totalPages || 1})`;\n    \n    document.getElementById('btnPrevRotas').disabled = currentPageRotas === 1;\n    document.getElementById('btnNextRotas').disabled = currentPageRotas >= totalPages;\n    \n    renderTableRotas();\n}\n\nfunction renderTableRotas() {\n    const tbody = document.querySelector('#tableRotas tbody');\n    if (!tbody) return;\n    \n    const allRows = tbody.querySelectorAll('tr');\n    \n    // Primeiro, ocultar TODAS as linhas\n    allRows.forEach(row => {\n        row.style.display = 'none';\n    });\n    \n    // Calcular quais √≠ndices da lista filtrada mostrar\n    const start = (currentPageRotas - 1) * itemsPerPage;\n    const end = start + itemsPerPage;\n    \n    // Mostrar apenas as linhas da p√°gina atual (usando √≠ndices de allRotasData)\n    const pageItems = allRotasData.slice(start, end);\n    pageItems.forEach(rowIndex => {\n        if (allRows[rowIndex]) {\n            allRows[rowIndex].style.display = '';\n        }\n    });\n    \n    console.log(`üìÑ P√°g ${currentPageRotas}: Mostrando ${pageItems.length} linhas de ${allRotasData.length} total`);\n}\n\nfunction nextPageRotas() {\n    const totalPages = Math.ceil(allRotasData.length / itemsPerPage);\n    if (currentPageRotas < totalPages) {\n        currentPageRotas++;\n        updatePaginationRotas();\n        attachSaidaIdListeners();\n    }\n}\n\nfunction previousPageRotas() {\n    if (currentPageRotas > 1) {\n        currentPageRotas--;\n        updatePaginationRotas();\n        attachSaidaIdListeners();\n    }\n}\n\n// Pagina√ß√£o para Clientes\nfunction updatePaginationClientes() {\n    const totalPages = Math.ceil(allClientesData.length / itemsPerPage);\n    const start = (currentPageClientes - 1) * itemsPerPage + 1;\n    const end = Math.min(currentPageClientes * itemsPerPage, allClientesData.length);\n    \n    document.getElementById('paginationInfoClientes').textContent = \n        `Mostrando ${start}-${end} de ${allClientesData.length} registros (P√°gina ${currentPageClientes}/${totalPages || 1})`;\n    \n    document.getElementById('btnPrevClientes').disabled = currentPageClientes === 1;\n    document.getElementById('btnNextClientes').disabled = currentPageClientes >= totalPages;\n    \n    renderTableClientes();\n}\n\nfunction renderTableClientes() {\n    const tbody = document.querySelector('#tableClientes tbody');\n    if (!tbody) return;\n    \n    const allRows = tbody.querySelectorAll('tr');\n    \n    // Primeiro, ocultar TODAS as linhas\n    allRows.forEach(row => {\n        row.style.display = 'none';\n    });\n    \n    // Calcular quais √≠ndices da lista filtrada mostrar\n    const start = (currentPageClientes - 1) * itemsPerPage;\n    const end = start + itemsPerPage;\n    \n    // Mostrar apenas as linhas da p√°gina atual (usando √≠ndices de allClientesData)\n    const pageItems = allClientesData.slice(start, end);\n    pageItems.forEach(rowIndex => {\n        if (allRows[rowIndex]) {\n            allRows[rowIndex].style.display = '';\n        }\n    });\n    \n    console.log(`üì¶ P√°g ${currentPageClientes}: Mostrando ${pageItems.length} linhas de ${allClientesData.length} total`);\n}\n\nfunction nextPageClientes() {\n    const totalPages = Math.ceil(allClientesData.length / itemsPerPage);\n    if (currentPageClientes < totalPages) {\n        currentPageClientes++;\n        updatePaginationClientes();\n    }\n}\n\nfunction previousPageClientes() {\n    if (currentPageClientes > 1) {\n        currentPageClientes--;\n        updatePaginationClientes();\n    }\n}\n\n// Fun√ß√£o para popular os filtros dinamicamente\nfunction populateFilters() {\n    const rotas = new Set();\n    const cidades = new Set();\n    const motoboys = new Set();\n    const horas = new Set();\n    \n    // Extrair valores √∫nicos das tabelas\n    document.querySelectorAll('#tableRotas tbody tr').forEach(row => {\n        const cells = row.cells;\n        if (cells.length > 0) {\n            rotas.add(cells[0].textContent.trim());\n            motoboys.add(cells[1].textContent.trim());\n        }\n    });\n    \n    document.querySelectorAll('#tableClientes tbody tr').forEach(row => {\n        const cells = row.cells;\n        if (cells.length > 0) {\n            // √çndice 3 = MOTOBOY, √çndice 4 = ROTA\n            const motoboy = cells[3]?.textContent.trim();\n            const rota = cells[4]?.textContent.trim();\n            if (motoboy) motoboys.add(motoboy);\n            if (rota) cidades.add(rota);\n        }\n    });\n    \n    // Popular os selects\n    const rotaSelect = document.getElementById('filterRota');\n    const cidadeSelect = document.getElementById('filterCidade');\n    const motoboySelect = document.getElementById('filterMotoboy');\n    const horaSelect = document.getElementById('filterHora');\n    \n    [...rotas].sort().forEach(rota => {\n        if (rota && rota !== '--') {\n            const option = document.createElement('option');\n            option.value = rota;\n            option.textContent = rota;\n            rotaSelect.appendChild(option);\n        }\n    });\n    \n    [...cidades].sort().forEach(cidade => {\n        if (cidade && cidade !== '--') {\n            const option = document.createElement('option');\n            option.value = cidade;\n            option.textContent = cidade;\n            cidadeSelect.appendChild(option);\n        }\n    });\n    \n    [...motoboys].sort().forEach(motoboy => {\n        if (motoboy && motoboy !== '--') {\n            const option = document.createElement('option');\n            option.value = motoboy;\n            option.textContent = motoboy;\n            motoboySelect.appendChild(option);\n        }\n    });\n    \n    // Popular horas (00:00 at√© 23:00)\n    for (let i = 0; i < 24; i++) {\n        const hora = String(i).padStart(2, '0') + ':00';\n        const option = document.createElement('option');\n        option.value = hora;\n        option.textContent = hora;\n        horaSelect.appendChild(option);\n    }\n}\n\n// Fun√ß√£o para contar e exibir filtros ativos\nfunction updateFiltersInfo() {\n    let activeFilters = 0;\n    let filtersList = [];\n    \n    const filterRota = document.getElementById('filterRota').value;\n    const filterCidade = document.getElementById('filterCidade').value;\n    const filterMotoboy = document.getElementById('filterMotoboy').value;\n    const filterStatus = document.getElementById('filterStatus').value;\n    const filterMesmoDia = document.getElementById('filterMesmoDia').value;\n    const filterHora = document.getElementById('filterHora').value;\n    const filterData = document.getElementById('filterData').value;\n    \n    if (filterRota) { activeFilters++; filtersList.push(`Rota: ${filterRota}`); }\n    if (filterCidade) { activeFilters++; filtersList.push(`Cidade: ${filterCidade}`); }\n    if (filterMotoboy) { activeFilters++; filtersList.push(`Motoboy: ${filterMotoboy}`); }\n    if (filterStatus) { activeFilters++; filtersList.push(`Status: ${filterStatus}`); }\n    if (filterMesmoDia) { activeFilters++; filtersList.push(`Mesmo Dia: ${filterMesmoDia}`); }\n    if (filterHora) { activeFilters++; filtersList.push(`Hora: ${filterHora}`); }\n    if (filterData) { activeFilters++; filtersList.push(`Data: ${filterData}`); }\n    \n    const filtersInfo = document.getElementById('filtersInfo');\n    const filtersCount = document.getElementById('filtersCount');\n    \n    if (activeFilters > 0) {\n        filtersInfo.style.display = 'flex';\n        filtersCount.textContent = `${activeFilters} filtro(s) ativo(s): ${filtersList.join(' | ')}`;\n    } else {\n        filtersInfo.style.display = 'none';\n    }\n}\n\n// Fun√ß√£o para limpar todos os filtros\nfunction clearFilters() {\n    document.getElementById('filterRota').value = '';\n    document.getElementById('filterCidade').value = '';\n    document.getElementById('filterMotoboy').value = '';\n    document.getElementById('filterStatus').value = '';\n    document.getElementById('filterMesmoDia').value = '';\n    document.getElementById('filterHora').value = '';\n    document.getElementById('filterData').value = new Date().toISOString().split('T')[0];\n    \n    applyFilters();\n}\n\n// Fun√ß√£o para aplicar filtros\nfunction applyFilters() {\n    const filterRota = document.getElementById('filterRota').value.toLowerCase();\n    const filterCidade = document.getElementById('filterCidade').value.toLowerCase();\n    const filterMotoboy = document.getElementById('filterMotoboy').value.toLowerCase();\n    const filterStatus = document.getElementById('filterStatus').value.toLowerCase();\n    const filterMesmoDia = document.getElementById('filterMesmoDia').value.toLowerCase();\n    const filterHora = document.getElementById('filterHora').value;\n    const filterData = document.getElementById('filterData').value;\n    \n    // Atualizar informa√ß√µes dos filtros\n    updateFiltersInfo();\n    \n    // Filtrar Tabela de Rotas\n    const rotasRows = document.querySelectorAll('#tableRotas tbody tr');\n    allRotasData = [];\n    \n    rotasRows.forEach((row, index) => {\n        const cells = row.cells;\n        if (cells.length === 0 || cells.length < 2) return;\n        \n        // Verificar se √© uma linha de \"Sem dados\"\n        if (cells[0].textContent.includes('Sem dados')) return;\n        \n        const saidaId = cells[0]?.textContent.trim().toLowerCase() || '';\n        const motoboy = cells[1]?.textContent.trim().toLowerCase() || '';\n        const inicioRota = cells[2]?.textContent.trim() || '';\n        const statusTempo = cells[15]?.textContent.trim().toLowerCase() || '';\n        \n        let showRow = true;\n        \n        // Filtro por ROTA (SAIDAID)\n        if (filterRota && !saidaId.includes(filterRota)) {\n            showRow = false;\n        }\n        \n        // Filtro por MOTOBOY\n        if (filterMotoboy && !motoboy.includes(filterMotoboy)) {\n            showRow = false;\n        }\n        \n        // Filtro por STATUS (baseado no STATUS TEMPO - √∫ltima coluna)\n        if (filterStatus) {\n            if (filterStatus === 'finalizado' && !statusTempo.includes('previsto')) {\n                showRow = false;\n            }\n        }\n        \n        // Filtro por HORA (extrair hora do IN√çCIO ROTA)\n        if (filterHora && inicioRota) {\n            // Formato esperado: \"DD/MM/YYYY HH:MM:SS\"\n            const horaMatch = inicioRota.match(/\\d{2}:\\d{2}:\\d{2}/);\n            if (horaMatch) {\n                const hora = horaMatch[0].substring(0, 5); // Pegar HH:MM\n                if (!hora.startsWith(filterHora.substring(0, 2))) {\n                    showRow = false;\n                }\n            }\n        }\n        \n        // Filtro por DATA (extrair data do IN√çCIO ROTA)\n        if (filterData && inicioRota) {\n            // Formato esperado: \"DD/MM/YYYY HH:MM:SS\"\n            const dataMatch = inicioRota.match(/(\\d{2})\\/(\\d{2})\\/(\\d{4})/);\n            if (dataMatch) {\n                const [_, dia, mes, ano] = dataMatch;\n                const dataRow = `${ano}-${mes}-${dia}`;\n                if (dataRow !== filterData) {\n                    showRow = false;\n                }\n            }\n        }\n        \n        if (showRow) {\n            allRotasData.push(index);\n        }\n    });\n    \n    // Filtrar Tabela de Clientes\n    const clientesRows = document.querySelectorAll('#tableClientes tbody tr');\n    allClientesData = [];\n    \n    clientesRows.forEach((row, index) => {\n        const cells = row.cells;\n        if (cells.length === 0 || cells.length < 4) return;\n        \n        // Verificar se √© uma linha de \"Sem dados\"\n        if (cells[0].textContent.includes('Sem dados')) return;\n        \n        const codCliente = cells[0]?.textContent.trim().toLowerCase() || '';\n        const pedido = cells[2]?.textContent.trim().toLowerCase() || '';\n        const motoboy = cells[3]?.textContent.trim().toLowerCase() || '';\n        const rota = cells[4]?.textContent.trim().toLowerCase() || '';\n        const inicioRota = cells[7]?.textContent.trim() || '';\n        \n        let showRow = true;\n        \n        // Filtro por MOTOBOY\n        if (filterMotoboy && !motoboy.includes(filterMotoboy)) {\n            showRow = false;\n        }\n        \n        // Filtro por CIDADE (campo ROTA na tabela de clientes)\n        if (filterCidade && !rota.includes(filterCidade)) {\n            showRow = false;\n        }\n        \n        // Filtro por ROTA (pode ser COD_CLI ou PEDIDO)\n        if (filterRota && !codCliente.includes(filterRota) && !pedido.includes(filterRota)) {\n            showRow = false;\n        }\n        \n        // Filtro por HORA\n        if (filterHora && inicioRota) {\n            const horaMatch = inicioRota.match(/\\d{2}:\\d{2}:\\d{2}/);\n            if (horaMatch) {\n                const hora = horaMatch[0].substring(0, 5);\n                if (!hora.startsWith(filterHora.substring(0, 2))) {\n                    showRow = false;\n                }\n            }\n        }\n        \n        // Filtro por DATA\n        if (filterData && inicioRota) {\n            const dataMatch = inicioRota.match(/(\\d{2})\\/(\\d{2})\\/(\\d{4})/);\n            if (dataMatch) {\n                const [_, dia, mes, ano] = dataMatch;\n                const dataRow = `${ano}-${mes}-${dia}`;\n                if (dataRow !== filterData) {\n                    showRow = false;\n                }\n            }\n        }\n        \n        if (showRow) {\n            allClientesData.push(index);\n        }\n    });\n    \n    // Resetar para primeira p√°gina\n    currentPageRotas = 1;\n    currentPageClientes = 1;\n    \n    // Atualizar ambas as pagina√ß√µes\n    updatePaginationRotas();\n    updatePaginationClientes();\n    \n    // Renderizar as tabelas filtradas\n    renderFilteredTables();\n}\n\nfunction renderFilteredTables() {\n    // Renderizar Rotas\n    const rotasRows = document.querySelectorAll('#tableRotas tbody tr');\n    rotasRows.forEach((row, index) => {\n        row.style.display = 'none';\n    });\n    \n    const startRotas = (currentPageRotas - 1) * itemsPerPage;\n    const endRotas = startRotas + itemsPerPage;\n    allRotasData.slice(startRotas, endRotas).forEach(dataIndex => {\n        rotasRows[dataIndex].style.display = '';\n    });\n    \n    // Renderizar Clientes\n    const clientesRows = document.querySelectorAll('#tableClientes tbody tr');\n    clientesRows.forEach((row, index) => {\n        row.style.display = 'none';\n    });\n    \n    const startClientes = (currentPageClientes - 1) * itemsPerPage;\n    const endClientes = startClientes + itemsPerPage;\n    allClientesData.slice(startClientes, endClientes).forEach(dataIndex => {\n        clientesRows[dataIndex].style.display = '';\n    });\n    \n    // Reativar listeners dos links SAIDAID ap√≥s renderizar\n    attachSaidaIdListeners();\n}\n\n// Fun√ß√£o para abrir o modal e carregar detalhes da sa√≠da\nfunction abrirModalSaida(saidaId) {\n    console.log('üöÄ Abrindo modal para SAIDAID:', saidaId);\n    console.log('üì¶ Total de pedidos em globalPedidosData:', globalPedidosData.length);\n    console.log('üîç Filtrando pedidos para SAIDAID:', saidaId);\n    \n    // Converter saidaId para string para compara√ß√£o segura\n    const saidaIdStr = String(saidaId);\n    const pedidos = globalPedidosData.filter(p => String(p.SAIDAID) === saidaIdStr);\n    \n    console.log('‚úÖ Pedidos encontrados:', pedidos.length);\n    \n    if (pedidos.length === 0) {\n        console.error('‚ùå Nenhum pedido encontrado para SAIDAID:', saidaId);\n        console.log('üîç Primeiros 5 SAIDAIDs dispon√≠veis:', \n            [...new Set(globalPedidosData.slice(0, 10).map(p => p.SAIDAID))]);\n        alert(`Nenhum pedido encontrado para a sa√≠da ${saidaId}.`);\n        return;\n    }\n    \n    // Ordenar por ENTREGA_CLIENTE\n    pedidos.sort((a, b) => {\n        const dateA = a.ENTREGA_CLIENTE ? new Date(a.ENTREGA_CLIENTE) : new Date(0);\n        const dateB = b.ENTREGA_CLIENTE ? new Date(b.ENTREGA_CLIENTE) : new Date(0);\n        return dateA - dateB;\n    });\n    \n    const motoboy = pedidos[0]?.MOTOBOY || 'N/A';\n    const filial = pedidos[0]?.CIDADEFILIAL || 'N/A';\n    \n    // Calcular totais da sa√≠da\n    let totalKm = 0;\n    let totalPrevisto = 0;\n    let totalReal = 0;\n    \n    pedidos.forEach(p => {\n        const log = globalCalcData.find(l => l.PEDIDO === p.PEDIDO);\n        if (log) {\n            totalKm += parseFloat(log.KM || 0);\n            const tempoGoogle = Number((log.TEMPO || \"0\").toString().replace(/\\D+/g, ''));\n            totalPrevisto += (tempoGoogle + 5); // +5min\n        }\n    });\n    \n    // Calcular tempo real total (√∫ltima entrega - primeira sa√≠da)\n    const datasEntrega = pedidos\n        .map(p => p.ENTREGA_CLIENTE)\n        .filter(d => d && d !== 'null')\n        .map(d => new Date(d));\n    const datasInicio = pedidos\n        .map(p => p.INICIO_ROTA)\n        .filter(d => d && d !== 'null')\n        .map(d => new Date(d));\n        \n    if (datasEntrega.length > 0 && datasInicio.length > 0) {\n        const ultimaEntrega = new Date(Math.max(...datasEntrega));\n        const primeiraSaida = new Date(Math.min(...datasInicio));\n        totalReal = Math.floor((ultimaEntrega - primeiraSaida) / 60000); // em minutos\n    }\n    \n    // Montar HTML do modal\n    let html = `\n        <div class=\"modal-info-box\">\n            <div class=\"modal-info-item\">\n                <div class=\"modal-info-label\">üì¶ Total de Pedidos</div>\n                <div class=\"modal-info-value\">${pedidos.length}</div>\n            </div>\n            <div class=\"modal-info-item\">\n                <div class=\"modal-info-label\">üèçÔ∏è Motoboy</div>\n                <div class=\"modal-info-value\">${motoboy}</div>\n            </div>\n            <div class=\"modal-info-item\">\n                <div class=\"modal-info-label\">üè¢ Filial</div>\n                <div class=\"modal-info-value\">${filial}</div>\n            </div>\n            <div class=\"modal-info-item\">\n                <div class=\"modal-info-label\">üìç KM Total</div>\n                <div class=\"modal-info-value\">${totalKm.toFixed(2)} km</div>\n            </div>\n            <div class=\"modal-info-item\">\n                <div class=\"modal-info-label\">‚è±Ô∏è Tempo Previsto</div>\n                <div class=\"modal-info-value\">${totalPrevisto} min</div>\n            </div>\n            <div class=\"modal-info-item\">\n                <div class=\"modal-info-label\">‚è±Ô∏è Tempo Real</div>\n                <div class=\"modal-info-value\">${totalReal} min</div>\n            </div>\n        </div>\n        \n        <div class=\"pedidos-list\">\n    `;\n    \n    // Listar cada pedido\n    pedidos.forEach((pedido, index) => {\n        const log = globalCalcData.find(l => l.PEDIDO === pedido.PEDIDO);\n        const rota = globalRotasData.find(r => r.pedido_numero === pedido.PEDIDO);\n        \n        // Calcular tempo deste pedido\n        let tempoLocal = 0;\n        let baseCalculo = '';\n        \n        if (index === 0) {\n            if (pedido.ENTREGA_CLIENTE && pedido.INICIO_ROTA) {\n                tempoLocal = (new Date(pedido.ENTREGA_CLIENTE) - new Date(pedido.INICIO_ROTA)) / 60000;\n                baseCalculo = 'desde In√≠cio da Rota';\n            }\n        } else {\n            const pedidoAnterior = pedidos[index - 1];\n            if (pedido.ENTREGA_CLIENTE && pedidoAnterior.ENTREGA_CLIENTE) {\n                tempoLocal = (new Date(pedido.ENTREGA_CLIENTE) - new Date(pedidoAnterior.ENTREGA_CLIENTE)) / 60000;\n                baseCalculo = `desde Pedido ${pedidoAnterior.PEDIDO}`;\n            }\n        }\n        \n        // Google Maps tempo\n        const tempoGoogle = log ? Number((log.TEMPO || \"0\").toString().replace(/\\D+/g, '')) : 0;\n        const tempoPrevisto = tempoGoogle + 5; // +5min\n        \n        // Determinar status\n        let statusBadge = 'nao-entregue';\n        let statusTexto = '‚è≥ N√£o Entregue';\n        \n        if (!pedido.ENTREGA_CLIENTE || pedido.ENTREGA_CLIENTE === 'null') {\n            statusBadge = 'nao-entregue';\n            statusTexto = '‚è≥ N√£o Entregue';\n        } else if (tempoPrevisto > 0 && tempoLocal > 0) {\n            const percentual = tempoLocal / tempoPrevisto;\n            if (percentual <= 1) {\n                statusBadge = 'dentro';\n                statusTexto = '‚úÖ Dentro do Prazo';\n            } else {\n                statusBadge = 'fora';\n                statusTexto = '‚ùå Fora do Prazo';\n            }\n        } else if (pedido.ENTREGA_CLIENTE && pedido.ENTREGA_CLIENTE !== 'null') {\n            statusBadge = 'dentro';\n            statusTexto = '‚úÖ Dentro do Prazo';\n        }\n        \n        const formatData = (dataStr) => {\n            if (!dataStr || dataStr === 'null') return '--';\n            return new Date(dataStr).toLocaleString('pt-BR', {\n                day: '2-digit',\n                month: '2-digit',\n                year: 'numeric',\n                hour: '2-digit',\n                minute: '2-digit',\n                second: '2-digit'\n            }).replace(',', '');\n        };\n        \n        html += `\n            <div class=\"pedido-item\">\n                <div class=\"pedido-header\">\n                    <div class=\"pedido-numero\">${index + 1}¬∫ - Pedido ${pedido.PEDIDO}</div>\n                    <div class=\"pedido-badge ${statusBadge}\">${statusTexto}</div>\n                </div>\n                <div class=\"pedido-details\">\n                    <div class=\"pedido-detail-item\">\n                        <div class=\"pedido-detail-label\">üë§ Cliente</div>\n                        <div class=\"pedido-detail-value\">${pedido.RAZAO_SOCIAL || 'N/A'}</div>\n                    </div>\n                    <div class=\"pedido-detail-item\">\n                        <div class=\"pedido-detail-label\">üìç Endere√ßo</div>\n                        <div class=\"pedido-detail-value\">${pedido.ENDERECO || 'N/A'}</div>\n                    </div>\n                    <div class=\"pedido-detail-item\">\n                        <div class=\"pedido-detail-label\">üïê In√≠cio Rota</div>\n                        <div class=\"pedido-detail-value\">${formatData(pedido.INICIO_ROTA)}</div>\n                    </div>\n                    <div class=\"pedido-detail-item\">\n                        <div class=\"pedido-detail-label\">‚úÖ Entrega Cliente</div>\n                        <div class=\"pedido-detail-value\">${formatData(pedido.ENTREGA_CLIENTE)}</div>\n                    </div>\n                    <div class=\"pedido-detail-item\">\n                        <div class=\"pedido-detail-label\">üìè Dist√¢ncia</div>\n                        <div class=\"pedido-detail-value\">${log?.KM || 'N/A'}</div>\n                    </div>\n                    <div class=\"pedido-detail-item\">\n                        <div class=\"pedido-detail-label\">‚è±Ô∏è Tempo Real</div>\n                        <div class=\"pedido-detail-value\">${tempoLocal.toFixed(2)} min</div>\n                    </div>\n                    <div class=\"pedido-detail-item\">\n                        <div class=\"pedido-detail-label\">üó∫Ô∏è Tempo Google+5</div>\n                        <div class=\"pedido-detail-value\">${tempoPrevisto} min</div>\n                    </div>\n                    <div class=\"pedido-detail-item\">\n                        <div class=\"pedido-detail-label\">üìä Base de C√°lculo</div>\n                        <div class=\"pedido-detail-value\">${baseCalculo}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    });\n    \n    html += `</div>`;\n    \n    // Atualizar modal\n    document.getElementById('modalSaidaTitulo').textContent = `Sa√≠da ${saidaId} - ${pedidos.length} Pedidos`;\n    document.getElementById('modalSaidaBody').innerHTML = html;\n    document.getElementById('saidaModal').classList.add('active');\n}\n\n// Fun√ß√£o para fechar o modal\nfunction fecharModalSaida() {\n    document.getElementById('saidaModal').classList.remove('active');\n}\n\n// Fechar modal com ESC\ndocument.addEventListener('keydown', (e) => {\n    if (e.key === 'Escape') {\n        fecharModalSaida();\n    }\n});\n\n// Event delegation para capturar cliques nos SAIDAIDs\ndocument.addEventListener('click', (e) => {\n    const target = e.target;\n    \n    // Verificar se clicou no link do SAIDAID ou em seu pai\n    if (target.classList.contains('saidaid-link') || target.closest('.saidaid-link')) {\n        const linkElement = target.classList.contains('saidaid-link') ? target : target.closest('.saidaid-link');\n        const saidaId = linkElement.getAttribute('data-saidaid');\n        \n        console.log('üñ±Ô∏è Clique detectado no SAIDAID:', saidaId);\n        console.log('üìç Elemento:', linkElement);\n        \n        if (saidaId) {\n            e.preventDefault();\n            e.stopPropagation();\n            abrirModalSaida(saidaId);\n        } else {\n            console.error('‚ùå SAIDAID n√£o encontrado no elemento');\n        }\n    }\n});\n\n// Adicionar listeners diretamente aos links ap√≥s o DOM carregar\nfunction attachSaidaIdListeners() {\n    const links = document.querySelectorAll('.saidaid-link');\n    console.log(`üîó Encontrados ${links.length} links de SAIDAID`);\n    \n    links.forEach(link => {\n        link.style.cursor = 'pointer';\n        link.addEventListener('click', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            const saidaId = this.getAttribute('data-saidaid');\n            console.log('üñ±Ô∏è Clique direto no SAIDAID:', saidaId);\n            if (saidaId) {\n                abrirModalSaida(saidaId);\n            }\n        });\n    });\n}\n\n// Inicializar quando a p√°gina carregar\nsetTimeout(() => {\n    console.log('üöÄ Iniciando coleta de dados...');\n    \n    // Coletar todos os dados inicialmente\n    const rotasRows = document.querySelectorAll('#tableRotas tbody tr');\n    const clientesRows = document.querySelectorAll('#tableClientes tbody tr');\n    \n    console.log(`üìä Linhas encontradas - Rotas: ${rotasRows.length}, Clientes: ${clientesRows.length}`);\n    \n    allRotasData = Array.from(rotasRows).map((_, i) => i).filter(i => {\n        const row = rotasRows[i];\n        return row.cells.length > 0 && !row.cells[0].textContent.includes('Sem dados');\n    });\n    \n    allClientesData = Array.from(clientesRows).map((_, i) => i).filter(i => {\n        const row = clientesRows[i];\n        return row.cells.length > 0 && !row.cells[0].textContent.includes('Sem dados');\n    });\n    \n    console.log(`‚úÖ Dados coletados - Rotas: ${allRotasData.length}, Clientes: ${allClientesData.length}`);\n    \n    // Carregar dados globais para o modal\n    const rawPedidos = {{JSON.stringify(pedidos_e_saidas_do_dia?.data || [])}};\n    const rawCalc = {{JSON.stringify(calculo_do_google?.data?.logistica_motoboy || [])}};\n    const rawRotas = {{JSON.stringify(dmaplicativo_prod_rotas_otimiz?.data || [])}};\n    \n    globalPedidosData = rawPedidos;\n    globalCalcData = rawCalc;\n    globalRotasData = rawRotas;\n    \n    // Popular filtros\n    populateFilters();\n    \n    // Inicializar pagina√ß√£o\n    console.log('üìÑ Inicializando pagina√ß√£o...');\n    updatePaginationRotas();\n    updatePaginationClientes();\n    \n    // Inicializar info de filtros\n    updateFiltersInfo();\n    \n    // Adicionar listeners aos links de SAIDAID ap√≥s um pequeno delay\n    setTimeout(() => {\n        attachSaidaIdListeners();\n    }, 100);\n    \n    console.log(`‚úÖ Dashboard inicializado!`);\n    console.log(`üìä Rotas: ${allRotasData.length} registros`);\n    console.log(`üì¶ Clientes: ${allClientesData.length} registros`);\n}, 1000);\n\n</script>\n\n{{''}}\n\n",
  "topRow": 0,
  "type": "IFRAME_WIDGET",
  "version": 1,
  "widgetId": "jk8s4e724j",
  "widgetName": "Iframe1Copy1"
}