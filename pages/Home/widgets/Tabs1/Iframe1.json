{
  "animateLoading": true,
  "borderOpacity": 100,
  "borderRadius": "{{appsmith.theme.borderRadius.appBorderRadius}}",
  "borderWidth": 1,
  "bottomRow": 185,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "dynamicBindingPathList": [
    {
      "key": "borderRadius"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "srcDoc"
    }
  ],
  "dynamicTriggerPathList": [],
  "flexVerticalAlignment": "start",
  "isLoading": false,
  "isVisible": true,
  "key": "gw9rz40e8t",
  "leftColumn": 0,
  "mobileBottomRow": 33,
  "mobileLeftColumn": 19,
  "mobileRightColumn": 43,
  "mobileTopRow": 1,
  "needsErrorInfo": false,
  "originalBottomRow": 161,
  "originalTopRow": 20,
  "parentColumnSpace": 20.25,
  "parentId": "cxat9ili1i",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "responsiveBehavior": "fill",
  "rightColumn": 64,
  "source": "https://www.example.com",
  "srcDoc": "<style>\n    .delivery-wrap {\n        display: grid;\n        gap: 16px;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;\n        background: #f9fafb;\n        padding: 16px;\n        border-radius: 16px;\n    }\n\n    /* Header & filter pills */\n    .delivery-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        flex-wrap: wrap;\n        gap: 12px;\n    }\n    .delivery-title {\n        font-size: 24px;\n        font-weight: 900;\n        color: #1890ff;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n    .delivery-title::before {\n        content: \"üì¶\";\n        font-size: 28px;\n    }\n    .pills {\n        display: flex;\n        gap: 8px;\n        flex-wrap: wrap;\n    }\n    .pill {\n        background: #fff;\n        color: #374151;\n        border: 2px solid #1890ff;\n        padding: 8px 14px;\n        border-radius: 999px;\n        font-size: 12px;\n        font-weight: 700;\n        box-shadow: 0 1px 3px rgba(24,144,255,0.2);\n        transition: all 0.2s;\n    }\n    .pill:hover {\n        background: #1890ff;\n        color: white;\n    }\n\n    /* KPI cards */\n    .kpi-grid {\n        display: grid;\n        grid-template-columns: repeat(4, 1fr);\n        gap: 12px;\n    }\n    .kpi {\n        border-radius: 16px;\n        padding: 18px 20px;\n        color: #fff;\n        box-shadow: 0 10px 25px rgba(0,0,0,0.12);\n        border: 1px solid rgba(255,255,255,0.2);\n        position: relative;\n        overflow: hidden;\n        transition: transform 0.2s;\n    }\n    .kpi:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 15px 35px rgba(0,0,0,0.18);\n    }\n    .kpi::before {\n        content: '';\n        position: absolute;\n        top: 0;\n        right: 0;\n        width: 100px;\n        height: 100px;\n        background: rgba(255,255,255,0.1);\n        border-radius: 50%;\n        transform: translate(30%, -30%);\n    }\n    .kpi h4 { \n        margin: 0 0 8px 0; \n        font-size: 11px; \n        font-weight: 700; \n        opacity: .92; \n        text-transform: uppercase; \n        letter-spacing: 0.5px; \n        position: relative; \n        z-index: 1; \n    }\n    .kpi .v { \n        font-size: 28px; \n        font-weight: 900; \n        line-height: 1.1; \n        position: relative; \n        z-index: 1; \n    }\n    .kpi .s { \n        font-size: 11px; \n        opacity: .88; \n        margin-top: 4px; \n        position: relative; \n        z-index: 1; \n    }\n    .kpi-rotas { background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%); }\n    .kpi-entregas { background: linear-gradient(135deg, #52c41a 0%, #389e0d 100%); }\n    .kpi-tempo { background: linear-gradient(135deg, #faad14 0%, #d48806 100%); }\n    .kpi-cidades { background: linear-gradient(135deg, #13c2c2 0%, #08979c 100%); }\n\n    /* Cards containers */\n    .cards-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }\n    .cards-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }\n\n    .card {\n        background: #fff;\n        border-radius: 16px;\n        border: 1px solid #e5e7eb;\n        box-shadow: 0 4px 12px rgba(0,0,0,.04);\n        padding: 16px;\n        transition: all 0.2s;\n    }\n    .card:hover {\n        box-shadow: 0 8px 24px rgba(0,0,0,.08);\n        border-color: #1890ff;\n    }\n    .card h3 { \n        margin: 0 0 14px 0; \n        font-size: 15px; \n        color: #1890ff; \n        font-weight: 800;\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding-bottom: 10px;\n        border-bottom: 2px solid #f3f4f6;\n    }\n\n    /* Tables */\n    table { width: 100%; border-collapse: collapse; }\n    th, td { padding: 12px 10px; text-align: left; font-size: 12px; }\n    th { \n        color: #fff; \n        border-bottom: 2px solid #0050b3; \n        font-weight: 800; \n        text-transform: uppercase;\n        font-size: 11px;\n        letter-spacing: 0.5px;\n        background: #1890ff;\n    }\n    tr + tr td { border-top: 1px solid #f3f4f6; }\n    tbody tr:hover { background: #e6f7ff; }\n\n    .tag {\n        display: inline-block;\n        padding: 5px 10px;\n        border-radius: 999px;\n        font-size: 10px;\n        font-weight: 800;\n        letter-spacing: 0.3px;\n        text-transform: uppercase;\n    }\n    .tag.entregue { background: #d1fae5; color: #065f46; border: 1px solid #a7f3d0; }\n    .tag.transporte { background: #fef3c7; color: #92400e; border: 1px solid #fde68a; }\n    .tag.nao-entregue { background: #fee2e2; color: #991b1b; border: 1px solid #fecaca; }\n\n    .muted { color: #9ca3af; }\n    .strong-text { font-weight: 800; color: #111827; }\n    \n    .bar-container {\n        width: 100%;\n        height: 8px;\n        background: #e5e7eb;\n        border-radius: 999px;\n        overflow: hidden;\n        margin-top: 4px;\n    }\n    .bar-fill {\n        height: 100%;\n        background: linear-gradient(90deg, #1890ff, #13c2c2);\n        border-radius: 999px;\n        transition: width 0.3s;\n    }\n\n    .empty-state {\n        text-align: center;\n        padding: 40px;\n        color: #9ca3af;\n        font-style: italic;\n    }\n\n    /* Responsive */\n    @media (max-width: 1200px) { \n        .kpi-grid { grid-template-columns: repeat(2, 1fr); }\n        .cards-3 { grid-template-columns: 1fr 1fr; }\n    }\n    @media (max-width: 900px) { \n        .cards-2, .cards-3 { grid-template-columns: 1fr; }\n    }\n    @media (max-width: 520px) { \n        .kpi-grid { grid-template-columns: 1fr; }\n        table { font-size: 11px; }\n        th, td { padding: 8px 6px; }\n    }\n</style>\n\n<div class=\"delivery-wrap\">\n    <!-- Header -->\n    <div class=\"delivery-header\">\n        <div class=\"delivery-title\">Dashboard de Entregas - BlueTech</div>\n        <div class=\"pills\">\n            <span class=\"pill\">Total: {{(pedidos_e_saidas_do_dia?.data || []).length}} entregas</span>\n            <span class=\"pill\">Data: {{new Date().toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' })}}</span>\n        </div>\n    </div>\n\n    <!-- KPIs principais -->\n    <div class=\"kpi-grid\">\n        <div class=\"kpi kpi-rotas\">\n            <h4>üöö Total de Rotas</h4>\n            <div class=\"v\">{{\n                (()=>{\n                    const d = pedidos_e_saidas_do_dia?.data || [];\n                    const rotas = new Set(d.map(x => x.SAIDAID)).size;\n                    return rotas;\n                })()\n            }}</div>\n            <div class=\"s\">{{\n                (()=>{\n                    const d = pedidos_e_saidas_do_dia?.data || [];\n                    return `${d.length} entregas`;\n                })()\n            }}</div>\n        </div>\n        \n        <div class=\"kpi kpi-entregas\">\n            <h4>üì¶ Entregas Conclu√≠das</h4>\n            <div class=\"v\">{{\n                (()=>{\n                    const d = pedidos_e_saidas_do_dia?.data || [];\n                    const entregues = d.filter(x => x.ENTREGA_CLIENTE && x.ENTREGA_CLIENTE !== 'null').length;\n                    return entregues;\n                })()\n            }}</div>\n            <div class=\"s\">{{\n                (()=>{\n                    const d = pedidos_e_saidas_do_dia?.data || [];\n                    const entregues = d.filter(x => x.ENTREGA_CLIENTE && x.ENTREGA_CLIENTE !== 'null').length;\n                    const pct = d.length ? ((entregues / d.length) * 100).toFixed(1) : 0;\n                    return `${pct}% conclu√≠das`;\n                })()\n            }}</div>\n        </div>\n        \n        <div class=\"kpi kpi-tempo\">\n            <h4>‚è±Ô∏è Tempo M√©dio</h4>\n            <div class=\"v\">{{\n                (()=>{\n                    const calc = calculo_do_google?.data?.logistica_motoboy || [];\n                    const times = calc.map(l => parseInt(l.TEMPO) || 0).filter(t => t > 0);\n                    const avg = times.length > 0 ? Math.round(times.reduce((a,b) => a+b, 0) / times.length) : 0;\n                    return avg;\n                })()\n            }} min</div>\n            <div class=\"s\">{{\n                (()=>{\n                    const calc = calculo_do_google?.data?.logistica_motoboy || [];\n                    return `${calc.length} registros`;\n                })()\n            }}</div>\n        </div>\n        \n        <div class=\"kpi kpi-cidades\">\n            <h4>üìç Cidades Atendidas</h4>\n            <div class=\"v\">{{\n                (()=>{\n                    const d = pedidos_e_saidas_do_dia?.data || [];\n                    const cidades = new Set(d.map(x => x.CIDADEFILIAL)).size;\n                    return cidades;\n                })()\n            }}</div>\n            <div class=\"s\">{{\n                (()=>{\n                    const calc = calculo_do_google?.data?.logistica_motoboy || [];\n                    const kmTotal = calc.reduce((sum, x) => sum + (parseFloat(x.KM) || 0), 0);\n                    return `${kmTotal.toFixed(1)} km total`;\n                })()\n            }}</div>\n        </div>\n    </div>\n\n    <!-- Agrupamentos Principais -->\n    <div class=\"cards-3\">\n        <!-- Por Cidade -->\n        <div class=\"card\">\n            <h3>üè¢ Entregas por Cidade</h3>\n            <table>\n                <thead>\n                    <tr><th>Cidade</th><th>Qtd</th><th>KM Total</th></tr>\n                </thead>\n                <tbody>\n                    {{\n                        (()=>{\n                            const d = pedidos_e_saidas_do_dia?.data || [];\n                            const calc = calculo_do_google?.data?.logistica_motoboy || [];\n                            const acc = {};\n                            d.forEach(i => {\n                                const k = String(i.CIDADEFILIAL || 'Sem cidade');\n                                const log = calc.find(l => l.PEDIDO === i.PEDIDO || l.SAIDAID === parseInt(i.SAIDAID));\n                                const km = parseFloat(log?.KM || 0);\n                                if(!acc[k]) acc[k] = {cidade: k, count: 0, km: 0};\n                                acc[k].count++;\n                                acc[k].km += km;\n                            });\n                            const maxCount = Math.max(...Object.values(acc).map(x => x.count), 1);\n                            const rows = Object.values(acc).sort((a,b) => b.count - a.count).slice(0,10).map(x => {\n                                const pct = (x.count / maxCount * 100).toFixed(0);\n                                return `<tr>\n                                    <td><strong>${x.cidade}</strong></td>\n                                    <td class='muted'>${x.count}</td>\n                                    <td class='strong-text'>${x.km.toFixed(1)} km\n                                        <div class='bar-container'><div class='bar-fill' style='width:${pct}%'></div></div>\n                                    </td>\n                                </tr>`;\n                            }).join('');\n                            return rows || `<tr><td colspan='3' class='empty-state'>Sem dados dispon√≠veis</td></tr>`;\n                        })()\n                    }}\n                </tbody>\n            </table>\n        </div>\n\n        <!-- Por Motoboy -->\n        <div class=\"card\">\n            <h3>üèçÔ∏è Ranking de Motoboys</h3>\n            <table>\n                <thead>\n                    <tr><th>Motoboy</th><th>Entregas</th><th>KM</th></tr>\n                </thead>\n                <tbody>\n                    {{\n                        (()=>{\n                            const d = pedidos_e_saidas_do_dia?.data || [];\n                            const calc = calculo_do_google?.data?.logistica_motoboy || [];\n                            const acc = {};\n                            d.forEach(i => {\n                                const k = String(i.MOTOBOY || 'Sem motoboy').trim();\n                                const log = calc.find(l => l.PEDIDO === i.PEDIDO || l.SAIDAID === parseInt(i.SAIDAID));\n                                const km = parseFloat(log?.KM || 0);\n                                if(!acc[k]) acc[k] = {motoboy: k, count: 0, km: 0};\n                                acc[k].count++;\n                                acc[k].km += km;\n                            });\n                            const maxKm = Math.max(...Object.values(acc).map(x => x.km), 1);\n                            const rows = Object.values(acc).sort((a,b) => b.count - a.count).slice(0,10).map((x, idx) => {\n                                const medal = idx < 3 ? ['ü•á','ü•à','ü•â'][idx] : `${idx+1}¬∫`;\n                                const pct = (x.km / maxKm * 100).toFixed(0);\n                                return `<tr>\n                                    <td><strong>${medal} ${x.motoboy}</strong></td>\n                                    <td class='muted'>${x.count}x</td>\n                                    <td class='strong-text'>${x.km.toFixed(1)} km\n                                        <div class='bar-container'><div class='bar-fill' style='width:${pct}%'></div></div>\n                                    </td>\n                                </tr>`;\n                            }).join('');\n                            return rows || `<tr><td colspan='3' class='empty-state'>Sem dados dispon√≠veis</td></tr>`;\n                        })()\n                    }}\n                </tbody>\n            </table>\n        </div>\n\n        <!-- Por Status -->\n        <div class=\"card\">\n            <h3>üìä Status das Entregas</h3>\n            <table>\n                <thead>\n                    <tr><th>Status</th><th>Qtd</th><th>Percentual</th></tr>\n                </thead>\n                <tbody>\n                    {{\n                        (()=>{\n                            const d = pedidos_e_saidas_do_dia?.data || [];\n                            const total = d.length || 1;\n                            const entregues = d.filter(x => x.ENTREGA_CLIENTE && x.ENTREGA_CLIENTE !== 'null').length;\n                            const emTransporte = d.filter(x => x.INICIO_ROTA && !x.FIM_ROTA && (!x.ENTREGA_CLIENTE || x.ENTREGA_CLIENTE === 'null')).length;\n                            const naoEntregues = total - entregues - emTransporte;\n                            \n                            const stats = [\n                                {status: '‚úì Entregue', count: entregues, color: '#52c41a'},\n                                {status: 'üöö Em Transporte', count: emTransporte, color: '#faad14'},\n                                {status: '‚è≥ N√£o Entregue', count: naoEntregues, color: '#ff4d4f'}\n                            ];\n                            \n                            return stats.map(s => {\n                                const pct = ((s.count / total) * 100).toFixed(1);\n                                return `<tr>\n                                    <td><strong style='color:${s.color}'>${s.status}</strong></td>\n                                    <td class='muted'>${s.count}</td>\n                                    <td class='strong-text'>${pct}%\n                                        <div class='bar-container'><div class='bar-fill' style='width:${pct}%; background:${s.color}'></div></div>\n                                    </td>\n                                </tr>`;\n                            }).join('');\n                        })()\n                    }}\n                </tbody>\n            </table>\n        </div>\n    </div>\n\n    <!-- Lista detalhada de entregas -->\n    <div class=\"card\">\n        <h3>üìã Lista Completa de Entregas (Top 100)</h3>\n        <table>\n            <thead>\n                <tr>\n                    <th>ID Sa√≠da</th>\n                    <th>Pedido</th>\n                    <th>Cliente</th>\n                    <th>Motoboy</th>\n                    <th>Cidade</th>\n                    <th>Endere√ßo</th>\n                    <th>KM</th>\n                    <th>Tempo</th>\n                    <th>Status</th>\n                </tr>\n            </thead>\n            <tbody>\n                {{\n                    (()=>{\n                        const d = pedidos_e_saidas_do_dia?.data || [];\n                        const calc = calculo_do_google?.data?.logistica_motoboy || [];\n                        \n                        const rows = d.slice(0, 100).map(delivery => {\n                            const log = calc.find(l => l.PEDIDO === delivery.PEDIDO || l.SAIDAID === parseInt(delivery.SAIDAID));\n                            \n                            // Determinar status\n                            let statusClass = 'nao-entregue';\n                            let statusText = '‚è≥ N√£o Entregue';\n                            if (delivery.ENTREGA_CLIENTE && delivery.ENTREGA_CLIENTE !== 'null') {\n                                statusClass = 'entregue';\n                                statusText = '‚úì Entregue';\n                            } else if (delivery.INICIO_ROTA && !delivery.FIM_ROTA) {\n                                statusClass = 'transporte';\n                                statusText = 'üöö Em Transporte';\n                            }\n                            \n                            const cliente = String(delivery.RAZAO_SOCIAL || '').substring(0, 30);\n                            const clienteTrunc = delivery.RAZAO_SOCIAL && delivery.RAZAO_SOCIAL.length > 30 ? cliente + '...' : cliente;\n                            const endereco = String(delivery.ENDERECO || '').substring(0, 40);\n                            const enderecoTrunc = delivery.ENDERECO && delivery.ENDERECO.length > 40 ? endereco + '...' : endereco;\n                            \n                            return `<tr>\n                                <td class='muted'>${delivery.SAIDAID}</td>\n                                <td><strong>${delivery.PEDIDO}</strong></td>\n                                <td>${clienteTrunc}</td>\n                                <td class='muted'>${String(delivery.MOTOBOY || '').trim()}</td>\n                                <td class='muted'>${delivery.CIDADE || '-'}</td>\n                                <td class='muted' style='font-size:11px;' title='${delivery.ENDERECO || ''}'>${enderecoTrunc}</td>\n                                <td class='strong-text'>${log?.KM || '-'}</td>\n                                <td class='muted'>${log?.TEMPO || '-'}</td>\n                                <td><span class='tag ${statusClass}'>${statusText}</span></td>\n                            </tr>`;\n                        }).join('');\n                        \n                        return rows || `<tr><td colspan='9' class='empty-state'>Nenhuma entrega encontrada</td></tr>`;\n                    })()\n                }}\n            </tbody>\n        </table>\n        {{\n            (()=>{\n                const total = (pedidos_e_saidas_do_dia?.data || []).length;\n                if (total > 100) {\n                    return `<div style='margin-top:16px; padding:12px; background:#e6f7ff; border-radius:8px; text-align:center; color:#1890ff; font-weight:600;'>\n                        Mostrando 100 de ${total} entregas totais\n                    </div>`;\n                }\n                return '';\n            })()\n        }}\n    </div>\n</div>\n\n<!-- Helper (necess√°rio para fechar o c√≥digo inline do Appsmith) -->\n{{\n    ''\n}}\n\n",
  "topRow": 1,
  "type": "IFRAME_WIDGET",
  "version": 1,
  "widgetId": "ji15ha0pmi",
  "widgetName": "Iframe1"
}