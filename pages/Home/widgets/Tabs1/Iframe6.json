{
  "animateLoading": true,
  "borderOpacity": 100,
  "borderRadius": "{{appsmith.theme.borderRadius.appBorderRadius}}",
  "borderWidth": 1,
  "bottomRow": 134,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "dynamicBindingPathList": [
    {
      "key": "borderRadius"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "srcDoc"
    }
  ],
  "dynamicTriggerPathList": [],
  "flexVerticalAlignment": "start",
  "isLoading": false,
  "isVisible": true,
  "key": "wh6z4zxt20",
  "leftColumn": 0,
  "mobileBottomRow": 32,
  "mobileLeftColumn": 0,
  "mobileRightColumn": 13,
  "mobileTopRow": 0,
  "needsErrorInfo": false,
  "parentColumnSpace": 19.9375,
  "parentId": "lm89h5zuoj",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "responsiveBehavior": "fill",
  "rightColumn": 64,
  "source": "https://www.example.com",
  "srcDoc": "<style>\n    * {\n        margin: 0;\n        padding: 0;\n        box-sizing: border-box;\n    }\n\n    body {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;\n        background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);\n        min-height: 100vh;\n        padding: 20px;\n    }\n\n    .pedido-container {\n        max-width: 1800px;\n        margin: 0 auto;\n    }\n\n    /* ========== HEADER & SEARCH ========== */\n    .search-header {\n        background: white;\n        padding: 32px;\n        border-radius: 16px;\n        box-shadow: 0 8px 32px rgba(0,0,0,0.12);\n        margin-bottom: 24px;\n    }\n\n    .search-header h1 {\n        font-size: 32px;\n        font-weight: 900;\n        background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);\n        -webkit-background-clip: text;\n        -webkit-text-fill-color: transparent;\n        background-clip: text;\n        margin-bottom: 24px;\n        display: flex;\n        align-items: center;\n        gap: 12px;\n    }\n\n    .search-box {\n        display: flex;\n        gap: 12px;\n        margin-bottom: 20px;\n    }\n\n    .search-input {\n        flex: 1;\n        padding: 16px 20px;\n        border: 3px solid #1890ff;\n        border-radius: 12px;\n        font-size: 18px;\n        font-weight: 600;\n        color: #111827;\n        transition: all 0.2s;\n    }\n\n    .search-input:focus {\n        outline: none;\n        border-color: #0050b3;\n        box-shadow: 0 0 0 4px rgba(24, 144, 255, 0.1);\n    }\n\n    .search-btn {\n        padding: 16px 32px;\n        background: linear-gradient(135deg, #1890ff 0%, #0050b3 100%);\n        color: white;\n        border: none;\n        border-radius: 12px;\n        font-size: 16px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        box-shadow: 0 4px 12px rgba(24, 144, 255, 0.3);\n        text-decoration: none;\n    }\n\n    .search-btn:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 6px 20px rgba(24, 144, 255, 0.4);\n    }\n\n    .search-btn.green {\n        background: linear-gradient(135deg, #52c41a 0%, #389e0d 100%);\n        box-shadow: 0 4px 12px rgba(82, 196, 26, 0.3);\n    }\n\n    .search-btn.green:hover {\n        box-shadow: 0 6px 20px rgba(82, 196, 26, 0.4);\n    }\n\n    /* ========== RESULTS ========== */\n    .results-section {\n        display: none;\n    }\n\n    .results-section.active {\n        display: block;\n    }\n\n    /* ========== PEDIDO HEADER ========== */\n    .pedido-header {\n        background: white;\n        padding: 32px;\n        border-radius: 16px;\n        box-shadow: 0 8px 32px rgba(0,0,0,0.12);\n        margin-bottom: 24px;\n    }\n\n    .pedido-number {\n        font-size: 48px;\n        font-weight: 900;\n        color: #1890ff;\n        margin-bottom: 12px;\n        display: flex;\n        align-items: center;\n        gap: 16px;\n    }\n\n    .status-badge {\n        padding: 12px 24px;\n        border-radius: 999px;\n        font-size: 14px;\n        font-weight: 800;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n\n    .status-badge.entregue {\n        background: #d1fae5;\n        color: #065f46;\n        border: 2px solid #10b981;\n    }\n\n    .status-badge.em-rota {\n        background: #fef3c7;\n        color: #92400e;\n        border: 2px solid #f59e0b;\n    }\n\n    .status-badge.pendente {\n        background: #fee2e2;\n        color: #991b1b;\n        border: 2px solid #ef4444;\n    }\n\n    .pedido-subtitle {\n        font-size: 16px;\n        color: #6b7280;\n        font-weight: 600;\n    }\n\n    /* ========== GRID LAYOUT ========== */\n    .two-column {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 24px;\n        margin-bottom: 24px;\n    }\n\n    /* ========== MAP SECTION ========== */\n    .map-section {\n        background: white;\n        padding: 24px;\n        border-radius: 16px;\n        box-shadow: 0 4px 16px rgba(0,0,0,0.08);\n    }\n\n    .map-title {\n        font-size: 18px;\n        font-weight: 800;\n        color: #374151;\n        margin-bottom: 16px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n\n    .map-frame {\n        width: 100%;\n        height: 400px;\n        border: 3px solid #e5e7eb;\n        border-radius: 12px;\n        margin-bottom: 16px;\n    }\n\n    .map-coordinates {\n        display: flex;\n        gap: 16px;\n        padding: 16px;\n        background: #f9fafb;\n        border-radius: 8px;\n        font-size: 13px;\n        font-weight: 600;\n        color: #6b7280;\n    }\n\n    .coord-item {\n        flex: 1;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n\n    .coord-label {\n        color: #9ca3af;\n        font-size: 11px;\n        text-transform: uppercase;\n    }\n\n    .coord-value {\n        color: #111827;\n        font-family: monospace;\n    }\n\n    /* ========== INFO CARDS ========== */\n    .info-section {\n        background: white;\n        padding: 24px;\n        border-radius: 16px;\n        box-shadow: 0 4px 16px rgba(0,0,0,0.08);\n    }\n\n    .info-title {\n        font-size: 18px;\n        font-weight: 800;\n        color: #374151;\n        margin-bottom: 16px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        padding-bottom: 12px;\n        border-bottom: 2px solid #f3f4f6;\n    }\n\n    .info-grid {\n        display: grid;\n        gap: 12px;\n    }\n\n    .info-item {\n        display: flex;\n        align-items: flex-start;\n        gap: 12px;\n        padding: 12px;\n        background: #f9fafb;\n        border-radius: 8px;\n    }\n\n    .info-icon {\n        font-size: 20px;\n        min-width: 24px;\n    }\n\n    .info-content {\n        flex: 1;\n    }\n\n    .info-label {\n        font-size: 11px;\n        font-weight: 700;\n        text-transform: uppercase;\n        color: #9ca3af;\n        letter-spacing: 0.5px;\n        margin-bottom: 4px;\n    }\n\n    .info-value {\n        font-size: 14px;\n        font-weight: 600;\n        color: #111827;\n    }\n\n    .info-value.large {\n        font-size: 16px;\n        font-weight: 700;\n    }\n\n    /* ========== TIMELINE ========== */\n    .timeline-section {\n        background: white;\n        padding: 24px 32px;\n        border-radius: 16px;\n        box-shadow: 0 4px 16px rgba(0,0,0,0.08);\n        margin-bottom: 24px;\n    }\n\n    .timeline-title {\n        font-size: 18px;\n        font-weight: 800;\n        color: #374151;\n        margin-bottom: 20px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n\n    .timeline {\n        position: relative;\n        padding-left: 40px;\n    }\n\n    .timeline::before {\n        content: '';\n        position: absolute;\n        left: 12px;\n        top: 0;\n        bottom: 0;\n        width: 3px;\n        background: linear-gradient(180deg, #1890ff, #52c41a);\n    }\n\n    .timeline-item {\n        position: relative;\n        padding-bottom: 24px;\n    }\n\n    .timeline-item::before {\n        content: '';\n        position: absolute;\n        left: -34px;\n        top: 4px;\n        width: 16px;\n        height: 16px;\n        background: white;\n        border: 4px solid #1890ff;\n        border-radius: 50%;\n        z-index: 2;\n    }\n\n    .timeline-item.completed::before {\n        border-color: #52c41a;\n        background: #52c41a;\n    }\n\n    .timeline-content {\n        background: #f9fafb;\n        padding: 16px 20px;\n        border-radius: 12px;\n        border: 1px solid #e5e7eb;\n    }\n\n    .timeline-time {\n        font-size: 13px;\n        font-weight: 700;\n        color: #1890ff;\n        margin-bottom: 6px;\n    }\n\n    .timeline-text {\n        font-size: 14px;\n        font-weight: 600;\n        color: #374151;\n    }\n\n    /* ========== ROUTE DETAILS ========== */\n    .route-section {\n        background: white;\n        padding: 24px 32px;\n        border-radius: 16px;\n        box-shadow: 0 4px 16px rgba(0,0,0,0.08);\n        margin-bottom: 24px;\n    }\n\n    .route-title {\n        font-size: 18px;\n        font-weight: 800;\n        color: #374151;\n        margin-bottom: 20px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n\n    .route-stats {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 16px;\n        margin-bottom: 20px;\n    }\n\n    .route-stat {\n        padding: 16px;\n        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n        border-radius: 12px;\n        border-left: 4px solid #1890ff;\n    }\n\n    .route-stat-label {\n        font-size: 11px;\n        font-weight: 700;\n        text-transform: uppercase;\n        color: #6b7280;\n        letter-spacing: 0.5px;\n        margin-bottom: 6px;\n    }\n\n    .route-stat-value {\n        font-size: 24px;\n        font-weight: 900;\n        color: #111827;\n    }\n\n    .route-link {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 8px;\n        padding: 16px 24px;\n        background: linear-gradient(135deg, #52c41a 0%, #389e0d 100%);\n        color: white;\n        text-decoration: none;\n        border-radius: 12px;\n        font-weight: 700;\n        font-size: 16px;\n        transition: all 0.2s;\n        box-shadow: 0 4px 12px rgba(82, 196, 26, 0.3);\n    }\n\n    .route-link:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 6px 20px rgba(82, 196, 26, 0.4);\n    }\n\n    /* ========== ALL DATA SECTION ========== */\n    .all-data-section {\n        background: white;\n        padding: 24px 32px;\n        border-radius: 16px;\n        box-shadow: 0 4px 16px rgba(0,0,0,0.08);\n        margin-bottom: 24px;\n    }\n\n    .data-table {\n        width: 100%;\n        border-collapse: collapse;\n    }\n\n    .data-table th,\n    .data-table td {\n        padding: 12px 16px;\n        text-align: left;\n        border-bottom: 1px solid #f3f4f6;\n    }\n\n    .data-table th {\n        background: #f9fafb;\n        font-size: 11px;\n        font-weight: 700;\n        text-transform: uppercase;\n        color: #6b7280;\n        letter-spacing: 0.5px;\n    }\n\n    .data-table td {\n        font-size: 13px;\n        font-weight: 600;\n        color: #374151;\n    }\n\n    .data-table tr:hover {\n        background: #f9fafb;\n    }\n\n    /* ========== EMPTY STATE ========== */\n    .empty-state {\n        text-align: center;\n        padding: 80px 20px;\n        color: #9ca3af;\n    }\n\n    .empty-icon {\n        font-size: 64px;\n        margin-bottom: 16px;\n    }\n\n    .empty-title {\n        font-size: 24px;\n        font-weight: 700;\n        color: #6b7280;\n        margin-bottom: 8px;\n    }\n\n    .empty-text {\n        font-size: 14px;\n        color: #9ca3af;\n    }\n\n    /* ========== RESPONSIVE ========== */\n    @media (max-width: 1024px) {\n        .two-column {\n            grid-template-columns: 1fr;\n        }\n    }\n\n    @media (max-width: 768px) {\n        .search-box {\n            flex-direction: column;\n        }\n\n        .pedido-number {\n            font-size: 32px;\n            flex-direction: column;\n            align-items: flex-start;\n        }\n\n        .route-stats {\n            grid-template-columns: 1fr 1fr;\n        }\n    }\n</style>\n\n<div class=\"pedido-container\">\n    <!-- HEADER & SEARCH -->\n    <div class=\"search-header\">\n        <h1>üì¶ An√°lise Completa de Pedido</h1>\n        \n        <div class=\"search-box\">\n            <input \n                type=\"text\" \n                id=\"searchInput\" \n                class=\"search-input\" \n                placeholder=\"Digite o n√∫mero do pedido...\"\n                onkeypress=\"if(event.key === 'Enter') searchPedido()\"\n            >\n            <button class=\"search-btn\" onclick=\"searchPedido()\">\n                üîç Buscar Pedido\n            </button>\n        </div>\n        \n        <div id=\"dataStatus\" style=\"margin-top: 12px; font-size: 13px; color: #6b7280; font-weight: 600;\">\n            Carregando dados...\n        </div>\n    </div>\n\n    <!-- EMPTY STATE -->\n    <div id=\"emptyState\" class=\"search-header\">\n        <div class=\"empty-state\">\n            <div class=\"empty-icon\">üì¶</div>\n            <div class=\"empty-title\">Digite o n√∫mero de um pedido</div>\n            <div class=\"empty-text\">Veja localiza√ß√£o no mapa, timeline, dados do cliente e muito mais</div>\n        </div>\n    </div>\n\n    <!-- RESULTS SECTION -->\n    <div id=\"resultsSection\" class=\"results-section\">\n        <!-- Preenchido dinamicamente -->\n    </div>\n</div>\n\n<script>\n    // ========================================\n    // DADOS GLOBAIS\n    // ========================================\n    let allData = {\n        pedidos: [],\n        calculo: [],\n        rotas: []\n    };\n\n    // ========================================\n    // INICIALIZAR\n    // ========================================\n    function initPedidos() {\n        console.log('üì¶ Inicializando an√°lise de pedidos...');\n        updateStatus();\n    }\n\n    function updateStatus() {\n        const statusDiv = document.getElementById('dataStatus');\n        const pedidos = allData.pedidos;\n\n        if (pedidos.length === 0) {\n            statusDiv.innerHTML = '‚ö†Ô∏è Aguardando dados do Appsmith...';\n            statusDiv.style.color = '#f59e0b';\n        } else {\n            statusDiv.innerHTML = `‚úÖ ${pedidos.length} pedidos carregados e prontos para busca`;\n            statusDiv.style.color = '#10b981';\n        }\n    }\n\n    // ========================================\n    // BUSCAR PEDIDO\n    // ========================================\n    function searchPedido() {\n        const inputValue = document.getElementById('searchInput').value.trim();\n        \n        if (!inputValue) {\n            alert('Por favor, digite o n√∫mero de um pedido!');\n            return;\n        }\n\n        console.log('üîç Buscando pedido:', inputValue);\n\n        // Buscar nos 3 datasources\n        const pedidoData = allData.pedidos.find(p => String(p.PEDIDO) === inputValue);\n        const calculoData = allData.calculo.find(c => String(c.PEDIDO) === inputValue);\n        const rotaData = allData.rotas.find(r => String(r.pedido_numero) === inputValue);\n\n        console.log('üì¶ Pedido encontrado:', pedidoData);\n        console.log('üìä C√°lculo encontrado:', calculoData);\n        console.log('üó∫Ô∏è Rota encontrada:', rotaData);\n\n        if (!pedidoData && !calculoData && !rotaData) {\n            alert(`‚ùå Pedido ${inputValue} n√£o encontrado!\\n\\n` +\n                  `Total de pedidos dispon√≠veis: ${allData.pedidos.length}\\n\\n` +\n                  `Verifique se o n√∫mero est√° correto.`);\n            return;\n        }\n\n        // Processar e exibir\n        processPedido(inputValue, pedidoData, calculoData, rotaData);\n    }\n\n    // ========================================\n    // PROCESSAR PEDIDO\n    // ========================================\n    function processPedido(pedidoNum, pedido, calculo, rota) {\n        document.getElementById('emptyState').style.display = 'none';\n        const section = document.getElementById('resultsSection');\n        section.classList.add('active');\n\n        // Determinar status\n        let statusClass = 'pendente';\n        let statusText = '‚è≥ PENDENTE';\n        let statusIcon = '‚è≥';\n\n        if (pedido) {\n            if (pedido.ENTREGA_CLIENTE && pedido.ENTREGA_CLIENTE !== 'null') {\n                statusClass = 'entregue';\n                statusText = '‚úÖ ENTREGUE';\n                statusIcon = '‚úÖ';\n            } else if (pedido.INICIO_ROTA && pedido.INICIO_ROTA !== 'null') {\n                statusClass = 'em-rota';\n                statusText = 'üöö EM ROTA';\n                statusIcon = 'üöö';\n            }\n        }\n\n        // Coordenadas\n        const lat = pedido?.LATITUDE || calculo?.LATITUDE || null;\n        const lng = pedido?.LONGITUDE || calculo?.LONGITUDE || null;\n        const filialLat = pedido?.FILIAL_LATITUDE || calculo?.['FILIAL.LATITUDE'] || null;\n        const filialLng = pedido?.FILIAL_LONGITUDE || calculo?.['FILIAL.LONGITUDE'] || null;\n\n        // Gerar HTML\n        let html = `\n            <!-- PEDIDO HEADER -->\n            <div class=\"pedido-header\">\n                <div class=\"pedido-number\">\n                    üì¶ Pedido #${pedidoNum}\n                    <span class=\"status-badge ${statusClass}\">${statusText}</span>\n                </div>\n                <div class=\"pedido-subtitle\">\n                    ${pedido ? `Cliente: ${pedido.RAZAO_SOCIAL || 'N/A'} ‚Ä¢ ` : ''}\n                    ${pedido ? `Motoboy: ${pedido.MOTOBOY || 'N/A'} ‚Ä¢ ` : ''}\n                    ${pedido ? `Sa√≠da: #${pedido.SAIDAID || 'N/A'}` : ''}\n                </div>\n            </div>\n\n            <!-- TWO COLUMN LAYOUT -->\n            <div class=\"two-column\">\n                <!-- MAPA -->\n                <div class=\"map-section\">\n                    <div class=\"map-title\">üó∫Ô∏è Localiza√ß√£o no Mapa</div>\n                    ${lat && lng ? `\n                        <iframe \n                            class=\"map-frame\"\n                            frameborder=\"0\" \n                            scrolling=\"no\" \n                            marginheight=\"0\" \n                            marginwidth=\"0\" \n                            src=\"https://maps.google.com/maps?q=${lat},${lng}&hl=pt-BR&z=15&output=embed\">\n                        </iframe>\n                        <div class=\"map-coordinates\">\n                            <div class=\"coord-item\">\n                                <div>\n                                    <div class=\"coord-label\">üìç Latitude</div>\n                                    <div class=\"coord-value\">${lat}</div>\n                                </div>\n                            </div>\n                            <div class=\"coord-item\">\n                                <div>\n                                    <div class=\"coord-label\">üìç Longitude</div>\n                                    <div class=\"coord-value\">${lng}</div>\n                                </div>\n                            </div>\n                        </div>\n                        ${rota?.url ? `\n                            <a href=\"${rota.url}\" target=\"_blank\" class=\"route-link\" style=\"margin-top: 16px;\">\n                                üó∫Ô∏è Abrir Rota Completa no Google Maps\n                            </a>\n                        ` : ''}\n                    ` : `\n                        <div style=\"text-align: center; padding: 60px 20px; color: #9ca3af;\">\n                            <div style=\"font-size: 48px; margin-bottom: 12px;\">üó∫Ô∏è</div>\n                            <div style=\"font-weight: 600;\">Coordenadas n√£o dispon√≠veis</div>\n                        </div>\n                    `}\n                </div>\n\n                <!-- DADOS DO CLIENTE -->\n                <div class=\"info-section\">\n                    <div class=\"info-title\">üë§ Dados do Cliente</div>\n                    <div class=\"info-grid\">\n                        ${pedido ? `\n                            <div class=\"info-item\">\n                                <div class=\"info-icon\">üè¢</div>\n                                <div class=\"info-content\">\n                                    <div class=\"info-label\">Raz√£o Social</div>\n                                    <div class=\"info-value large\">${pedido.RAZAO_SOCIAL || 'N/A'}</div>\n                                </div>\n                            </div>\n                            <div class=\"info-item\">\n                                <div class=\"info-icon\">üìç</div>\n                                <div class=\"info-content\">\n                                    <div class=\"info-label\">Endere√ßo Completo</div>\n                                    <div class=\"info-value\">${pedido.ENDERECO || 'N/A'}</div>\n                                </div>\n                            </div>\n                            <div class=\"info-item\">\n                                <div class=\"info-icon\">üèôÔ∏è</div>\n                                <div class=\"info-content\">\n                                    <div class=\"info-label\">Cidade / Estado</div>\n                                    <div class=\"info-value\">${pedido.CIDADE || 'N/A'} - ${pedido.ESTADO || 'N/A'}</div>\n                                </div>\n                            </div>\n                            <div class=\"info-item\">\n                                <div class=\"info-icon\">üìÆ</div>\n                                <div class=\"info-content\">\n                                    <div class=\"info-label\">CEP</div>\n                                    <div class=\"info-value\">${pedido.CEP || calculo?.CEP || 'N/A'}</div>\n                                </div>\n                            </div>\n                            <div class=\"info-item\">\n                                <div class=\"info-icon\">üÜî</div>\n                                <div class=\"info-content\">\n                                    <div class=\"info-label\">C√≥digo Cliente</div>\n                                    <div class=\"info-value\">${pedido.COD_CLI || calculo?.CODIGOCLIENTE || 'N/A'}</div>\n                                </div>\n                            </div>\n                        ` : '<div class=\"info-item\"><div class=\"info-value\">Dados n√£o dispon√≠veis</div></div>'}\n                    </div>\n                </div>\n            </div>\n\n            <!-- TIMELINE -->\n            ${pedido ? renderTimeline(pedido) : ''}\n\n            <!-- DADOS DA ROTA -->\n            ${(calculo || rota) ? renderRouteDetails(calculo, rota, pedido) : ''}\n\n            <!-- DADOS DA ENTREGA -->\n            ${pedido ? renderDeliveryInfo(pedido) : ''}\n\n            <!-- TODOS OS DADOS -->\n            ${renderAllData(pedido, calculo, rota)}\n        `;\n\n        section.innerHTML = html;\n        section.scrollIntoView({ behavior: 'smooth', block: 'start' });\n    }\n\n    // ========================================\n    // RENDERIZAR TIMELINE\n    // ========================================\n    function renderTimeline(pedido) {\n        const events = [];\n\n        if (pedido.INICIO_ROTA && pedido.INICIO_ROTA !== 'null') {\n            events.push({\n                time: pedido.INICIO_ROTA,\n                text: `üöÄ In√≠cio da Rota - Motoboy ${pedido.MOTOBOY || 'N/A'} saiu da ${pedido.CIDADEFILIAL || 'filial'}`,\n                completed: true\n            });\n        }\n\n        if (pedido.ENTREGA_CLIENTE && pedido.ENTREGA_CLIENTE !== 'null') {\n            events.push({\n                time: pedido.ENTREGA_CLIENTE,\n                text: `‚úÖ Pedido Entregue ao Cliente - ${pedido.RAZAO_SOCIAL || 'N/A'}`,\n                completed: true\n            });\n        }\n\n        if (pedido.FIM_ROTA && pedido.FIM_ROTA !== 'null') {\n            events.push({\n                time: pedido.FIM_ROTA,\n                text: `üèÅ Fim da Rota - Retorno √† ${pedido.CIDADEFILIAL || 'filial'}`,\n                completed: true\n            });\n        }\n\n        if (events.length === 0) {\n            return '';\n        }\n\n        return `\n            <div class=\"timeline-section\">\n                <div class=\"timeline-title\">üìÖ Timeline do Pedido</div>\n                <div class=\"timeline\">\n                    ${events.map(e => `\n                        <div class=\"timeline-item ${e.completed ? 'completed' : ''}\">\n                            <div class=\"timeline-content\">\n                                <div class=\"timeline-time\">${formatDateTime(e.time)}</div>\n                                <div class=\"timeline-text\">${e.text}</div>\n                            </div>\n                        </div>\n                    `).join('')}\n                </div>\n            </div>\n        `;\n    }\n\n    // ========================================\n    // RENDERIZAR DETALHES DA ROTA\n    // ========================================\n    function renderRouteDetails(calculo, rota, pedido) {\n        const km = calculo?.KM || (rota?.distancia_total_rota_metros ? (rota.distancia_total_rota_metros / 1000).toFixed(1) : null);\n        const tempo = calculo?.TEMPO || (rota?.duracao_total_rota_seg ? Math.floor(rota.duracao_total_rota_seg / 60) + ' minutos' : null);\n        const retorno = calculo?.RETORNO || null;\n\n        if (!km && !tempo && !rota) return '';\n\n        return `\n            <div class=\"route-section\">\n                <div class=\"route-title\">üöó Informa√ß√µes da Rota</div>\n                <div class=\"route-stats\">\n                    ${km ? `\n                        <div class=\"route-stat\">\n                            <div class=\"route-stat-label\">üöó Dist√¢ncia</div>\n                            <div class=\"route-stat-value\">${km} km</div>\n                        </div>\n                    ` : ''}\n                    ${tempo ? `\n                        <div class=\"route-stat\">\n                            <div class=\"route-stat-label\">‚è±Ô∏è Tempo Previsto</div>\n                            <div class=\"route-stat-value\">${tempo}</div>\n                        </div>\n                    ` : ''}\n                    ${retorno ? `\n                        <div class=\"route-stat\">\n                            <div class=\"route-stat-label\">üîÑ Tempo Retorno</div>\n                            <div class=\"route-stat-value\">${retorno}</div>\n                        </div>\n                    ` : ''}\n                    ${rota?.rota_cliente ? `\n                        <div class=\"route-stat\">\n                            <div class=\"route-stat-label\">üìã Rota</div>\n                            <div class=\"route-stat-value\" style=\"font-size: 14px;\">${rota.rota_cliente}</div>\n                        </div>\n                    ` : ''}\n                </div>\n                ${rota?.url ? `\n                    <a href=\"${rota.url}\" target=\"_blank\" class=\"route-link\">\n                        üó∫Ô∏è Abrir Rota Completa no Google Maps\n                    </a>\n                ` : ''}\n            </div>\n        `;\n    }\n\n    // ========================================\n    // RENDERIZAR INFO DA ENTREGA\n    // ========================================\n    function renderDeliveryInfo(pedido) {\n        const inicio = pedido.INICIO_ROTA && pedido.INICIO_ROTA !== 'null' ? new Date(pedido.INICIO_ROTA) : null;\n        const entrega = pedido.ENTREGA_CLIENTE && pedido.ENTREGA_CLIENTE !== 'null' ? new Date(pedido.ENTREGA_CLIENTE) : null;\n        const fim = pedido.FIM_ROTA && pedido.FIM_ROTA !== 'null' ? new Date(pedido.FIM_ROTA) : null;\n\n        const duracaoEntrega = inicio && entrega ? Math.floor((entrega - inicio) / 60000) : null;\n        const duracaoRetorno = entrega && fim ? Math.floor((fim - entrega) / 60000) : null;\n        const duracaoTotal = inicio && fim ? Math.floor((fim - inicio) / 60000) : null;\n\n        return `\n            <div class=\"two-column\">\n                <div class=\"info-section\">\n                    <div class=\"info-title\">üèçÔ∏è Dados do Motoboy</div>\n                    <div class=\"info-grid\">\n                        <div class=\"info-item\">\n                            <div class=\"info-icon\">üë§</div>\n                            <div class=\"info-content\">\n                                <div class=\"info-label\">Motoboy</div>\n                                <div class=\"info-value large\">${pedido.MOTOBOY || 'N/A'}</div>\n                            </div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-icon\">üìã</div>\n                            <div class=\"info-content\">\n                                <div class=\"info-label\">ID da Sa√≠da</div>\n                                <div class=\"info-value\">${pedido.SAIDAID || 'N/A'}</div>\n                            </div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-icon\">üè¢</div>\n                            <div class=\"info-content\">\n                                <div class=\"info-label\">Filial</div>\n                                <div class=\"info-value\">${pedido.CIDADEFILIAL || 'N/A'}</div>\n                            </div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-icon\">üõ£Ô∏è</div>\n                            <div class=\"info-content\">\n                                <div class=\"info-label\">C√≥digo da Rota</div>\n                                <div class=\"info-value\">${pedido.CODROTA || 'N/A'}</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"info-section\">\n                    <div class=\"info-title\">‚è±Ô∏è Tempos de Execu√ß√£o</div>\n                    <div class=\"info-grid\">\n                        ${duracaoEntrega ? `\n                            <div class=\"info-item\">\n                                <div class=\"info-icon\">‚è±Ô∏è</div>\n                                <div class=\"info-content\">\n                                    <div class=\"info-label\">Tempo at√© Entrega</div>\n                                    <div class=\"info-value large\">${duracaoEntrega} minutos</div>\n                                </div>\n                            </div>\n                        ` : ''}\n                        ${duracaoRetorno ? `\n                            <div class=\"info-item\">\n                                <div class=\"info-icon\">üîÑ</div>\n                                <div class=\"info-content\">\n                                    <div class=\"info-label\">Tempo de Retorno</div>\n                                    <div class=\"info-value large\">${duracaoRetorno} minutos</div>\n                                </div>\n                            </div>\n                        ` : ''}\n                        ${duracaoTotal ? `\n                            <div class=\"info-item\">\n                                <div class=\"info-icon\">‚è∞</div>\n                                <div class=\"info-content\">\n                                    <div class=\"info-label\">Dura√ß√£o Total</div>\n                                    <div class=\"info-value large\">${duracaoTotal} minutos</div>\n                                </div>\n                            </div>\n                        ` : ''}\n                    </div>\n                </div>\n            </div>\n        `;\n    }\n\n    // ========================================\n    // RENDERIZAR TODOS OS DADOS\n    // ========================================\n    function renderAllData(pedido, calculo, rota) {\n        const allFields = {};\n\n        // Adicionar campos do pedido\n        if (pedido) {\n            Object.entries(pedido).forEach(([key, value]) => {\n                allFields[`PEDIDO.${key}`] = value;\n            });\n        }\n\n        // Adicionar campos do c√°lculo\n        if (calculo) {\n            Object.entries(calculo).forEach(([key, value]) => {\n                allFields[`CALCULO.${key}`] = value;\n            });\n        }\n\n        // Adicionar campos da rota\n        if (rota) {\n            Object.entries(rota).forEach(([key, value]) => {\n                allFields[`ROTA.${key}`] = value;\n            });\n        }\n\n        if (Object.keys(allFields).length === 0) {\n            return '';\n        }\n\n        return `\n            <div class=\"all-data-section\">\n                <div class=\"info-title\">üìã Todos os Dados Dispon√≠veis (${Object.keys(allFields).length} campos)</div>\n                <table class=\"data-table\">\n                    <thead>\n                        <tr>\n                            <th>Campo</th>\n                            <th>Valor</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ${Object.entries(allFields).map(([key, value]) => `\n                            <tr>\n                                <td><strong>${key}</strong></td>\n                                <td>${value !== null && value !== undefined && value !== '' ? value : '<span style=\"color: #9ca3af;\">N/A</span>'}</td>\n                            </tr>\n                        `).join('')}\n                    </tbody>\n                </table>\n            </div>\n        `;\n    }\n\n    // ========================================\n    // UTILIT√ÅRIOS\n    // ========================================\n    function formatDateTime(dateStr) {\n        if (!dateStr || dateStr === 'null') return '-';\n        try {\n            const date = new Date(dateStr);\n            return date.toLocaleString('pt-BR', {\n                day: '2-digit',\n                month: '2-digit',\n                year: 'numeric',\n                hour: '2-digit',\n                minute: '2-digit',\n                second: '2-digit'\n            });\n        } catch (e) {\n            return dateStr;\n        }\n    }\n\n    // ========================================\n    // INICIALIZAR\n    // ========================================\n    window.addEventListener('DOMContentLoaded', function() {\n        console.log('üöÄ DOM carregado...');\n        setTimeout(() => {\n            if (allData.pedidos.length > 0) {\n                initPedidos();\n            } else {\n                setTimeout(() => initPedidos(), 500);\n            }\n        }, 200);\n    });\n</script>\n\n<!-- Injetar dados do Appsmith -->\n<script>\n    {{\n        (() => {\n            const pedidos = pedidos_e_saidas_do_dia?.data || [];\n            const calculo = calculo_do_google?.data || { logistica_motoboy: [] };\n            const rotas = dmaplicativo_prod_rotas_otimiz?.data || [];\n            \n            return `\n                console.log('üì¶ Carregando dados para an√°lise de pedidos...');\n                console.log('üìä Pedidos:', ${pedidos.length});\n                console.log('üìä C√°lculos:', ${(calculo.logistica_motoboy || []).length});\n                console.log('üìä Rotas:', ${rotas.length});\n                \n                allData.pedidos = ${JSON.stringify(pedidos)};\n                allData.calculo = ${JSON.stringify(calculo.logistica_motoboy || [])};\n                allData.rotas = ${JSON.stringify(rotas)};\n                \n                console.log('‚úÖ Dados injetados!');\n                \n                setTimeout(() => {\n                    if (typeof initPedidos === 'function') {\n                        console.log('üöÄ Iniciando...');\n                        initPedidos();\n                    }\n                }, 150);\n            `;\n        })()\n    }}\n</script>\n\n",
  "topRow": 0,
  "type": "IFRAME_WIDGET",
  "version": 1,
  "widgetId": "zmc4er2mhr",
  "widgetName": "Iframe6"
}