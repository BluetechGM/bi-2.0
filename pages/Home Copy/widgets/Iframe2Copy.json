{
  "animateLoading": true,
  "borderOpacity": 100,
  "borderRadius": "{{appsmith.theme.borderRadius.appBorderRadius}}",
  "borderWidth": 1,
  "bottomRow": 112,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "dynamicBindingPathList": [
    {
      "key": "borderRadius"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "srcDoc"
    }
  ],
  "dynamicTriggerPathList": [],
  "flexVerticalAlignment": "start",
  "isLoading": false,
  "isVisible": true,
  "key": "v104wcek7u",
  "leftColumn": 0,
  "mobileBottomRow": 35,
  "mobileLeftColumn": 8,
  "mobileRightColumn": 32,
  "mobileTopRow": 3,
  "needsErrorInfo": false,
  "originalBottomRow": 112,
  "originalTopRow": 13,
  "parentColumnSpace": 19.9375,
  "parentId": "0",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "responsiveBehavior": "fill",
  "rightColumn": 64,
  "source": "https://www.example.com",
  "srcDoc": "<style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    \n    body {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;\n        background: #f5f7fa;\n        padding: 12px;\n        font-size: 11px;\n    }\n    \n    .intercorrencias-container {\n        max-width: 1600px;\n        margin: 0 auto;\n    }\n    \n    /* Header Principal */\n    .header-principal {\n        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n        border-radius: 16px;\n        padding: 24px;\n        margin-bottom: 24px;\n        box-shadow: 0 10px 40px rgba(239, 68, 68, 0.3);\n        color: white;\n        text-align: center;\n        position: relative;\n        overflow: hidden;\n    }\n    \n    .header-principal::before {\n        content: '';\n        position: absolute;\n        top: -50%;\n        left: -50%;\n        width: 200%;\n        height: 200%;\n        background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><circle cx=\"50\" cy=\"50\" r=\"2\" fill=\"rgba(255,255,255,0.1)\"/></svg>') repeat;\n        animation: float 20s infinite linear;\n        pointer-events: none;\n    }\n    \n    @keyframes float {\n        0% { transform: translate(-50%, -50%) rotate(0deg); }\n        100% { transform: translate(-50%, -50%) rotate(360deg); }\n    }\n    \n    .header-title {\n        font-size: 36px;\n        font-weight: 900;\n        margin-bottom: 8px;\n        position: relative;\n        z-index: 1;\n    }\n    \n    .header-subtitle {\n        font-size: 16px;\n        font-weight: 600;\n        opacity: 0.9;\n        position: relative;\n        z-index: 1;\n    }\n    \n    /* Indicador Ao Vivo */\n    .live-indicator {\n        position: absolute;\n        top: 20px;\n        right: 20px;\n        background: rgba(255, 255, 255, 0.2);\n        padding: 8px 12px;\n        border-radius: 20px;\n        font-size: 12px;\n        font-weight: 700;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n    \n    .live-dot {\n        width: 10px;\n        height: 10px;\n        background: #10b981;\n        border-radius: 50%;\n        animation: pulse 2s infinite;\n    }\n    \n    @keyframes pulse {\n        0%, 100% { opacity: 1; transform: scale(1); }\n        50% { opacity: 0.7; transform: scale(1.1); }\n    }\n    \n    /* Controles */\n    .controles-header {\n        position: absolute;\n        bottom: 20px;\n        right: 20px;\n        display: flex;\n        gap: 12px;\n    }\n    \n    .btn-controle {\n        background: rgba(255, 255, 255, 0.2);\n        color: white;\n        border: 2px solid rgba(255, 255, 255, 0.3);\n        padding: 8px 16px;\n        border-radius: 8px;\n        font-size: 12px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .btn-controle:hover {\n        background: rgba(255, 255, 255, 0.3);\n        transform: translateY(-2px);\n    }\n    \n    /* Stats Cards */\n    .stats-row {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 16px;\n        margin-bottom: 24px;\n    }\n    \n    .stat-card {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        text-align: center;\n        transition: transform 0.2s;\n        border-top: 4px solid #ef4444;\n    }\n    \n    .stat-card:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 8px 20px rgba(0,0,0,0.15);\n    }\n    \n    .stat-value {\n        font-size: 32px;\n        font-weight: 900;\n        color: #ef4444;\n        line-height: 1;\n        margin-bottom: 8px;\n    }\n    \n    .stat-label {\n        font-size: 12px;\n        font-weight: 600;\n        color: #6b7280;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    /* Filtros */\n    .filtros-section {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        margin-bottom: 24px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        border-left: 5px solid #1890ff;\n    }\n    \n    .filtros-title {\n        font-size: 18px;\n        font-weight: 700;\n        color: #1890ff;\n        margin-bottom: 16px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n    \n    .filtros-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n        gap: 16px;\n    }\n    \n    .filtro-grupo {\n        display: flex;\n        flex-direction: column;\n        gap: 6px;\n    }\n    \n    .filtro-label {\n        font-size: 11px;\n        font-weight: 700;\n        color: #6b7280;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    .filtro-control {\n        padding: 10px 12px;\n        border: 2px solid #e5e7eb;\n        border-radius: 8px;\n        font-size: 12px;\n        background: white;\n        color: #374151;\n        font-weight: 600;\n        transition: all 0.2s;\n    }\n    \n    .filtro-control:focus {\n        outline: none;\n        border-color: #1890ff;\n        box-shadow: 0 0 0 3px rgba(24, 144, 255, 0.1);\n    }\n    \n    .btn-limpar-filtros {\n        background: #ef4444;\n        color: white;\n        border: none;\n        padding: 10px 20px;\n        border-radius: 8px;\n        font-size: 12px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .btn-limpar-filtros:hover {\n        background: #dc2626;\n        transform: translateY(-2px);\n    }\n    \n    /* Sistema de Abas */\n    .tabs-container {\n        background: white;\n        border-radius: 12px;\n        margin-bottom: 24px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        overflow: hidden;\n    }\n    \n    .tabs-header {\n        display: flex;\n        border-bottom: 3px solid #f3f4f6;\n        background: #f9fafb;\n    }\n    \n    .tab-button {\n        flex: 1;\n        padding: 16px 24px;\n        background: transparent;\n        border: none;\n        font-size: 14px;\n        font-weight: 700;\n        color: #6b7280;\n        cursor: pointer;\n        transition: all 0.3s;\n        border-bottom: 3px solid transparent;\n        margin-bottom: -3px;\n    }\n    \n    .tab-button:hover {\n        background: #f3f4f6;\n        color: #1f2937;\n    }\n    \n    .tab-button.active {\n        color: #ef4444;\n        background: white;\n        border-bottom: 3px solid #ef4444;\n    }\n    \n    .tab-content {\n        display: none;\n        padding: 24px;\n    }\n    \n    .tab-content.active {\n        display: block;\n    }\n    \n    /* Controles de Visualiza√ß√£o */\n    .view-controls {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 20px;\n    }\n    \n    .btn-modo {\n        background: white;\n        color: #1890ff;\n        border: 2px solid #1890ff;\n        padding: 8px 16px;\n        border-radius: 8px;\n        font-size: 12px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .btn-modo.ativo {\n        background: #1890ff;\n        color: white;\n    }\n    \n    .btn-modo:hover {\n        background: #1890ff;\n        color: white;\n        transform: translateY(-1px);\n    }\n    \n    /* Cards Grid */\n    .intercorrencias-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));\n        gap: 20px;\n    }\n    \n    /* Card de Intercorr√™ncia */\n    .intercorrencia-card {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.1);\n        border-left: 5px solid #ef4444;\n        transition: all 0.3s;\n        position: relative;\n        overflow: hidden;\n    }\n    \n    .intercorrencia-card:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 8px 20px rgba(239, 68, 68, 0.2);\n    }\n    \n    .card-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 16px;\n        padding-bottom: 12px;\n        border-bottom: 2px solid #f3f4f6;\n    }\n    \n    .intercorrencia-id {\n        font-size: 20px;\n        font-weight: 900;\n        color: #ef4444;\n        background: #fef2f2;\n        padding: 8px 12px;\n        border-radius: 8px;\n        border: 2px solid #ef4444;\n    }\n    \n    .badge-status {\n        padding: 6px 12px;\n        border-radius: 20px;\n        font-size: 11px;\n        font-weight: 700;\n        text-transform: uppercase;\n    }\n    \n    .status-pendente {\n        background: #fef3c7;\n        color: #92400e;\n        border: 2px solid #f59e0b;\n    }\n    \n    .status-aprovado {\n        background: #d1fae5;\n        color: #065f46;\n        border: 2px solid #10b981;\n    }\n    \n    .badge-cidade {\n        background: #1890ff;\n        color: white;\n        padding: 4px 8px;\n        border-radius: 6px;\n        font-size: 12px;\n        font-weight: 700;\n        margin-left: 8px;\n    }\n    \n    /* Informa√ß√µes do Card */\n    .card-info {\n        display: grid;\n        grid-template-columns: repeat(2, 1fr);\n        gap: 12px;\n        margin-bottom: 16px;\n    }\n    \n    .info-item {\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n    }\n    \n    .info-label {\n        font-size: 10px;\n        font-weight: 700;\n        color: #9ca3af;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n    }\n    \n    .info-value {\n        font-size: 14px;\n        font-weight: 600;\n        color: #1f2937;\n    }\n    \n    /* Se√ß√£o Motoboy */\n    .motoboy-info {\n        background: #f0f9ff;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 16px;\n        border-left: 4px solid #1890ff;\n    }\n    \n    .motoboy-nome {\n        font-size: 16px;\n        font-weight: 700;\n        color: #1890ff;\n        margin-bottom: 4px;\n    }\n    \n    .motoboy-codigo {\n        font-size: 12px;\n        color: #6b7280;\n    }\n    \n    /* Tempo */\n    .tempo-info {\n        background: #fff7ed;\n        border-radius: 8px;\n        padding: 12px;\n        text-align: center;\n        border: 2px solid #f59e0b;\n        margin-bottom: 16px;\n    }\n    \n    .tempo-valor {\n        font-size: 20px;\n        font-weight: 900;\n        color: #f59e0b;\n        font-family: 'Courier New', monospace;\n        margin-bottom: 4px;\n    }\n    \n    .tempo-label {\n        font-size: 11px;\n        color: #92400e;\n        font-weight: 600;\n        text-transform: uppercase;\n    }\n    \n    /* Descri√ß√£o */\n    .descricao-info {\n        background: #fef2f2;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 16px;\n        border-left: 4px solid #ef4444;\n    }\n    \n    .descricao-titulo {\n        font-size: 12px;\n        font-weight: 700;\n        color: #ef4444;\n        text-transform: uppercase;\n        margin-bottom: 8px;\n    }\n    \n    .descricao-texto {\n        font-size: 13px;\n        color: #1f2937;\n        line-height: 1.4;\n    }\n    \n    /* Aprova√ß√£o */\n    .aprovacao-section {\n        background: #f9fafb;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 16px;\n        border: 2px solid #d1d5db;\n    }\n    \n    .aprovacao-pendente {\n        border-color: #f59e0b;\n        background: #fffbeb;\n    }\n    \n    .aprovacao-aprovada {\n        border-color: #10b981;\n        background: #ecfdf5;\n    }\n    \n    .aprovacao-titulo {\n        font-size: 12px;\n        font-weight: 700;\n        margin-bottom: 6px;\n        text-transform: uppercase;\n    }\n    \n    .aprovacao-pendente .aprovacao-titulo {\n        color: #f59e0b;\n    }\n    \n    .aprovacao-aprovada .aprovacao-titulo {\n        color: #10b981;\n    }\n    \n    .aprovacao-info {\n        font-size: 12px;\n        color: #6b7280;\n    }\n    \n    /* Imagem */\n    .imagem-section {\n        margin-bottom: 16px;\n    }\n    \n    .imagem-container {\n        position: relative;\n        border-radius: 8px;\n        overflow: hidden;\n        border: 2px solid #e5e7eb;\n        background: #f9fafb;\n        height: 200px;\n    }\n    \n    .imagem-intercorrencia {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n        cursor: pointer;\n        transition: transform 0.3s;\n    }\n    \n    .imagem-intercorrencia:hover {\n        transform: scale(1.05);\n    }\n    \n    .sem-imagem {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        height: 100%;\n        color: #9ca3af;\n        font-size: 16px;\n        font-weight: 600;\n    }\n    \n    .btn-ver-imagem {\n        background: #8b5cf6;\n        color: white;\n        padding: 8px 16px;\n        border: none;\n        border-radius: 6px;\n        font-size: 12px;\n        font-weight: 600;\n        cursor: pointer;\n        transition: all 0.2s;\n        margin-top: 8px;\n        width: 100%;\n    }\n    \n    .btn-ver-imagem:hover {\n        background: #7c3aed;\n        transform: translateY(-2px);\n    }\n    \n    /* Rodap√© do Card */\n    .card-footer {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding-top: 12px;\n        border-top: 2px solid #f3f4f6;\n        margin-top: 16px;\n        font-size: 11px;\n        color: #6b7280;\n    }\n    \n    .lancamento-info {\n        display: flex;\n        flex-direction: column;\n        gap: 2px;\n    }\n    \n    .lancamento-nome {\n        font-weight: 700;\n        color: #1f2937;\n    }\n    \n    /* Lista Compacta */\n    .intercorrencias-lista {\n        background: white;\n        border-radius: 12px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        overflow: hidden;\n        display: none;\n    }\n    \n    .lista-header {\n        background: #ef4444;\n        color: white;\n        padding: 12px 16px;\n        font-size: 12px;\n        font-weight: 700;\n        display: grid;\n        grid-template-columns: 80px 100px 150px 100px 120px 120px 1fr 100px;\n        gap: 8px;\n        border-bottom: 2px solid #dc2626;\n    }\n    \n    .lista-item {\n        display: grid;\n        grid-template-columns: 80px 100px 150px 100px 120px 120px 1fr 100px;\n        gap: 8px;\n        padding: 12px 16px;\n        border-bottom: 1px solid #f3f4f6;\n        align-items: center;\n        font-size: 11px;\n        transition: background 0.2s;\n        cursor: pointer;\n    }\n    \n    .lista-item:hover {\n        background: #fef2f2;\n    }\n    \n    .lista-item.pendente {\n        border-left: 4px solid #f59e0b;\n    }\n    \n    .lista-item.aprovado {\n        border-left: 4px solid #10b981;\n    }\n    \n    /* Status badges na lista */\n    .status-badge {\n        padding: 4px 8px;\n        border-radius: 4px;\n        font-size: 9px;\n        font-weight: 700;\n        text-align: center;\n        text-transform: uppercase;\n    }\n    \n    .status-badge.pendente {\n        background: #fef3c7;\n        color: #92400e;\n    }\n    \n    .status-badge.aprovado {\n        background: #d1fae5;\n        color: #065f46;\n    }\n    \n    /* Sem dados */\n    .sem-intercorrencias {\n        text-align: center;\n        padding: 80px;\n        background: white;\n        border-radius: 16px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n    }\n    \n    .sem-intercorrencias-icon {\n        font-size: 80px;\n        margin-bottom: 20px;\n    }\n    \n    .sem-intercorrencias-texto {\n        font-size: 24px;\n        font-weight: 700;\n        color: #10b981;\n        margin-bottom: 8px;\n    }\n    \n    .sem-intercorrencias-subtexto {\n        font-size: 14px;\n        color: #6b7280;\n    }\n    \n    /* Modal */\n    .modal {\n        display: none;\n        position: fixed;\n        z-index: 1000;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0,0,0,0.8);\n        animation: fadeIn 0.3s;\n    }\n    \n    @keyframes fadeIn {\n        from { opacity: 0; }\n        to { opacity: 1; }\n    }\n    \n    .modal-content {\n        background-color: white;\n        margin: 3% auto;\n        padding: 20px;\n        border-radius: 12px;\n        max-width: 90%;\n        max-height: 90%;\n        overflow: auto;\n        animation: slideIn 0.3s;\n    }\n    \n    @keyframes slideIn {\n        from { transform: translateY(-50px); opacity: 0; }\n        to { transform: translateY(0); opacity: 1; }\n    }\n    \n    .modal-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 20px;\n        border-bottom: 2px solid #ef4444;\n        padding-bottom: 10px;\n    }\n    \n    .modal-title {\n        color: #ef4444;\n        font-size: 20px;\n        font-weight: 700;\n    }\n    \n    .close {\n        color: #9ca3af;\n        font-size: 28px;\n        font-weight: bold;\n        cursor: pointer;\n        transition: all 0.2s;\n        width: 36px;\n        height: 36px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border-radius: 50%;\n    }\n    \n    .close:hover {\n        color: white;\n        background: #ef4444;\n        transform: rotate(90deg);\n    }\n    \n    /* Modal de Timeline */\n    .timeline-modal-item {\n        background: #f9fafb;\n        border-radius: 12px;\n        padding: 16px;\n        margin-bottom: 12px;\n        border-left: 5px solid #ef4444;\n        transition: all 0.3s;\n        cursor: pointer;\n    }\n    \n    .timeline-modal-item:hover {\n        transform: translateX(5px);\n        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);\n        background: white;\n    }\n    \n    .timeline-modal-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 12px;\n    }\n    \n    .timeline-modal-id {\n        font-size: 18px;\n        font-weight: 900;\n        color: #ef4444;\n    }\n    \n    .timeline-modal-status {\n        padding: 4px 12px;\n        border-radius: 20px;\n        font-size: 11px;\n        font-weight: 700;\n    }\n    \n    .timeline-modal-info {\n        display: grid;\n        grid-template-columns: repeat(2, 1fr);\n        gap: 8px;\n        font-size: 12px;\n        color: #6b7280;\n    }\n    \n    .timeline-modal-desc {\n        margin-top: 12px;\n        padding-top: 12px;\n        border-top: 1px solid #e5e7eb;\n        font-size: 13px;\n        color: #1f2937;\n    }\n    \n    .modal-stats-bar {\n        display: flex;\n        gap: 12px;\n        margin-bottom: 20px;\n        padding: 16px;\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        border-radius: 12px;\n        color: white;\n    }\n    \n    .modal-stat-item {\n        flex: 1;\n        text-align: center;\n    }\n    \n    .modal-stat-value {\n        font-size: 28px;\n        font-weight: 900;\n        margin-bottom: 4px;\n    }\n    \n    .modal-stat-label {\n        font-size: 11px;\n        opacity: 0.9;\n        text-transform: uppercase;\n    }\n    \n    /* Loading */\n    .loading {\n        text-align: center;\n        padding: 40px;\n        color: #6b7280;\n        font-size: 16px;\n    }\n    \n    /* Estilos para Gr√°ficos/Analytics */\n    .chart-item {\n        background: #f9fafb;\n        border: 2px solid #e5e7eb;\n        border-radius: 8px;\n        padding: 12px;\n        text-align: center;\n        transition: all 0.2s;\n        cursor: pointer;\n    }\n    \n    .chart-item:hover {\n        border-color: #10b981;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(16, 185, 129, 0.1);\n    }\n    \n    .chart-label {\n        font-size: 12px;\n        font-weight: 700;\n        color: #1f2937;\n        margin-bottom: 8px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n    }\n    \n    .chart-stats {\n        display: flex;\n        justify-content: space-between;\n        gap: 8px;\n        margin-bottom: 6px;\n    }\n    \n    .chart-stat {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        flex: 1;\n    }\n    \n    .chart-value {\n        font-size: 16px;\n        font-weight: 800;\n        margin-bottom: 2px;\n    }\n    \n    .chart-value.tempo {\n        color: #f59e0b;\n        font-family: 'Courier New', monospace;\n    }\n    \n    .chart-value.quantidade {\n        color: #ef4444;\n    }\n    \n    .chart-value.aprovadas {\n        color: #10b981;\n    }\n    \n    .chart-sublabel {\n        font-size: 9px;\n        font-weight: 600;\n        color: #6b7280;\n        text-transform: uppercase;\n    }\n    \n    .chart-barra {\n        width: 100%;\n        height: 6px;\n        background: #e5e7eb;\n        border-radius: 3px;\n        overflow: hidden;\n        margin-top: 4px;\n    }\n    \n    .chart-progress {\n        height: 100%;\n        background: linear-gradient(90deg, #ef4444 0%, #f59e0b 50%, #10b981 100%);\n        transition: width 0.5s ease;\n    }\n    \n    /* Rankings */\n    .ranking-item {\n        background: white;\n        border: 2px solid #e5e7eb;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 8px;\n    }\n    \n    .ranking-header {\n        font-size: 12px;\n        font-weight: 700;\n        text-align: center;\n        margin-bottom: 8px;\n        padding-bottom: 6px;\n        border-bottom: 2px solid #e5e7eb;\n    }\n    \n    .ranking-list {\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n    }\n    \n    .ranking-entry {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 4px 0;\n        font-size: 11px;\n        border-bottom: 1px solid #f3f4f6;\n    }\n    \n    .ranking-position {\n        background: #6b7280;\n        color: white;\n        padding: 2px 6px;\n        border-radius: 4px;\n        font-weight: 700;\n        margin-right: 8px;\n        min-width: 24px;\n        text-align: center;\n    }\n    \n    .ranking-position.primeiro {\n        background: #ef4444;\n    }\n    \n    .ranking-position.segundo {\n        background: #f59e0b;\n    }\n    \n    .ranking-position.terceiro {\n        background: #10b981;\n    }\n    \n    /* Gr√°ficos Avan√ßados */\n    .chart-container {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        margin-bottom: 24px;\n    }\n    \n    .chart-title {\n        font-size: 16px;\n        font-weight: 700;\n        color: #1f2937;\n        margin-bottom: 16px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n    }\n    \n    .chart-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n        gap: 20px;\n    }\n    \n    /* Gr√°fico de Barras Horizontal */\n    .bar-chart {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n    }\n    \n    .bar-item {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n    }\n    \n    .bar-label {\n        min-width: 80px;\n        font-size: 12px;\n        font-weight: 600;\n        color: #374151;\n    }\n    \n    .bar-wrapper {\n        flex: 1;\n        height: 30px;\n        background: #f3f4f6;\n        border-radius: 6px;\n        overflow: hidden;\n        position: relative;\n    }\n    \n    .bar-fill {\n        height: 100%;\n        background: linear-gradient(90deg, #ef4444, #f59e0b);\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        padding-right: 8px;\n        transition: width 0.5s ease;\n    }\n    \n    .bar-value {\n        font-size: 11px;\n        font-weight: 700;\n        color: white;\n    }\n    \n    /* Heatmap */\n    .heatmap-grid {\n        display: grid;\n        grid-template-columns: repeat(24, 1fr);\n        gap: 4px;\n    }\n    \n    .heatmap-cell {\n        aspect-ratio: 1;\n        border-radius: 4px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 10px;\n        font-weight: 700;\n        cursor: pointer;\n        transition: transform 0.2s;\n    }\n    \n    .heatmap-cell:hover {\n        transform: scale(1.2);\n        z-index: 10;\n        box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n    }\n    \n    /* Timeline Chart */\n    .timeline-chart {\n        position: relative;\n        height: 300px;\n        background: linear-gradient(to bottom, #f9fafb 0%, white 100%);\n        border-radius: 12px;\n        padding: 20px;\n        border: 2px solid #e5e7eb;\n    }\n    \n    .timeline-line {\n        position: relative;\n        height: 200px;\n        margin: 20px 0;\n    }\n    \n    .timeline-svg {\n        width: 100%;\n        height: 100%;\n    }\n    \n    .timeline-point {\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n    \n    .timeline-point:hover {\n        r: 8;\n    }\n    \n    .timeline-labels {\n        display: flex;\n        justify-content: space-between;\n        font-size: 10px;\n        color: #6b7280;\n        font-weight: 600;\n        margin-top: 10px;\n    }\n    \n    .heatmap-legend {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        gap: 8px;\n        margin-top: 12px;\n        font-size: 11px;\n    }\n    \n    .heatmap-legend-item {\n        display: flex;\n        align-items: center;\n        gap: 4px;\n    }\n    \n    .heatmap-color {\n        width: 20px;\n        height: 20px;\n        border-radius: 4px;\n    }\n    \n    /* Cards de Insight */\n    .insight-card {\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n    }\n    \n    .insight-icon {\n        font-size: 32px;\n        margin-bottom: 12px;\n    }\n    \n    .insight-title {\n        font-size: 14px;\n        font-weight: 700;\n        margin-bottom: 8px;\n        opacity: 0.9;\n    }\n    \n    .insight-value {\n        font-size: 28px;\n        font-weight: 900;\n        margin-bottom: 4px;\n    }\n    \n    .insight-description {\n        font-size: 11px;\n        opacity: 0.8;\n    }\n    \n    /* Cards de Performance */\n    .performance-card {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        border-left: 5px solid #1890ff;\n        transition: all 0.3s;\n    }\n    \n    .performance-card:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 8px 20px rgba(0,0,0,0.15);\n    }\n    \n    .performance-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 16px;\n        padding-bottom: 12px;\n        border-bottom: 2px solid #f3f4f6;\n    }\n    \n    .performance-name {\n        font-size: 18px;\n        font-weight: 700;\n        color: #1f2937;\n    }\n    \n    .performance-badge {\n        background: #1890ff;\n        color: white;\n        padding: 4px 12px;\n        border-radius: 20px;\n        font-size: 11px;\n        font-weight: 700;\n    }\n    \n    .performance-stats {\n        display: grid;\n        grid-template-columns: repeat(3, 1fr);\n        gap: 12px;\n        margin-bottom: 12px;\n    }\n    \n    .performance-stat {\n        text-align: center;\n        padding: 12px;\n        background: #f9fafb;\n        border-radius: 8px;\n    }\n    \n    .performance-stat-value {\n        font-size: 24px;\n        font-weight: 900;\n        color: #ef4444;\n        margin-bottom: 4px;\n    }\n    \n    .performance-stat-label {\n        font-size: 10px;\n        color: #6b7280;\n        text-transform: uppercase;\n        font-weight: 600;\n    }\n    \n    /* Tabela Comparativa */\n    .comparison-table {\n        width: 100%;\n        border-collapse: collapse;\n        background: white;\n        border-radius: 12px;\n        overflow: hidden;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n    }\n    \n    .comparison-table thead {\n        background: #1890ff;\n        color: white;\n    }\n    \n    .comparison-table th {\n        padding: 12px;\n        font-size: 12px;\n        font-weight: 700;\n        text-align: left;\n        text-transform: uppercase;\n    }\n    \n    .comparison-table td {\n        padding: 12px;\n        font-size: 12px;\n        border-bottom: 1px solid #f3f4f6;\n    }\n    \n    .comparison-table tbody tr:hover {\n        background: #f0f9ff;\n    }\n    \n    .comparison-table .rank-cell {\n        font-weight: 900;\n        color: #ef4444;\n        font-size: 16px;\n    }\n    \n    /* Status Badge para Reprovadas */\n    .status-reprovado {\n        background: #fee2e2;\n        color: #991b1b;\n        border: 2px solid #dc2626;\n    }\n    \n    .badge-status.status-reprovado {\n        background: #fee2e2;\n        color: #991b1b;\n        border: 2px solid #dc2626;\n    }\n</style>\n\n<div class=\"intercorrencias-container\">\n    <!-- Header Principal -->\n    <div class=\"header-principal\">\n        <!-- Indicador Ao Vivo -->\n        <div class=\"live-indicator\">\n            <div class=\"live-dot\"></div>\n            AO VIVO\n        </div>\n        \n        <!-- Controles -->\n        <div class=\"controles-header\">\n            <button class=\"btn-controle\" onclick=\"atualizarDados()\">\n                üîÑ Atualizar\n            </button>\n            <button class=\"btn-controle\" onclick=\"exportarDados()\">\n                üìä Exportar\n            </button>\n            <button class=\"btn-controle\" onclick=\"debugSistema()\">\n                üîç Debug\n            </button>\n        </div>\n        \n        <div class=\"header-title\">\n            ‚ö†Ô∏è Central de Intercorr√™ncias BI 2.0\n        </div>\n        <div class=\"header-subtitle\">\n            Monitoramento e Gest√£o de Problemas em Tempo Real\n        </div>\n    </div>\n    \n    <!-- Estat√≠sticas -->\n    <div class=\"stats-row\">\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"totalIntercorrencias\">0</div>\n            <div class=\"stat-label\">Total de Intercorr√™ncias</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"intercorrenciasPendentes\">0</div>\n            <div class=\"stat-label\">‚è≥ Pendentes de Aprova√ß√£o</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"intercorrenciasAprovadas\">0</div>\n            <div class=\"stat-label\">‚úÖ Aprovadas</div>\n        </div>\n        <div class=\"stat-card\" style=\"border-top-color: #dc2626;\">\n            <div class=\"stat-value\" id=\"intercorrenciasReprovadas\" style=\"color: #dc2626;\">0</div>\n            <div class=\"stat-label\">‚ùå Reprovadas</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"tempoMedio\">00:00</div>\n            <div class=\"stat-label\">‚è∞ Tempo M√©dio</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"cidadesAfetadas\">0</div>\n            <div class=\"stat-label\">üèôÔ∏è Cidades Afetadas</div>\n        </div>\n        <div class=\"stat-card\">\n            <div class=\"stat-value\" id=\"motoboyEnvolvidos\">0</div>\n            <div class=\"stat-label\">üèçÔ∏è Motoboys Envolvidos</div>\n        </div>\n    </div>\n    \n    <!-- Filtros -->\n    <div class=\"filtros-section\">\n        <div class=\"filtros-title\">\n            üîç Filtros Avan√ßados\n        </div>\n        <div class=\"filtros-grid\">\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üìä Status de Aprova√ß√£o</div>\n                <select class=\"filtro-control\" id=\"filtroAprovacao\" onchange=\"aplicarFiltros()\">\n                    <option value=\"\">Todos</option>\n                    <option value=\"TRUE\">‚úÖ Aprovadas</option>\n                    <option value=\"PENDENTE\">‚è≥ Pendentes</option>\n                    <option value=\"FALSE\">‚ùå Reprovadas</option>\n                </select>\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üèôÔ∏è Cidade</div>\n                <select class=\"filtro-control\" id=\"filtroCidade\" onchange=\"aplicarFiltros()\">\n                    <option value=\"\">Todas</option>\n                </select>\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üèçÔ∏è Motoboy</div>\n                <select class=\"filtro-control\" id=\"filtroMotoboy\" onchange=\"aplicarFiltros()\">\n                    <option value=\"\">Todos</option>\n                </select>\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üìÖ Data</div>\n                <input type=\"date\" class=\"filtro-control\" id=\"filtroData\" onchange=\"aplicarFiltros()\">\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üì¶ Pedido</div>\n                <input type=\"text\" class=\"filtro-control\" id=\"filtroPedido\" placeholder=\"N√∫mero do pedido\" onchange=\"aplicarFiltros()\">\n            </div>\n            <div class=\"filtro-grupo\">\n                <div class=\"filtro-label\">üßπ A√ß√µes</div>\n                <button class=\"btn-limpar-filtros\" onclick=\"limparFiltros()\">\n                    üßπ Limpar Filtros\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Sistema de Abas -->\n    <div class=\"tabs-container\">\n        <div class=\"tabs-header\">\n            <button class=\"tab-button active\" onclick=\"mudarAba('dashboard')\">\n                üìä Dashboard\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('intercorrencias')\">\n                üìã Intercorr√™ncias\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('motoboys')\">\n                üèçÔ∏è An√°lise por Motoboy\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('filiais')\">\n                üè¢ An√°lise por Filial\n            </button>\n            <button class=\"tab-button\" onclick=\"mudarAba('analytics')\">\n                üìà Analytics Avan√ßados\n            </button>\n        </div>\n        \n        <!-- Tab: Dashboard -->\n        <div class=\"tab-content active\" id=\"tabDashboard\">\n            <!-- Analytics Resumido -->\n            <div class=\"analytics-section\" style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-left: 5px solid #10b981;\">\n                <div style=\"font-size: 18px; font-weight: 700; color: #10b981; margin-bottom: 16px; display: flex; align-items: center; justify-content: space-between;\">\n                    <span>üìä Analytics R√°pido - Tempo de Intercorr√™ncias</span>\n                    <button onclick=\"toggleAnalytics()\" style=\"background: #10b981; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 10px; cursor: pointer;\" id=\"btnToggleAnalytics\">\n                        üìä Recolher\n                    </button>\n                </div>\n                <div id=\"analyticsContent\">\n                \n                <!-- Totais por Filial -->\n                <div style=\"margin-bottom: 20px;\">\n                    <div style=\"font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 10px;\">üè¢ Por Filial:</div>\n                    <div id=\"graficoFiliais\" style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Totais por Motoboy -->\n                <div style=\"margin-bottom: 20px;\">\n                    <div style=\"font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 10px;\">üèçÔ∏è Por Motoboy:</div>\n                    <div id=\"graficoMotoboys\" style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Totais por Cidade -->\n                <div style=\"margin-bottom: 20px;\">\n                    <div style=\"font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 10px;\">üèôÔ∏è Por Cidade:</div>\n                    <div id=\"graficoCidades\" style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Rankings -->\n                <div style=\"border-top: 2px solid #e5e7eb; padding-top: 16px;\">\n                    <div style=\"font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 12px;\">üèÜ Rankings:</div>\n                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;\" id=\"rankingsContainer\">\n                        <!-- Rankings ser√£o inseridos aqui -->\n                    </div>\n                </div>\n                </div> <!-- Fechar analyticsContent -->\n            </div>\n        </div>\n        \n        <!-- Tab: Intercorr√™ncias -->\n        <div class=\"tab-content\" id=\"tabIntercorrencias\">\n            <!-- Controles de Visualiza√ß√£o -->\n            <div class=\"view-controls\">\n                <div>\n                    <button class=\"btn-modo ativo\" id=\"btnCards\" onclick=\"alterarModo('cards')\">\n                        üì± Cards\n                    </button>\n                    <button class=\"btn-modo\" id=\"btnLista\" onclick=\"alterarModo('lista')\">\n                        üìã Lista Compacta\n                    </button>\n                </div>\n                <div style=\"font-size: 12px; color: #6b7280; font-weight: 600;\">\n                    <span id=\"resultadosFiltro\">Mostrando todas as intercorr√™ncias</span>\n                </div>\n            </div>\n            \n            <!-- Grid de Cards -->\n            <div class=\"intercorrencias-grid\" id=\"intercorrenciasGrid\">\n                <div class=\"loading\">\n                    ‚ö†Ô∏è Carregando intercorr√™ncias...\n                </div>\n            </div>\n            \n            <!-- Lista Compacta -->\n            <div class=\"intercorrencias-lista\" id=\"intercorrenciasLista\">\n                <div class=\"lista-header\">\n                    <div>ID</div>\n                    <div>Pedido</div>\n                    <div>Motoboy</div>\n                    <div>Cidade</div>\n                    <div>Data</div>\n                    <div>Tempo</div>\n                    <div>Descri√ß√£o</div>\n                    <div>Status</div>\n                </div>\n                <div id=\"listaBody\">\n                    <!-- Lista ser√° inserida aqui -->\n                </div>\n            </div>\n        </div>\n        \n        <!-- Tab: Analytics Avan√ßados -->\n        <div class=\"tab-content\" id=\"tabAnalytics\">\n            <!-- Insights Cards -->\n            <div class=\"chart-grid\" style=\"margin-bottom: 24px;\">\n                <div class=\"insight-card\" id=\"insightHorarioPico\">\n                    <div class=\"insight-icon\">‚è∞</div>\n                    <div class=\"insight-title\">Hor√°rio de Pico</div>\n                    <div class=\"insight-value\">--:--</div>\n                    <div class=\"insight-description\">Hor√°rio com mais intercorr√™ncias</div>\n                </div>\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\">\n                    <div class=\"insight-icon\">üìà</div>\n                    <div class=\"insight-title\">Taxa de Aprova√ß√£o</div>\n                    <div class=\"insight-value\" id=\"insightTaxaAprovacao\">0%</div>\n                    <div class=\"insight-description\">Percentual de intercorr√™ncias aprovadas</div>\n                </div>\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\">\n                    <div class=\"insight-icon\">‚ö°</div>\n                    <div class=\"insight-title\">Tempo de Resposta</div>\n                    <div class=\"insight-value\" id=\"insightTempoResposta\">--:--</div>\n                    <div class=\"insight-description\">Tempo m√©dio at√© aprova√ß√£o</div>\n                </div>\n            </div>\n            \n            <!-- Heatmap de Hor√°rios -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üïê Heatmap - Intercorr√™ncias por Hor√°rio</div>\n                <div style=\"margin-bottom: 12px; font-size: 12px; color: #6b7280;\">\n                    Visualize em quais hor√°rios do dia ocorrem mais intercorr√™ncias\n                </div>\n                <div class=\"heatmap-grid\" id=\"heatmapHorarios\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n                <div class=\"heatmap-legend\">\n                    <div class=\"heatmap-legend-item\">\n                        <div class=\"heatmap-color\" style=\"background: #ecfdf5;\"></div>\n                        <span>Baixo (0-2)</span>\n                    </div>\n                    <div class=\"heatmap-legend-item\">\n                        <div class=\"heatmap-color\" style=\"background: #a7f3d0;\"></div>\n                        <span>M√©dio (3-5)</span>\n                    </div>\n                    <div class=\"heatmap-legend-item\">\n                        <div class=\"heatmap-color\" style=\"background: #fef3c7;\"></div>\n                        <span>Alto (6-10)</span>\n                    </div>\n                    <div class=\"heatmap-legend-item\">\n                        <div class=\"heatmap-color\" style=\"background: #fecaca;\"></div>\n                        <span>Cr√≠tico (10+)</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Timeline 24 Horas -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üìà Timeline - Ocorr√™ncias ao Longo do Dia (24h)</div>\n                <div style=\"margin-bottom: 12px; font-size: 12px; color: #6b7280;\">\n                    Gr√°fico de linha mostrando a distribui√ß√£o das intercorr√™ncias por hora\n                </div>\n                <div id=\"timelineChart\"></div>\n            </div>\n            \n            <!-- Gr√°ficos de Distribui√ß√£o -->\n            <div class=\"chart-grid\">\n                <!-- Por Dia da Semana -->\n                <div class=\"chart-container\">\n                    <div class=\"chart-title\">üìÖ Distribui√ß√£o por Dia da Semana</div>\n                    <div class=\"bar-chart\" id=\"graficoDiaSemana\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Por Per√≠odo do Dia -->\n                <div class=\"chart-container\">\n                    <div class=\"chart-title\">üåÖ Distribui√ß√£o por Per√≠odo do Dia</div>\n                    <div class=\"bar-chart\" id=\"graficoPeriodoDia\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n            </div>\n            \n            <!-- An√°lise de Tempo de Resolu√ß√£o -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">‚è±Ô∏è An√°lise de Tempo de Resolu√ß√£o</div>\n                <div class=\"bar-chart\" id=\"graficoTempoResolucao\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n            \n            <!-- Top Causas -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üî• Top 10 Causas Mais Frequentes</div>\n                <div class=\"bar-chart\" id=\"graficoTopCausas\">\n                    <!-- Ser√° preenchido via JavaScript -->\n                </div>\n            </div>\n        </div>\n        \n        <!-- Tab: An√°lise por Motoboy -->\n        <div class=\"tab-content\" id=\"tabMotoboys\">\n            <!-- Seletor de Motoboy -->\n            <div class=\"chart-container\" style=\"margin-bottom: 24px;\">\n                <div class=\"chart-title\">üèçÔ∏è Selecione um Motoboy para An√°lise Detalhada</div>\n                <select id=\"selectMotoboy\" onchange=\"analisarMotoboy()\" \n                        style=\"width: 100%; padding: 12px; border: 2px solid #1890ff; border-radius: 8px; font-size: 14px; font-weight: 600;\">\n                    <option value=\"\">Selecione um motoboy...</option>\n                </select>\n            </div>\n            \n            <!-- Insights do Motoboy -->\n            <div class=\"chart-grid\" style=\"margin-bottom: 24px;\" id=\"insightsMotoboy\">\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\">\n                    <div class=\"insight-icon\">üìä</div>\n                    <div class=\"insight-title\">Total de Intercorr√™ncias</div>\n                    <div class=\"insight-value\" id=\"mbTotalIntercorrencias\">0</div>\n                    <div class=\"insight-description\">Registradas no per√≠odo</div>\n                </div>\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\">\n                    <div class=\"insight-icon\">‚úÖ</div>\n                    <div class=\"insight-title\">Taxa de Aprova√ß√£o</div>\n                    <div class=\"insight-value\" id=\"mbTaxaAprovacao\">0%</div>\n                    <div class=\"insight-description\">Intercorr√™ncias aprovadas</div>\n                </div>\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\">\n                    <div class=\"insight-icon\">‚è∞</div>\n                    <div class=\"insight-title\">Tempo M√©dio</div>\n                    <div class=\"insight-value\" id=\"mbTempoMedio\">00:00</div>\n                    <div class=\"insight-description\">Dura√ß√£o m√©dia das intercorr√™ncias</div>\n                </div>\n            </div>\n            \n            <!-- Detalhes do Motoboy -->\n            <div id=\"detalhesMotoboy\" style=\"display: none;\">\n                <!-- Gr√°ficos do Motoboy -->\n                <div class=\"chart-grid\" style=\"margin-bottom: 24px;\">\n                    <!-- Distribui√ß√£o de Status -->\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üìä Distribui√ß√£o de Status</div>\n                        <div class=\"bar-chart\" id=\"mbGraficoStatus\">\n                            <!-- Ser√° preenchido via JavaScript -->\n                        </div>\n                    </div>\n                    \n                    <!-- Cidades de Atua√ß√£o -->\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üèôÔ∏è Cidades de Atua√ß√£o</div>\n                        <div class=\"bar-chart\" id=\"mbGraficoCidades\">\n                            <!-- Ser√° preenchido via JavaScript -->\n                        </div>\n                    </div>\n                </div>\n                \n                <!-- Hor√°rios Cr√≠ticos -->\n                <div class=\"chart-container\" style=\"margin-bottom: 24px;\">\n                    <div class=\"chart-title\">‚è∞ Hor√°rios com Mais Intercorr√™ncias</div>\n                    <div class=\"bar-chart\" id=\"mbGraficoHorarios\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Top Problemas -->\n                <div class=\"chart-container\" style=\"margin-bottom: 24px;\">\n                    <div class=\"chart-title\">‚ö†Ô∏è Problemas Mais Frequentes</div>\n                    <div class=\"bar-chart\" id=\"mbGraficoProblemas\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Hist√≥rico -->\n                <div class=\"chart-container\">\n                    <div class=\"chart-title\">üìÖ Hist√≥rico de Intercorr√™ncias</div>\n                    <div id=\"mbHistorico\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Compara√ß√£o Entre Motoboys -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üèÜ Ranking Geral de Motoboys</div>\n                <div style=\"overflow-x: auto;\">\n                    <table class=\"comparison-table\" id=\"tabelaComparacaoMotoboys\">\n                        <thead>\n                            <tr>\n                                <th>Rank</th>\n                                <th>Motoboy</th>\n                                <th>Total</th>\n                                <th>Aprovadas</th>\n                                <th>Reprovadas</th>\n                                <th>Pendentes</th>\n                                <th>Taxa Aprov.</th>\n                                <th>Tempo M√©dio</th>\n                                <th>Cidades</th>\n                            </tr>\n                        </thead>\n                        <tbody id=\"bodyTabelaMotoboys\">\n                            <!-- Ser√° preenchido via JavaScript -->\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n        \n        <!-- Tab: An√°lise por Filial -->\n        <div class=\"tab-content\" id=\"tabFiliais\">\n            <!-- Seletor de Visualiza√ß√£o -->\n            <div class=\"chart-container\" style=\"margin-bottom: 24px;\">\n                <div class=\"chart-title\">üè¢ An√°lise por Estado/Filial</div>\n                <div style=\"display: flex; gap: 12px; margin-bottom: 12px;\">\n                    <button class=\"btn-modo ativo\" id=\"btnUF\" onclick=\"alterarModoFilial('uf')\" style=\"flex: 1;\">\n                        üó∫Ô∏è Por Estado (UF)\n                    </button>\n                    <button class=\"btn-modo\" id=\"btnFilial\" onclick=\"alterarModoFilial('filial')\" style=\"flex: 1;\">\n                        üè¢ Por Filial\n                    </button>\n                </div>\n                <select id=\"selectFilial\" onchange=\"analisarFilial()\" \n                        style=\"width: 100%; padding: 12px; border: 2px solid #10b981; border-radius: 8px; font-size: 14px; font-weight: 600;\">\n                    <option value=\"\">Selecione...</option>\n                </select>\n            </div>\n            \n            <!-- Insights da Filial -->\n            <div class=\"chart-grid\" style=\"margin-bottom: 24px;\" id=\"insightsFilial\">\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);\">\n                    <div class=\"insight-icon\">üìä</div>\n                    <div class=\"insight-title\">Total de Intercorr√™ncias</div>\n                    <div class=\"insight-value\" id=\"flTotalIntercorrencias\">0</div>\n                    <div class=\"insight-description\">Registradas na filial</div>\n                </div>\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);\">\n                    <div class=\"insight-icon\">‚úÖ</div>\n                    <div class=\"insight-title\">Taxa de Aprova√ß√£o</div>\n                    <div class=\"insight-value\" id=\"flTaxaAprovacao\">0%</div>\n                    <div class=\"insight-description\">Intercorr√™ncias aprovadas</div>\n                </div>\n                <div class=\"insight-card\" style=\"background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);\">\n                    <div class=\"insight-icon\">üë•</div>\n                    <div class=\"insight-title\">Motoboys Ativos</div>\n                    <div class=\"insight-value\" id=\"flTotalMotoboys\">0</div>\n                    <div class=\"insight-description\">Motoboys com intercorr√™ncias</div>\n                </div>\n            </div>\n            \n            <!-- Detalhes da Filial -->\n            <div id=\"detalhesFilial\" style=\"display: none;\">\n                <!-- Gr√°ficos da Filial -->\n                <div class=\"chart-grid\" style=\"margin-bottom: 24px;\">\n                    <!-- Distribui√ß√£o de Status -->\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üìä Distribui√ß√£o de Status</div>\n                        <div class=\"bar-chart\" id=\"flGraficoStatus\">\n                            <!-- Ser√° preenchido via JavaScript -->\n                        </div>\n                    </div>\n                    \n                    <!-- Cidades Atendidas -->\n                    <div class=\"chart-container\">\n                        <div class=\"chart-title\">üèôÔ∏è Cidades Atendidas</div>\n                        <div class=\"bar-chart\" id=\"flGraficoCidades\">\n                            <!-- Ser√° preenchido via JavaScript -->\n                        </div>\n                    </div>\n                </div>\n                \n                <!-- Motoboys Cr√≠ticos -->\n                <div class=\"chart-container\" style=\"margin-bottom: 24px;\">\n                    <div class=\"chart-title\">üèçÔ∏è Motoboys com Mais Intercorr√™ncias</div>\n                    <div class=\"bar-chart\" id=\"flGraficoMotoboys\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Hor√°rios Cr√≠ticos -->\n                <div class=\"chart-container\" style=\"margin-bottom: 24px;\">\n                    <div class=\"chart-title\">‚è∞ Hor√°rios Cr√≠ticos da Filial</div>\n                    <div class=\"bar-chart\" id=\"flGraficoHorarios\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n                \n                <!-- Top Problemas -->\n                <div class=\"chart-container\" style=\"margin-bottom: 24px;\">\n                    <div class=\"chart-title\">‚ö†Ô∏è Principais Problemas da Filial</div>\n                    <div class=\"bar-chart\" id=\"flGraficoProblemas\">\n                        <!-- Ser√° preenchido via JavaScript -->\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Compara√ß√£o Entre Filiais -->\n            <div class=\"chart-container\">\n                <div class=\"chart-title\">üèÜ Ranking Geral de Filiais</div>\n                <div style=\"overflow-x: auto;\">\n                    <table class=\"comparison-table\" id=\"tabelaComparacaoFiliais\">\n                        <thead>\n                            <tr>\n                                <th>Rank</th>\n                                <th>Filial</th>\n                                <th>Total</th>\n                                <th>Aprovadas</th>\n                                <th>Reprovadas</th>\n                                <th>Pendentes</th>\n                                <th>Taxa Aprov.</th>\n                                <th>Tempo M√©dio</th>\n                                <th>Motoboys</th>\n                                <th>Cidades</th>\n                            </tr>\n                        </thead>\n                        <tbody id=\"bodyTabelaFiliais\">\n                            <!-- Ser√° preenchido via JavaScript -->\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Modal de Imagem -->\n<div id=\"modalImagem\" class=\"modal\">\n    <div class=\"modal-content\">\n        <div class=\"modal-header\">\n            <div class=\"modal-title\">üì∑ Foto da Intercorr√™ncia</div>\n            <button class=\"close\" onclick=\"fecharModal()\">&times;</button>\n        </div>\n        <div id=\"modalImagemConteudo\">\n            <!-- Imagem ser√° inserida aqui -->\n        </div>\n    </div>\n</div>\n\n<!-- Modal de Timeline Hora -->\n<div id=\"modalTimelineHora\" class=\"modal\">\n    <div class=\"modal-content\" style=\"max-width: 1200px;\">\n        <div class=\"modal-header\">\n            <div class=\"modal-title\" id=\"modalTimelineTitle\">‚è∞ Intercorr√™ncias</div>\n            <button class=\"close\" onclick=\"fecharModalTimeline()\">&times;</button>\n        </div>\n        \n        <!-- Barra de Estat√≠sticas -->\n        <div class=\"modal-stats-bar\" id=\"modalTimelineStats\">\n            <!-- Stats ser√£o inseridas aqui -->\n        </div>\n        \n        <!-- Lista de Intercorr√™ncias -->\n        <div id=\"modalTimelineConteudo\">\n            <!-- Intercorr√™ncias ser√£o inseridas aqui -->\n        </div>\n    </div>\n</div>\n\n<!-- Modal de Debug -->\n<div id=\"modalDebug\" class=\"modal\">\n    <div class=\"modal-content\" style=\"max-width: 1200px; max-height: 90vh; overflow-y: auto;\">\n        <div class=\"modal-header\">\n            <div class=\"modal-title\">üîç Debug - Central de Intercorr√™ncias BI 2.0</div>\n            <button class=\"close\" onclick=\"fecharModalDebug()\">&times;</button>\n        </div>\n        \n        <div id=\"modalDebugConteudo\" style=\"font-family: 'Courier New', monospace; font-size: 12px;\">\n            <!-- Conte√∫do de debug ser√° inserido aqui -->\n        </div>\n    </div>\n</div>\n\n<script>\n// Vari√°veis globais\nlet intercorrenciasOriginais = [];\nlet intercorrenciasFiltradas = [];\nlet modoVisualizacao = 'cards';\n\n// Inicializar dados\ntry {\n    console.log('üîÑ Carregando dados de intercorrencias_bi20...');\n    {{\n        (() => {\n            const dados = intercorrencias_bi20?.data || [];\n            console.log('üìä Dados encontrados:', dados.length, 'registros');\n            return `intercorrenciasOriginais = ${JSON.stringify(dados)};`;\n        })()\n    }}\n    console.log('‚úÖ Dados carregados com sucesso:', intercorrenciasOriginais.length, 'intercorr√™ncias');\n} catch (error) {\n    console.error('‚ùå ERRO ao carregar dados:', error);\n    intercorrenciasOriginais = [];\n}\n\n// Formatar tempo de intercorr√™ncia\nfunction formatarTempo(tempoStr) {\n    if (!tempoStr) return '00:00:00';\n    \n    try {\n        // Formato: \"0 0:30:0.0\"\n        const regex = /(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/;\n        const match = tempoStr.match(regex);\n        \n        if (match) {\n            const [, dias, horas, minutos, segundos] = match;\n            const h = String(parseInt(horas) || 0).padStart(2, '0');\n            const m = String(parseInt(minutos) || 0).padStart(2, '0');\n            const s = String(parseInt(segundos) || 0).padStart(2, '0');\n            return dias > 0 ? `${dias}d ${h}:${m}:${s}` : `${h}:${m}:${s}`;\n        }\n        \n        return tempoStr;\n    } catch (error) {\n        return tempoStr || '00:00:00';\n    }\n}\n\n// Formatar data\nfunction formatarData(dataStr) {\n    if (!dataStr) return 'N/A';\n    \n    try {\n        const data = new Date(dataStr);\n        return data.toLocaleDateString('pt-BR');\n    } catch (error) {\n        return dataStr;\n    }\n}\n\n// Popular filtros\nfunction popularFiltros() {\n    console.log('üìã Populando filtros...');\n    \n    // Cidades\n    const cidades = [...new Set(intercorrenciasOriginais.map(d => d.CIDADE))].filter(c => c).sort();\n    const selectCidade = document.getElementById('filtroCidade');\n    selectCidade.innerHTML = '<option value=\"\">Todas</option>';\n    cidades.forEach(cidade => {\n        selectCidade.innerHTML += '<option value=\"' + cidade + '\">' + cidade + '</option>';\n    });\n    \n    // Motoboys\n    const motoboys = [...new Set(intercorrenciasOriginais.map(d => d.NOME_MOTOBOY))].filter(m => m).sort();\n    const selectMotoboy = document.getElementById('filtroMotoboy');\n    selectMotoboy.innerHTML = '<option value=\"\">Todos</option>';\n    motoboys.forEach(motoboy => {\n        selectMotoboy.innerHTML += '<option value=\"' + motoboy + '\">' + motoboy + '</option>';\n    });\n    \n    console.log('üìã Filtros populados:', { cidades: cidades.length, motoboys: motoboys.length });\n}\n\n// Fun√ß√£o para determinar status da intercorr√™ncia\nfunction getStatusIntercorrencia(item) {\n    const aprovacao = item.APROVACAO_INTERCORRENCIA;\n    const temJustificativa = item.JUSTIFICATIVA_APROVACAO && item.JUSTIFICATIVA_APROVACAO.trim();\n    const temQuemAprovou = item.NOME_QUEM_APROVOU && item.NOME_QUEM_APROVOU.trim();\n    \n    if (aprovacao === 'TRUE') {\n        return 'APROVADO';\n    } else if (aprovacao === 'FALSE' && (temJustificativa || temQuemAprovou)) {\n        return 'REPROVADO';\n    } else {\n        return 'PENDENTE';\n    }\n}\n\n// Aplicar filtros\nfunction aplicarFiltros() {\n    const filtroAprovacao = document.getElementById('filtroAprovacao').value;\n    const filtroCidade = document.getElementById('filtroCidade').value;\n    const filtroMotoboy = document.getElementById('filtroMotoboy').value;\n    const filtroData = document.getElementById('filtroData').value;\n    const filtroPedido = document.getElementById('filtroPedido').value;\n    \n    console.log('üîç Aplicando filtros:', { filtroAprovacao, filtroCidade, filtroMotoboy, filtroData, filtroPedido });\n    \n    intercorrenciasFiltradas = intercorrenciasOriginais.filter(item => {\n        // Filtro por aprova√ß√£o (atualizado para incluir PENDENTE e REPROVADO)\n        if (filtroAprovacao) {\n            const status = getStatusIntercorrencia(item);\n            if (filtroAprovacao === 'TRUE' && status !== 'APROVADO') return false;\n            if (filtroAprovacao === 'PENDENTE' && status !== 'PENDENTE') return false;\n            if (filtroAprovacao === 'FALSE' && status !== 'REPROVADO') return false;\n        }\n        \n        // Filtro por cidade\n        if (filtroCidade && item.CIDADE !== filtroCidade) return false;\n        \n        // Filtro por motoboy\n        if (filtroMotoboy && item.NOME_MOTOBOY !== filtroMotoboy) return false;\n        \n        // Filtro por data\n        if (filtroData && item.DATA_INTERCORRENCIA) {\n            const dataItem = item.DATA_INTERCORRENCIA;\n            if (dataItem !== filtroData) return false;\n        }\n        \n        // Filtro por pedido\n        if (filtroPedido && item.NUMPED && !item.NUMPED.includes(filtroPedido)) return false;\n        \n        return true;\n    });\n    \n    console.log('üìä Filtros aplicados:', intercorrenciasFiltradas.length + '/' + intercorrenciasOriginais.length);\n    \n    atualizarEstatisticas();\n    renderizar();\n    atualizarResultados();\n    gerarGraficos();\n    gerarGraficosAvancados();\n}\n\n// Renderizar conforme modo\nfunction renderizar() {\n    if (modoVisualizacao === 'cards') {\n        renderizarCards();\n    } else {\n        renderizarLista();\n    }\n}\n\n// Renderizar cards\nfunction renderizarCards() {\n    console.log('üé® Renderizando cards...', intercorrenciasFiltradas.length);\n    \n    const grid = document.getElementById('intercorrenciasGrid');\n    \n    if (intercorrenciasFiltradas.length === 0) {\n        grid.innerHTML = `\n            <div class=\"sem-intercorrencias\">\n                <div class=\"sem-intercorrencias-icon\">‚úÖ</div>\n                <div class=\"sem-intercorrencias-texto\">Nenhuma intercorr√™ncia encontrada</div>\n                <div class=\"sem-intercorrencias-subtexto\">Isso √© uma boa not√≠cia! N√£o h√° problemas com os filtros selecionados.</div>\n            </div>\n        `;\n        return;\n    }\n    \n    grid.innerHTML = intercorrenciasFiltradas.map((item, index) => {\n        const tempoFormatado = formatarTempo(item.TEMPO_INTERCORRENCIA);\n        const dataFormatada = formatarData(item.DATA_INTERCORRENCIA);\n        const status = getStatusIntercorrencia(item);\n        const isAprovado = status === 'APROVADO';\n        const isReprovado = status === 'REPROVADO';\n        const isPendente = status === 'PENDENTE';\n        const hasImagem = item.URLS_FOTOS && item.URLS_FOTOS.trim();\n        \n        let statusClass = 'status-pendente';\n        let statusText = '‚è≥ Pendente';\n        if (isAprovado) {\n            statusClass = 'status-aprovado';\n            statusText = '‚úÖ Aprovada';\n        } else if (isReprovado) {\n            statusClass = 'status-reprovado';\n            statusText = '‚ùå Reprovada';\n        }\n        \n        return `\n            <div class=\"intercorrencia-card\" data-index=\"${index}\">\n                <div class=\"card-header\">\n                    <div style=\"display: flex; align-items: center;\">\n                        <div class=\"intercorrencia-id\"># ${item.ID_INTERCORRENCIA}</div>\n                        <div class=\"badge-cidade\">${item.CIDADE}</div>\n                    </div>\n                    <div class=\"badge-status ${statusClass}\">\n                        ${statusText}\n                    </div>\n                </div>\n                \n                <div class=\"card-info\">\n                    <div class=\"info-item\">\n                        <div class=\"info-label\">üö¶ Sa√≠da ID</div>\n                        <div class=\"info-value\">${item.SAIDA_ID}</div>\n                    </div>\n                    <div class=\"info-item\">\n                        <div class=\"info-label\">üì¶ Pedido</div>\n                        <div class=\"info-value\">${item.NUMPED}</div>\n                    </div>\n                    <div class=\"info-item\">\n                        <div class=\"info-label\">üè¢ Filial</div>\n                        <div class=\"info-value\">${item.ID_FILIAL}</div>\n                    </div>\n                    <div class=\"info-item\">\n                        <div class=\"info-label\">üìÖ Data</div>\n                        <div class=\"info-value\">${dataFormatada}</div>\n                    </div>\n                </div>\n                \n                <div class=\"motoboy-info\">\n                    <div class=\"motoboy-nome\">üèçÔ∏è ${item.NOME_MOTOBOY}</div>\n                    <div class=\"motoboy-codigo\">C√≥digo: ${item.COD_MOTOBOY}</div>\n                </div>\n                \n                <div class=\"tempo-info\">\n                    <div class=\"tempo-valor\">${tempoFormatado}</div>\n                    <div class=\"tempo-label\">TEMPO DE INTERCORR√äNCIA</div>\n                </div>\n                \n                <div class=\"descricao-info\">\n                    <div class=\"descricao-titulo\">‚ö†Ô∏è Descri√ß√£o do Problema</div>\n                    <div class=\"descricao-texto\">${item.DESCRICAO || 'Sem descri√ß√£o'}</div>\n                </div>\n                \n                <div class=\"aprovacao-section ${isAprovado ? 'aprovacao-aprovada' : (isReprovado ? 'aprovacao-pendente' : 'aprovacao-pendente')}\">\n                    <div class=\"aprovacao-titulo\">\n                        ${isAprovado ? '‚úÖ Aprova√ß√£o Concedida' : (isReprovado ? '‚ùå Reprovada' : '‚è≥ Aguardando Aprova√ß√£o')}\n                    </div>\n                    <div class=\"aprovacao-info\">\n                        ${isAprovado || isReprovado ? \n                            '<strong>Por:</strong> ' + (item.NOME_QUEM_APROVOU || 'Sistema') + '<br>' +\n                            '<strong>C√≥digo:</strong> ' + (item.CODE_WINTHOR_QUEM_APROVOU || 'N/A') + '<br>' +\n                            '<strong>Justificativa:</strong> ' + (item.JUSTIFICATIVA_APROVACAO || 'Sem justificativa')\n                            :\n                            'Status: Pendente de an√°lise'\n                        }\n                    </div>\n                </div>\n                \n                <div class=\"imagem-section\">\n                    <div class=\"imagem-container\">\n                        ${hasImagem ? \n                            '<img src=\"' + item.URLS_FOTOS + '\" ' +\n                            'alt=\"Foto da intercorr√™ncia\" ' +\n                            'class=\"imagem-intercorrencia\" ' + \n                            'onclick=\"abrirModal(\\'' + item.URLS_FOTOS + '\\', \\'' + item.ID_INTERCORRENCIA + '\\')\" ' +\n                            'onerror=\"this.parentElement.innerHTML=\\'<div class=&quot;sem-imagem&quot;>üì∑ Erro ao carregar</div>\\'\">'\n                            :\n                            '<div class=\"sem-imagem\">üì∑ Nenhuma foto anexada</div>'\n                        }\n                    </div>\n                    ${hasImagem ? \n                        '<button class=\"btn-ver-imagem\" onclick=\"abrirModal(\\'' + item.URLS_FOTOS + '\\', \\'' + item.ID_INTERCORRENCIA + '\\')\">üì∑ Ver Imagem Completa</button>'\n                        : ''\n                    }\n                </div>\n                \n                <div class=\"card-footer\">\n                    <div class=\"lancamento-info\">\n                        <div>üìù Lan√ßado por:</div>\n                        <div class=\"lancamento-nome\">${item.NOME_LANCAMENTO}</div>\n                        <div>C√≥digo: ${item.CODWINTHOR_LANCAMENTO}</div>\n                    </div>\n                    <div style=\"font-weight: 700; color: #ef4444;\">\n                        ID: ${item.ID_INTERCORRENCIA}\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n    \n    console.log('‚úÖ Cards renderizados');\n}\n\n// Renderizar lista compacta\nfunction renderizarLista() {\n    console.log('üìã Renderizando lista...', intercorrenciasFiltradas.length);\n    \n    const listaBody = document.getElementById('listaBody');\n    \n    listaBody.innerHTML = intercorrenciasFiltradas.map((item, index) => {\n        const tempoFormatado = formatarTempo(item.TEMPO_INTERCORRENCIA);\n        const dataFormatada = formatarData(item.DATA_INTERCORRENCIA);\n        const status = getStatusIntercorrencia(item);\n        const isAprovado = status === 'APROVADO';\n        const isReprovado = status === 'REPROVADO';\n        \n        let statusClass = 'pendente';\n        let statusTexto = 'Pendente';\n        if (isAprovado) {\n            statusClass = 'aprovado';\n            statusTexto = 'Aprovada';\n        } else if (isReprovado) {\n            statusClass = 'pendente'; // Usar a mesma cor que pendente por enquanto\n            statusTexto = 'Reprovada';\n        }\n        \n        return `\n            <div class=\"lista-item ${statusClass}\" \n                 onclick=\"selecionarItem(${index})\" \n                 title=\"Clique para ver detalhes\">\n                <div style=\"font-weight: 700; color: #ef4444;\">#${item.ID_INTERCORRENCIA}</div>\n                <div style=\"font-weight: 600;\">${item.NUMPED}</div>\n                <div>${item.NOME_MOTOBOY}</div>\n                <div>${item.CIDADE}</div>\n                <div>${dataFormatada}</div>\n                <div style=\"font-family: monospace;\">${tempoFormatado}</div>\n                <div style=\"font-size: 10px; overflow: hidden; text-overflow: ellipsis;\">\n                    ${(item.DESCRICAO || '').substring(0, 30)}...\n                </div>\n                <div>\n                    <div class=\"status-badge ${statusClass}\">\n                        ${statusTexto}\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n    \n    console.log('‚úÖ Lista renderizada');\n}\n\n// Atualizar estat√≠sticas\nfunction atualizarEstatisticas() {\n    const total = intercorrenciasFiltradas.length;\n    const aprovadas = intercorrenciasFiltradas.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = intercorrenciasFiltradas.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = intercorrenciasFiltradas.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    const cidades = [...new Set(intercorrenciasFiltradas.map(i => i.CIDADE))].length;\n    const motoboys = [...new Set(intercorrenciasFiltradas.map(i => i.NOME_MOTOBOY))].length;\n    \n    // Calcular tempo m√©dio\n    let tempoMedioMinutos = 0;\n    if (total > 0) {\n        const tempos = intercorrenciasFiltradas.map(item => {\n            const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n            const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n            if (match) {\n                const [, dias, horas, minutos] = match;\n                return parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            }\n            return 0;\n        });\n        \n        tempoMedioMinutos = Math.floor(tempos.reduce((sum, t) => sum + t, 0) / tempos.length);\n    }\n    \n    const horasMedia = Math.floor(tempoMedioMinutos / 60);\n    const minutosMedia = tempoMedioMinutos % 60;\n    const tempoMedioFormatado = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n    \n    document.getElementById('totalIntercorrencias').textContent = total;\n    document.getElementById('intercorrenciasPendentes').textContent = pendentes;\n    document.getElementById('intercorrenciasAprovadas').textContent = aprovadas;\n    document.getElementById('intercorrenciasReprovadas').textContent = reprovadas;\n    document.getElementById('cidadesAfetadas').textContent = cidades;\n    document.getElementById('motoboyEnvolvidos').textContent = motoboys;\n    document.getElementById('tempoMedio').textContent = tempoMedioFormatado;\n    \n    console.log('üìä Estat√≠sticas atualizadas:', { total, pendentes, aprovadas, reprovadas, cidades, motoboys });\n}\n\n// Gerar gr√°ficos de analytics\nfunction gerarGraficos() {\n    console.log('üìä Gerando gr√°ficos de analytics...');\n    \n    gerarGraficoFiliais();\n    gerarGraficoMotoboys();\n    gerarGraficoCidades();\n    gerarRankings();\n}\n\n// Gerar gr√°fico por filiais\nfunction gerarGraficoFiliais() {\n    const filiaisStats = {};\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const filial = item.ID_FILIAL || 'N/A';\n        \n        if (!filiaisStats[filial]) {\n            filiaisStats[filial] = {\n                total: 0,\n                tempoTotal: 0,\n                aprovadas: 0,\n                pendentes: 0\n            };\n        }\n        \n        filiaisStats[filial].total++;\n        \n        // Calcular tempo em minutos\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        if (match) {\n            const [, dias, horas, minutos] = match;\n            const tempoMinutos = parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            filiaisStats[filial].tempoTotal += tempoMinutos;\n        }\n        \n        if (item.APROVACAO_INTERCORRENCIA === 'TRUE') {\n            filiaisStats[filial].aprovadas++;\n        } else {\n            filiaisStats[filial].pendentes++;\n        }\n    });\n    \n    const container = document.getElementById('graficoFiliais');\n    const maxTotal = Math.max(...Object.values(filiaisStats).map(s => s.total), 1);\n    \n    container.innerHTML = Object.entries(filiaisStats).map(([filial, stats]) => {\n        const tempoMedio = stats.total > 0 ? Math.floor(stats.tempoTotal / stats.total) : 0;\n        const horasMedia = Math.floor(tempoMedio / 60);\n        const minutosMedia = tempoMedio % 60;\n        const tempoFormatado = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n        const porcentagem = Math.round((stats.total / maxTotal) * 100);\n        \n        return `\n            <div class=\"chart-item\" onclick=\"filtrarPorFilial('${filial}')\">\n                <div class=\"chart-label\">üè¢ Filial ${filial}</div>\n                <div class=\"chart-stats\">\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value quantidade\">${stats.total}</div>\n                        <div class=\"chart-sublabel\">Total</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value tempo\">${tempoFormatado}</div>\n                        <div class=\"chart-sublabel\">Tempo M√©dio</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value aprovadas\">${stats.aprovadas}</div>\n                        <div class=\"chart-sublabel\">Aprovadas</div>\n                    </div>\n                </div>\n                <div class=\"chart-barra\">\n                    <div class=\"chart-progress\" style=\"width: ${porcentagem}%;\"></div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico por motoboys\nfunction gerarGraficoMotoboys() {\n    const motoboyStats = {};\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const motoboy = item.NOME_MOTOBOY || 'N/A';\n        \n        if (!motoboyStats[motoboy]) {\n            motoboyStats[motoboy] = {\n                total: 0,\n                tempoTotal: 0,\n                aprovadas: 0,\n                filiais: new Set()\n            };\n        }\n        \n        motoboyStats[motoboy].total++;\n        motoboyStats[motoboy].filiais.add(item.ID_FILIAL);\n        \n        // Calcular tempo\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        if (match) {\n            const [, dias, horas, minutos] = match;\n            const tempoMinutos = parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            motoboyStats[motoboy].tempoTotal += tempoMinutos;\n        }\n        \n        if (item.APROVACAO_INTERCORRENCIA === 'TRUE') {\n            motoboyStats[motoboy].aprovadas++;\n        }\n    });\n    \n    const container = document.getElementById('graficoMotoboys');\n    const maxTotal = Math.max(...Object.values(motoboyStats).map(s => s.total), 1);\n    \n    // Ordenar por total de intercorr√™ncias\n    const motoboyOrdenados = Object.entries(motoboyStats).sort((a, b) => b[1].total - a[1].total);\n    \n    container.innerHTML = motoboyOrdenados.map(([motoboy, stats]) => {\n        const tempoMedio = stats.total > 0 ? Math.floor(stats.tempoTotal / stats.total) : 0;\n        const horasMedia = Math.floor(tempoMedio / 60);\n        const minutosMedia = tempoMedio % 60;\n        const tempoFormatado = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n        const porcentagem = Math.round((stats.total / maxTotal) * 100);\n        \n        return `\n            <div class=\"chart-item\" onclick=\"filtrarPorMotoboy('${motoboy}')\">\n                <div class=\"chart-label\">üèçÔ∏è ${motoboy}</div>\n                <div class=\"chart-stats\">\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value quantidade\">${stats.total}</div>\n                        <div class=\"chart-sublabel\">Casos</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value tempo\">${tempoFormatado}</div>\n                        <div class=\"chart-sublabel\">Tempo M√©dio</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value aprovadas\">${stats.aprovadas}</div>\n                        <div class=\"chart-sublabel\">Aprovadas</div>\n                    </div>\n                </div>\n                <div style=\"font-size: 10px; color: #6b7280; margin-top: 4px;\">\n                    ${stats.filiais.size} filial(is)\n                </div>\n                <div class=\"chart-barra\">\n                    <div class=\"chart-progress\" style=\"width: ${porcentagem}%;\"></div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico por cidades\nfunction gerarGraficoCidades() {\n    const cidadesStats = {};\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const cidade = item.CIDADE || 'N/A';\n        \n        if (!cidadesStats[cidade]) {\n            cidadesStats[cidade] = {\n                total: 0,\n                tempoTotal: 0,\n                aprovadas: 0,\n                motoboys: new Set()\n            };\n        }\n        \n        cidadesStats[cidade].total++;\n        cidadesStats[cidade].motoboys.add(item.NOME_MOTOBOY);\n        \n        // Calcular tempo\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        if (match) {\n            const [, dias, horas, minutos] = match;\n            const tempoMinutos = parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            cidadesStats[cidade].tempoTotal += tempoMinutos;\n        }\n        \n        if (item.APROVACAO_INTERCORRENCIA === 'TRUE') {\n            cidadesStats[cidade].aprovadas++;\n        }\n    });\n    \n    const container = document.getElementById('graficoCidades');\n    const maxTotal = Math.max(...Object.values(cidadesStats).map(s => s.total), 1);\n    \n    container.innerHTML = Object.entries(cidadesStats).map(([cidade, stats]) => {\n        const tempoMedio = stats.total > 0 ? Math.floor(stats.tempoTotal / stats.total) : 0;\n        const horasMedia = Math.floor(tempoMedio / 60);\n        const minutosMedia = tempoMedio % 60;\n        const tempoFormatado = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n        const porcentagem = Math.round((stats.total / maxTotal) * 100);\n        \n        return `\n            <div class=\"chart-item\" onclick=\"filtrarPorCidade('${cidade}')\">\n                <div class=\"chart-label\">üèôÔ∏è ${cidade}</div>\n                <div class=\"chart-stats\">\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value quantidade\">${stats.total}</div>\n                        <div class=\"chart-sublabel\">Total</div>\n                    </div>\n                    <div class=\"chart-stat\">\n                        <div class=\"chart-value tempo\">${tempoFormatado}</div>\n                        <div class=\"chart-sublabel\">M√©dio</div>\n                    </div>\n                </div>\n                <div style=\"font-size: 10px; color: #6b7280; margin: 4px 0;\">\n                    ${stats.motoboys.size} motoboys ‚Ä¢ ${stats.aprovadas} aprovadas\n                </div>\n                <div class=\"chart-barra\">\n                    <div class=\"chart-progress\" style=\"width: ${porcentagem}%;\"></div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar rankings\nfunction gerarRankings() {\n    const container = document.getElementById('rankingsContainer');\n    \n    // Top Motoboys com mais intercorr√™ncias\n    const motoboyStats = {};\n    intercorrenciasFiltradas.forEach(item => {\n        const motoboy = item.NOME_MOTOBOY || 'N/A';\n        motoboyStats[motoboy] = (motoboyStats[motoboy] || 0) + 1;\n    });\n    \n    const topMotoboys = Object.entries(motoboyStats)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5);\n    \n    // Top Descri√ß√µes mais comuns\n    const descricoesStats = {};\n    intercorrenciasFiltradas.forEach(item => {\n        const desc = (item.DESCRICAO || 'Sem descri√ß√£o').substring(0, 30);\n        descricoesStats[desc] = (descricoesStats[desc] || 0) + 1;\n    });\n    \n    const topDescricoes = Object.entries(descricoesStats)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5);\n    \n    container.innerHTML = `\n        <!-- Top Motoboys -->\n        <div style=\"background: #fef2f2; border: 2px solid #ef4444; border-radius: 8px; padding: 12px;\">\n            <div style=\"font-size: 12px; font-weight: 700; color: #ef4444; margin-bottom: 8px; text-align: center;\">\n                ü•á TOP 5 - Motoboys com Mais Intercorr√™ncias\n            </div>\n            ${topMotoboys.map((entry, index) => `\n                <div style=\"display: flex; justify-content: space-between; align-items: center; padding: 4px 0; border-bottom: 1px solid #fed7d7; font-size: 11px;\">\n                    <div>\n                        <span style=\"background: #ef4444; color: white; padding: 2px 6px; border-radius: 4px; font-weight: 700; margin-right: 8px;\">\n                            ${index + 1}¬∫\n                        </span>\n                        ${entry[0]}\n                    </div>\n                    <div style=\"font-weight: 700; color: #ef4444;\">\n                        ${entry[1]} casos\n                    </div>\n                </div>\n            `).join('')}\n        </div>\n        \n        <!-- Top Problemas -->\n        <div style=\"background: #f0f9ff; border: 2px solid #1890ff; border-radius: 8px; padding: 12px;\">\n            <div style=\"font-size: 12px; font-weight: 700; color: #1890ff; margin-bottom: 8px; text-align: center;\">\n                üìã TOP 5 - Problemas Mais Comuns\n            </div>\n            ${topDescricoes.map((entry, index) => `\n                <div style=\"display: flex; justify-content: space-between; align-items: center; padding: 4px 0; border-bottom: 1px solid #bfdbfe; font-size: 11px;\">\n                    <div style=\"flex: 1; overflow: hidden; text-overflow: ellipsis;\">\n                        <span style=\"background: #1890ff; color: white; padding: 2px 6px; border-radius: 4px; font-weight: 700; margin-right: 8px;\">\n                            ${index + 1}¬∫\n                        </span>\n                        ${entry[0]}...\n                    </div>\n                    <div style=\"font-weight: 700; color: #1890ff; margin-left: 8px;\">\n                        ${entry[1]}x\n                    </div>\n                </div>\n            `).join('')}\n        </div>\n    `;\n}\n\n// Toggle Analytics\nfunction toggleAnalytics() {\n    const content = document.getElementById('analyticsContent');\n    const btn = document.getElementById('btnToggleAnalytics');\n    \n    if (content.style.display === 'none') {\n        content.style.display = 'block';\n        btn.textContent = 'üìä Recolher';\n    } else {\n        content.style.display = 'none';\n        btn.textContent = 'üìä Expandir';\n    }\n}\n\n// Fun√ß√µes para filtrar pelos gr√°ficos\nfunction filtrarPorFilial(filial) {\n    console.log('üè¢ Filtrando por filial:', filial);\n    \n    // Limpar outros filtros e aplicar filtro de filial\n    document.getElementById('filtroAprovacao').value = '';\n    document.getElementById('filtroCidade').value = '';\n    document.getElementById('filtroMotoboy').value = '';\n    document.getElementById('filtroData').value = '';\n    document.getElementById('filtroPedido').value = '';\n    \n    // Aplicar filtro espec√≠fico por filial (usar campo correto)\n    intercorrenciasFiltradas = intercorrenciasOriginais.filter(item => item.ID_FILIAL === filial);\n    \n    atualizarEstatisticas();\n    renderizar();\n    atualizarResultados();\n    \n    console.log('‚úÖ Filtrado por filial ' + filial + ': ' + intercorrenciasFiltradas.length + ' registros');\n}\n\nfunction filtrarPorMotoboy(motoboy) {\n    console.log('üèçÔ∏è Filtrando por motoboy:', motoboy);\n    \n    // Limpar outros filtros\n    document.getElementById('filtroAprovacao').value = '';\n    document.getElementById('filtroCidade').value = '';\n    document.getElementById('filtroData').value = '';\n    document.getElementById('filtroPedido').value = '';\n    \n    // Aplicar filtro de motoboy\n    document.getElementById('filtroMotoboy').value = motoboy;\n    aplicarFiltros();\n}\n\nfunction filtrarPorCidade(cidade) {\n    console.log('üèôÔ∏è Filtrando por cidade:', cidade);\n    \n    // Limpar outros filtros  \n    document.getElementById('filtroAprovacao').value = '';\n    document.getElementById('filtroMotoboy').value = '';\n    document.getElementById('filtroData').value = '';\n    document.getElementById('filtroPedido').value = '';\n    \n    // Aplicar filtro de cidade\n    document.getElementById('filtroCidade').value = cidade;\n    aplicarFiltros();\n}\n\n// Alterar modo de visualiza√ß√£o\nfunction alterarModo(modo) {\n    modoVisualizacao = modo;\n    \n    document.getElementById('btnCards').classList.toggle('ativo', modo === 'cards');\n    document.getElementById('btnLista').classList.toggle('ativo', modo === 'lista');\n    \n    document.getElementById('intercorrenciasGrid').style.display = modo === 'cards' ? 'grid' : 'none';\n    document.getElementById('intercorrenciasLista').style.display = modo === 'lista' ? 'block' : 'none';\n    \n    renderizar();\n    console.log('üëÄ Modo alterado para:', modo);\n}\n\n// Limpar filtros\nfunction limparFiltros() {\n    document.getElementById('filtroAprovacao').value = '';\n    document.getElementById('filtroCidade').value = '';\n    document.getElementById('filtroMotoboy').value = '';\n    document.getElementById('filtroData').value = '';\n    document.getElementById('filtroPedido').value = '';\n    \n    aplicarFiltros();\n    console.log('üßπ Filtros limpos');\n}\n\n// Atualizar texto de resultados\nfunction atualizarResultados() {\n    const elemento = document.getElementById('resultadosFiltro');\n    if (intercorrenciasFiltradas.length === intercorrenciasOriginais.length) {\n        elemento.textContent = 'Mostrando todas as ' + intercorrenciasFiltradas.length + ' intercorr√™ncias';\n    } else {\n        elemento.textContent = 'Mostrando ' + intercorrenciasFiltradas.length + ' de ' + intercorrenciasOriginais.length + ' intercorr√™ncias';\n    }\n}\n\n// Abrir modal com imagem\nfunction abrirModal(urlImagem, idIntercorrencia) {\n    const modal = document.getElementById('modalImagem');\n    const conteudo = document.getElementById('modalImagemConteudo');\n    \n    conteudo.innerHTML = `\n        <div style=\"text-align: center;\">\n            <h3 style=\"color: #ef4444; margin-bottom: 16px;\">Intercorr√™ncia #${idIntercorrencia}</h3>\n            <img src=\"${urlImagem}\" \n                 alt=\"Foto da intercorr√™ncia\" \n                 style=\"max-width: 100%; max-height: 70vh; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2);\">\n            <div style=\"margin-top: 12px;\">\n                <a href=\"${urlImagem}\" target=\"_blank\" style=\"color: #1890ff; text-decoration: none; font-weight: 600;\">\n                    üîó Abrir em nova aba\n                </a>\n            </div>\n        </div>\n    `;\n    \n    modal.style.display = 'block';\n}\n\n// Fechar modal\nfunction fecharModal() {\n    document.getElementById('modalImagem').style.display = 'none';\n}\n\n// Abrir modal de timeline com intercorr√™ncias da hora\nfunction abrirModalTimelineHora(hora) {\n    console.log('üïê Abrindo modal para hora:', hora);\n    \n    const modal = document.getElementById('modalTimelineHora');\n    const title = document.getElementById('modalTimelineTitle');\n    const statsContainer = document.getElementById('modalTimelineStats');\n    const conteudo = document.getElementById('modalTimelineConteudo');\n    \n    // Filtrar intercorr√™ncias da hora espec√≠fica\n    const intercorrenciasHora = intercorrenciasFiltradas.filter(item => {\n        if (!item.DATA_INTERCORRENCIA) return false;\n        \n        try {\n            let dataHora;\n            if (typeof item.DATA_INTERCORRENCIA === 'string') {\n                dataHora = new Date(item.DATA_INTERCORRENCIA);\n            } else {\n                dataHora = new Date(item.DATA_INTERCORRENCIA);\n            }\n            \n            let itemHora = dataHora.getHours();\n            \n            if (isNaN(itemHora) && typeof item.DATA_INTERCORRENCIA === 'string') {\n                const timeMatch = item.DATA_INTERCORRENCIA.match(/(\\d{1,2}):(\\d{2})/);\n                if (timeMatch) {\n                    itemHora = parseInt(timeMatch[1]);\n                }\n            }\n            \n            return itemHora === hora;\n        } catch (e) {\n            return false;\n        }\n    });\n    \n    // Atualizar t√≠tulo\n    const horaFormatada = String(hora).padStart(2, '0') + ':00 - ' + String(hora).padStart(2, '0') + ':59';\n    title.innerHTML = `‚è∞ Intercorr√™ncias das ${horaFormatada}`;\n    \n    // Calcular estat√≠sticas\n    const total = intercorrenciasHora.length;\n    const aprovadas = intercorrenciasHora.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = intercorrenciasHora.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = intercorrenciasHora.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    \n    // Estat√≠sticas\n    statsContainer.innerHTML = `\n        <div class=\"modal-stat-item\">\n            <div class=\"modal-stat-value\">${total}</div>\n            <div class=\"modal-stat-label\">Total</div>\n        </div>\n        <div class=\"modal-stat-item\">\n            <div class=\"modal-stat-value\">${aprovadas}</div>\n            <div class=\"modal-stat-label\">‚úÖ Aprovadas</div>\n        </div>\n        <div class=\"modal-stat-item\">\n            <div class=\"modal-stat-value\">${reprovadas}</div>\n            <div class=\"modal-stat-label\">‚ùå Reprovadas</div>\n        </div>\n        <div class=\"modal-stat-item\">\n            <div class=\"modal-stat-value\">${pendentes}</div>\n            <div class=\"modal-stat-label\">‚è≥ Pendentes</div>\n        </div>\n    `;\n    \n    // Renderizar intercorr√™ncias\n    if (intercorrenciasHora.length === 0) {\n        conteudo.innerHTML = `\n            <div style=\"text-align: center; padding: 40px; color: #9ca3af;\">\n                <div style=\"font-size: 48px; margin-bottom: 16px;\">üì≠</div>\n                <div style=\"font-size: 16px; font-weight: 600;\">Nenhuma intercorr√™ncia neste hor√°rio</div>\n            </div>\n        `;\n    } else {\n        conteudo.innerHTML = intercorrenciasHora.map(item => {\n            const status = getStatusIntercorrencia(item);\n            let statusBadge = '‚è≥ Pendente';\n            let statusColor = '#f59e0b';\n            let statusBg = '#fef3c7';\n            let borderColor = '#f59e0b';\n            \n            if (status === 'APROVADO') {\n                statusBadge = '‚úÖ Aprovada';\n                statusColor = '#065f46';\n                statusBg = '#d1fae5';\n                borderColor = '#10b981';\n            } else if (status === 'REPROVADO') {\n                statusBadge = '‚ùå Reprovada';\n                statusColor = '#991b1b';\n                statusBg = '#fee2e2';\n                borderColor = '#dc2626';\n            }\n            \n            const tempoFormatado = formatarTempo(item.TEMPO_INTERCORRENCIA);\n            const dataFormatada = formatarData(item.DATA_INTERCORRENCIA);\n            \n            return `\n                <div class=\"timeline-modal-item\" style=\"border-left-color: ${borderColor};\" onclick=\"verDetalhesIntercorrencia(${item.ID_INTERCORRENCIA})\">\n                    <div class=\"timeline-modal-header\">\n                        <div class=\"timeline-modal-id\"># ${item.ID_INTERCORRENCIA}</div>\n                        <div class=\"timeline-modal-status\" style=\"background: ${statusBg}; color: ${statusColor}; border: 2px solid ${borderColor};\">\n                            ${statusBadge}\n                        </div>\n                    </div>\n                    \n                    <div class=\"timeline-modal-info\">\n                        <div><strong>üèçÔ∏è Motoboy:</strong> ${item.NOME_MOTOBOY || 'N/A'}</div>\n                        <div><strong>üèôÔ∏è Cidade:</strong> ${item.CIDADE || 'N/A'}</div>\n                        <div><strong>üì¶ Pedido:</strong> ${item.NUMPED || 'N/A'}</div>\n                        <div><strong>‚è∞ Tempo:</strong> ${tempoFormatado}</div>\n                        <div><strong>üè¢ Filial:</strong> ${item.ID_FILIAL || 'N/A'}</div>\n                        <div><strong>üìÖ Data:</strong> ${dataFormatada}</div>\n                    </div>\n                    \n                    ${item.DESCRICAO ? `\n                        <div class=\"timeline-modal-desc\">\n                            <strong>‚ö†Ô∏è Descri√ß√£o:</strong><br>\n                            ${item.DESCRICAO}\n                        </div>\n                    ` : ''}\n                    \n                    ${status !== 'PENDENTE' && item.JUSTIFICATIVA_APROVACAO ? `\n                        <div class=\"timeline-modal-desc\" style=\"background: ${statusBg}; padding: 8px; border-radius: 6px; margin-top: 8px;\">\n                            <strong>üí¨ Justificativa:</strong><br>\n                            ${item.JUSTIFICATIVA_APROVACAO}\n                            ${item.NOME_QUEM_APROVOU ? `<br><small><strong>Por:</strong> ${item.NOME_QUEM_APROVOU}</small>` : ''}\n                        </div>\n                    ` : ''}\n                </div>\n            `;\n        }).join('');\n    }\n    \n    // Mostrar modal\n    modal.style.display = 'block';\n}\n\n// Fechar modal de timeline\nfunction fecharModalTimeline() {\n    document.getElementById('modalTimelineHora').style.display = 'none';\n}\n\n// Ver detalhes de uma intercorr√™ncia espec√≠fica (voc√™ pode expandir isso)\nfunction verDetalhesIntercorrencia(id) {\n    console.log('üìã Ver detalhes da intercorr√™ncia:', id);\n    // Aqui voc√™ pode abrir outro modal ou rolar para o card da intercorr√™ncia\n    // Por enquanto, apenas fecha o modal e mostra um alerta\n    fecharModalTimeline();\n    \n    // Opcional: rolar para a aba de intercorr√™ncias e destacar o item\n    mudarAba('intercorrencias');\n    \n    // Tentar encontrar e destacar o card\n    setTimeout(() => {\n        const cards = document.querySelectorAll('.intercorrencia-card');\n        cards.forEach(card => {\n            const cardId = card.querySelector('.intercorrencia-id');\n            if (cardId && cardId.textContent.includes(id)) {\n                card.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                card.style.background = '#fff7ed';\n                setTimeout(() => {\n                    card.style.background = '';\n                }, 2000);\n            }\n        });\n    }, 300);\n}\n\n// Selecionar item da lista\nfunction selecionarItem(index) {\n    const item = intercorrenciasFiltradas[index];\n    console.log('üìã Item selecionado:', item.ID_INTERCORRENCIA);\n    \n    // Remover sele√ß√£o anterior\n    document.querySelectorAll('.lista-item').forEach(el => {\n        el.style.background = '';\n        el.style.fontWeight = '';\n    });\n    \n    // Destacar item selecionado\n    const itemElement = document.querySelectorAll('.lista-item')[index];\n    if (itemElement) {\n        itemElement.style.background = '#eff6ff';\n        itemElement.style.fontWeight = '700';\n    }\n    \n    // Aqui voc√™ pode disparar outros eventos, como abrir modal de detalhes\n}\n\n// Atualizar dados\nfunction atualizarDados() {\n    console.log('üîÑ Atualizando dados...');\n    location.reload();\n}\n\n// Exportar dados\nfunction exportarDados() {\n    console.log('üìä Exportando dados...');\n    \n    const dadosExport = intercorrenciasFiltradas.map(item => ({\n        ID: item.ID_INTERCORRENCIA,\n        Cidade: item.CIDADE,\n        Motoboy: item.NOME_MOTOBOY,\n        Pedido: item.NUMPED,\n        Data: item.DATA_INTERCORRENCIA,\n        Tempo: formatarTempo(item.TEMPO_INTERCORRENCIA),\n        Descricao: item.DESCRICAO,\n        Status: item.APROVACAO_INTERCORRENCIA === 'TRUE' ? 'Aprovada' : 'Pendente',\n        Lancamento: item.NOME_LANCAMENTO\n    }));\n    \n    const csvContent = 'data:text/csv;charset=utf-8,' + \n        'ID,Cidade,Motoboy,Pedido,Data,Tempo,Descricao,Status,Lancamento\\n' +\n        dadosExport.map(row => Object.values(row).map(val => '\"' + (val || '').toString().replace(/\"/g, '\"\"') + '\"').join(',')).join('\\n');\n    \n    const encodedUri = encodeURI(csvContent);\n    const link = document.createElement('a');\n    link.setAttribute('href', encodedUri);\n    link.setAttribute('download', 'intercorrencias_' + new Date().toISOString().split('T')[0] + '.csv');\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    \n    console.log('üìä CSV exportado com ' + dadosExport.length + ' registros');\n}\n\n// Mudar de aba\nfunction mudarAba(aba) {\n    // Remover active de todos os bot√µes e conte√∫dos\n    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));\n    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));\n    \n    // Ativar a aba selecionada\n    const abaMap = {\n        'dashboard': 'tabDashboard',\n        'intercorrencias': 'tabIntercorrencias',\n        'motoboys': 'tabMotoboys',\n        'filiais': 'tabFiliais',\n        'analytics': 'tabAnalytics'\n    };\n    \n    document.getElementById(abaMap[aba]).classList.add('active');\n    event.target.classList.add('active');\n    \n    // Se for analytics, gerar gr√°ficos avan√ßados\n    if (aba === 'analytics') {\n        gerarGraficosAvancados();\n    } else if (aba === 'motoboys') {\n        inicializarAbaMotoboys();\n    } else if (aba === 'filiais') {\n        inicializarAbaFiliais();\n    }\n    \n    console.log('üìë Aba alterada para:', aba);\n}\n\n// Inicializar aba de Motoboys\nfunction inicializarAbaMotoboys() {\n    console.log('üèçÔ∏è Inicializando aba de Motoboys...');\n    \n    // Popular select de motoboys\n    const motoboys = [...new Set(intercorrenciasOriginais.map(i => i.NOME_MOTOBOY))].filter(m => m).sort();\n    const select = document.getElementById('selectMotoboy');\n    select.innerHTML = '<option value=\"\">Selecione um motoboy...</option>';\n    motoboys.forEach(motoboy => {\n        select.innerHTML += `<option value=\"${motoboy}\">${motoboy}</option>`;\n    });\n    \n    // Gerar tabela comparativa\n    gerarTabelaComparacaoMotoboys();\n}\n\n// Vari√°vel para controlar modo de visualiza√ß√£o (UF ou Filial)\nlet modoFilial = 'uf';\n\n// Alterar modo de visualiza√ß√£o da filial\nfunction alterarModoFilial(modo) {\n    modoFilial = modo;\n    \n    document.getElementById('btnUF').classList.toggle('ativo', modo === 'uf');\n    document.getElementById('btnFilial').classList.toggle('ativo', modo === 'filial');\n    \n    inicializarAbaFiliais();\n    \n    // Limpar sele√ß√£o\n    document.getElementById('selectFilial').value = '';\n    document.getElementById('detalhesFilial').style.display = 'none';\n    \n    console.log('üîÑ Modo filial alterado para:', modo);\n}\n\n// Inicializar aba de Filiais\nfunction inicializarAbaFiliais() {\n    console.log('üè¢ Inicializando aba de Filiais em modo:', modoFilial);\n    \n    const select = document.getElementById('selectFilial');\n    \n    if (modoFilial === 'uf') {\n        // DEBUG: Mostrar exemplos de extra√ß√£o de UF\n        console.log('üó∫Ô∏è === DEBUG EXTRA√á√ÉO DE UF ===');\n        const exemplos = intercorrenciasOriginais.slice(0, 10);\n        exemplos.forEach(item => {\n            const uf = extrairUF(item);\n            console.log(`CIDADE: \"${item.CIDADE}\" ‚Üí UF: \"${uf}\"`);\n        });\n        console.log('================================');\n        \n        // Popular select com UFs (extrair da cidade ou ter campo UF)\n        const ufsMap = {};\n        intercorrenciasOriginais.forEach(i => {\n            const uf = extrairUF(i);\n            if (uf) {\n                if (!ufsMap[uf]) {\n                    ufsMap[uf] = 0;\n                }\n                ufsMap[uf]++;\n            }\n        });\n        \n        const ufs = Object.keys(ufsMap).sort();\n        \n        console.log('üìä UFs encontradas:', ufsMap);\n        \n        select.innerHTML = '<option value=\"\">Selecione um estado (UF)...</option>';\n        ufs.forEach(uf => {\n            const count = ufsMap[uf];\n            select.innerHTML += `<option value=\"${uf}\">${uf} (${count} intercorr√™ncias)</option>`;\n        });\n        \n        if (ufs.length === 0) {\n            console.warn('‚ö†Ô∏è ATEN√á√ÉO: Nenhuma UF foi extra√≠da! Verifique o formato do campo CIDADE.');\n            select.innerHTML += '<option disabled>Nenhuma UF encontrada - Verifique os dados</option>';\n        }\n    } else {\n        // Popular select de filiais\n        const filiais = [...new Set(intercorrenciasOriginais.map(i => i.ID_FILIAL))].filter(f => f).sort();\n        select.innerHTML = '<option value=\"\">Selecione uma filial...</option>';\n        filiais.forEach(filial => {\n            select.innerHTML += `<option value=\"${filial}\">Filial ${filial}</option>`;\n        });\n    }\n    \n    // Gerar tabela comparativa\n    gerarTabelaComparacaoFiliais();\n}\n\n// Fun√ß√£o para extrair UF da cidade ou de campo espec√≠fico\nfunction extrairUF(item) {\n    // Se tiver campo UF direto\n    if (item.UF && typeof item.UF === 'string' && item.UF.length === 2) {\n        return item.UF.toUpperCase();\n    }\n    if (item.ESTADO && typeof item.ESTADO === 'string' && item.ESTADO.length === 2) {\n        return item.ESTADO.toUpperCase();\n    }\n    \n    // Extrair da cidade - PRIORIDADE (pois √© de onde v√™m os dados do intercorrencias_bi20)\n    if (item.CIDADE && typeof item.CIDADE === 'string') {\n        const cidade = item.CIDADE.trim();\n        \n        // Formato 1: \"CIDADE - UF\" (ex: \"SAO PAULO - SP\")\n        let match = cidade.match(/\\-\\s*([A-Z]{2})\\s*$/i);\n        if (match) return match[1].toUpperCase();\n        \n        // Formato 2: \"CIDADE/UF\" (ex: \"SAO PAULO/SP\")\n        match = cidade.match(/\\/\\s*([A-Z]{2})\\s*$/i);\n        if (match) return match[1].toUpperCase();\n        \n        // Formato 3: \"CIDADE (UF)\" (ex: \"SAO PAULO (SP)\")\n        match = cidade.match(/\\(\\s*([A-Z]{2})\\s*\\)$/i);\n        if (match) return match[1].toUpperCase();\n        \n        // Formato 4: \"CIDADE,UF\" (ex: \"SAO PAULO,SP\")\n        match = cidade.match(/,\\s*([A-Z]{2})\\s*$/i);\n        if (match) return match[1].toUpperCase();\n        \n        // Formato 5: Apenas 2 √∫ltimas letras se a cidade termina com espa√ßo + 2 letras\n        match = cidade.match(/\\s([A-Z]{2})$/i);\n        if (match) return match[1].toUpperCase();\n        \n        // Formato 6: Procurar por siglas de UF conhecidas no texto\n        const ufsConhecidas = [\n            'AC', 'AL', 'AP', 'AM', 'BA', 'CE', 'DF', 'ES', 'GO', 'MA',\n            'MT', 'MS', 'MG', 'PA', 'PB', 'PR', 'PE', 'PI', 'RJ', 'RN',\n            'RS', 'RO', 'RR', 'SC', 'SP', 'SE', 'TO'\n        ];\n        \n        for (const uf of ufsConhecidas) {\n            // Procurar UF como palavra separada no final\n            const regex = new RegExp(`[\\\\s\\\\-\\\\/,\\\\(]+(${uf})\\\\s*[\\\\)]?\\\\s*$`, 'i');\n            if (regex.test(cidade)) {\n                return uf;\n            }\n        }\n    }\n    \n    // Se tiver campo ID_FILIAL, mapear para UF conhecidos (fallback)\n    const mapeamentoFilialUF = {\n        '1': 'SP',\n        '2': 'RJ',\n        '3': 'MG',\n        '4': 'RS',\n        '5': 'PR',\n        '6': 'SC',\n        '7': 'BA',\n        '8': 'PE',\n        '9': 'CE',\n        '10': 'GO',\n        '11': 'DF',\n        '12': 'ES',\n        '13': 'MA',\n        '14': 'PA',\n        '15': 'PB',\n        '16': 'PI',\n        '17': 'RN',\n        '18': 'SE',\n        '19': 'AL',\n        '20': 'MT',\n        '21': 'MS',\n        '22': 'AC',\n        '23': 'RO',\n        '24': 'RR',\n        '25': 'AP',\n        '26': 'AM',\n        '27': 'TO'\n        // Adicione ou ajuste conforme necess√°rio\n    };\n    \n    if (item.ID_FILIAL && mapeamentoFilialUF[item.ID_FILIAL]) {\n        return mapeamentoFilialUF[item.ID_FILIAL];\n    }\n    \n    return null;\n}\n\n// Analisar motoboy espec√≠fico\nfunction analisarMotoboy() {\n    const motoboyNome = document.getElementById('selectMotoboy').value;\n    \n    if (!motoboyNome) {\n        document.getElementById('detalhesMotoboy').style.display = 'none';\n        return;\n    }\n    \n    console.log('üèçÔ∏è Analisando motoboy:', motoboyNome);\n    \n    // Filtrar intercorr√™ncias do motoboy\n    const dadosMotoboy = intercorrenciasOriginais.filter(i => i.NOME_MOTOBOY === motoboyNome);\n    \n    // Atualizar insights\n    const total = dadosMotoboy.length;\n    const aprovadas = dadosMotoboy.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const taxa = total > 0 ? Math.round((aprovadas / total) * 100) : 0;\n    \n    // Calcular tempo m√©dio\n    let tempoMedioMinutos = 0;\n    if (total > 0) {\n        const tempos = dadosMotoboy.map(item => {\n            const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n            const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n            if (match) {\n                const [, dias, horas, minutos] = match;\n                return parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            }\n            return 0;\n        });\n        tempoMedioMinutos = Math.floor(tempos.reduce((sum, t) => sum + t, 0) / tempos.length);\n    }\n    \n    const horasMedia = Math.floor(tempoMedioMinutos / 60);\n    const minutosMedia = tempoMedioMinutos % 60;\n    \n    document.getElementById('mbTotalIntercorrencias').textContent = total;\n    document.getElementById('mbTaxaAprovacao').textContent = taxa + '%';\n    document.getElementById('mbTempoMedio').textContent = horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n    \n    // Gerar gr√°ficos\n    gerarGraficoStatusMotoboy(dadosMotoboy);\n    gerarGraficoCidadesMotoboy(dadosMotoboy);\n    gerarGraficoHorariosMotoboy(dadosMotoboy);\n    gerarGraficoProblemasMotoboy(dadosMotoboy);\n    gerarHistoricoMotoboy(dadosMotoboy);\n    \n    // Mostrar detalhes\n    document.getElementById('detalhesMotoboy').style.display = 'block';\n}\n\n// Gerar gr√°fico de status por motoboy\nfunction gerarGraficoStatusMotoboy(dados) {\n    const container = document.getElementById('mbGraficoStatus');\n    const aprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = dados.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    \n    const maxVal = Math.max(aprovadas, reprovadas, pendentes, 1);\n    \n    container.innerHTML = `\n        <div class=\"bar-item\">\n            <div class=\"bar-label\">‚úÖ Aprovadas</div>\n            <div class=\"bar-wrapper\">\n                <div class=\"bar-fill\" style=\"width: ${Math.round((aprovadas / maxVal) * 100)}%; background: #10b981;\">\n                    <div class=\"bar-value\">${aprovadas}</div>\n                </div>\n            </div>\n        </div>\n        <div class=\"bar-item\">\n            <div class=\"bar-label\">‚ùå Reprovadas</div>\n            <div class=\"bar-wrapper\">\n                <div class=\"bar-fill\" style=\"width: ${Math.round((reprovadas / maxVal) * 100)}%; background: #dc2626;\">\n                    <div class=\"bar-value\">${reprovadas}</div>\n                </div>\n            </div>\n        </div>\n        <div class=\"bar-item\">\n            <div class=\"bar-label\">‚è≥ Pendentes</div>\n            <div class=\"bar-wrapper\">\n                <div class=\"bar-fill\" style=\"width: ${Math.round((pendentes / maxVal) * 100)}%; background: #f59e0b;\">\n                    <div class=\"bar-value\">${pendentes}</div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n// Gerar gr√°fico de cidades por motoboy\nfunction gerarGraficoCidadesMotoboy(dados) {\n    const container = document.getElementById('mbGraficoCidades');\n    const cidadesStats = {};\n    \n    dados.forEach(item => {\n        const cidade = item.CIDADE || 'N/A';\n        cidadesStats[cidade] = (cidadesStats[cidade] || 0) + 1;\n    });\n    \n    const cidadesOrdenadas = Object.entries(cidadesStats).sort((a, b) => b[1] - a[1]);\n    const maxVal = Math.max(...Object.values(cidadesStats), 1);\n    \n    container.innerHTML = cidadesOrdenadas.map(([cidade, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${cidade}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico de hor√°rios por motoboy\nfunction gerarGraficoHorariosMotoboy(dados) {\n    const container = document.getElementById('mbGraficoHorarios');\n    const horarioStats = {};\n    \n    dados.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            try {\n                const data = new Date(item.DATA_INTERCORRENCIA);\n                const hora = data.getHours();\n                if (!isNaN(hora)) {\n                    const faixa = String(hora).padStart(2, '0') + ':00';\n                    horarioStats[faixa] = (horarioStats[faixa] || 0) + 1;\n                }\n            } catch (e) {}\n        }\n    });\n    \n    const horariosOrdenados = Object.entries(horarioStats).sort((a, b) => b[1] - a[1]).slice(0, 10);\n    const maxVal = Math.max(...Object.values(horarioStats), 1);\n    \n    container.innerHTML = horariosOrdenados.map(([horario, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${horario}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico de problemas por motoboy\nfunction gerarGraficoProblemasMotoboy(dados) {\n    const container = document.getElementById('mbGraficoProblemas');\n    const problemasStats = {};\n    \n    dados.forEach(item => {\n        const problema = (item.DESCRICAO || 'Sem descri√ß√£o').substring(0, 40);\n        problemasStats[problema] = (problemasStats[problema] || 0) + 1;\n    });\n    \n    const problemasOrdenados = Object.entries(problemasStats).sort((a, b) => b[1] - a[1]).slice(0, 5);\n    const maxVal = Math.max(...Object.values(problemasStats), 1);\n    \n    container.innerHTML = problemasOrdenados.map(([problema, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\" style=\"min-width: 200px; max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;\" title=\"${problema}\">${problema}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar hist√≥rico do motoboy\nfunction gerarHistoricoMotoboy(dados) {\n    const container = document.getElementById('mbHistorico');\n    \n    const dadosOrdenados = [...dados].sort((a, b) => {\n        return new Date(b.DATA_INTERCORRENCIA) - new Date(a.DATA_INTERCORRENCIA);\n    }).slice(0, 10);\n    \n    container.innerHTML = `\n        <div style=\"display: grid; gap: 12px;\">\n            ${dadosOrdenados.map(item => {\n                const status = getStatusIntercorrencia(item);\n                let statusBadge = '‚è≥ Pendente';\n                let statusColor = '#f59e0b';\n                \n                if (status === 'APROVADO') {\n                    statusBadge = '‚úÖ Aprovada';\n                    statusColor = '#10b981';\n                } else if (status === 'REPROVADO') {\n                    statusBadge = '‚ùå Reprovada';\n                    statusColor = '#dc2626';\n                }\n                \n                return `\n                    <div style=\"background: #f9fafb; padding: 12px; border-radius: 8px; border-left: 4px solid ${statusColor};\">\n                        <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;\">\n                            <strong style=\"color: #ef4444;\"># ${item.ID_INTERCORRENCIA}</strong>\n                            <span style=\"background: ${statusColor}; color: white; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 700;\">${statusBadge}</span>\n                        </div>\n                        <div style=\"font-size: 11px; color: #6b7280;\">\n                            <div>üìÖ ${formatarData(item.DATA_INTERCORRENCIA)} | ‚è∞ ${formatarTempo(item.TEMPO_INTERCORRENCIA)}</div>\n                            <div>üèôÔ∏è ${item.CIDADE} | üì¶ Pedido: ${item.NUMPED}</div>\n                            <div style=\"margin-top: 4px;\">‚ö†Ô∏è ${item.DESCRICAO || 'Sem descri√ß√£o'}</div>\n                        </div>\n                    </div>\n                `;\n            }).join('')}\n        </div>\n    `;\n}\n\n// Gerar tabela de compara√ß√£o de motoboys\nfunction gerarTabelaComparacaoMotoboys() {\n    const tbody = document.getElementById('bodyTabelaMotoboys');\n    \n    // Calcular estat√≠sticas por motoboy\n    const motoboyStats = {};\n    \n    intercorrenciasOriginais.forEach(item => {\n        const motoboy = item.NOME_MOTOBOY || 'N/A';\n        \n        if (!motoboyStats[motoboy]) {\n            motoboyStats[motoboy] = {\n                total: 0,\n                aprovadas: 0,\n                reprovadas: 0,\n                pendentes: 0,\n                tempoTotal: 0,\n                cidades: new Set()\n            };\n        }\n        \n        motoboyStats[motoboy].total++;\n        motoboyStats[motoboy].cidades.add(item.CIDADE);\n        \n        const status = getStatusIntercorrencia(item);\n        if (status === 'APROVADO') motoboyStats[motoboy].aprovadas++;\n        else if (status === 'REPROVADO') motoboyStats[motoboy].reprovadas++;\n        else motoboyStats[motoboy].pendentes++;\n        \n        // Calcular tempo\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        if (match) {\n            const [, dias, horas, minutos] = match;\n            motoboyStats[motoboy].tempoTotal += parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n        }\n    });\n    \n    // Ordenar por total de intercorr√™ncias\n    const ranking = Object.entries(motoboyStats).sort((a, b) => b[1].total - a[1].total);\n    \n    tbody.innerHTML = ranking.map(([motoboy, stats], index) => {\n        const tempoMedio = stats.total > 0 ? Math.floor(stats.tempoTotal / stats.total) : 0;\n        const horas = Math.floor(tempoMedio / 60);\n        const minutos = tempoMedio % 60;\n        const tempoFormatado = horas + ':' + String(minutos).padStart(2, '0');\n        const taxaAprovacao = stats.total > 0 ? Math.round((stats.aprovadas / stats.total) * 100) : 0;\n        \n        return `\n            <tr>\n                <td class=\"rank-cell\">${index + 1}¬∫</td>\n                <td style=\"font-weight: 700;\">${motoboy}</td>\n                <td><strong>${stats.total}</strong></td>\n                <td style=\"color: #10b981;\">${stats.aprovadas}</td>\n                <td style=\"color: #dc2626;\">${stats.reprovadas}</td>\n                <td style=\"color: #f59e0b;\">${stats.pendentes}</td>\n                <td><strong>${taxaAprovacao}%</strong></td>\n                <td>${tempoFormatado}</td>\n                <td>${stats.cidades.size}</td>\n            </tr>\n        `;\n    }).join('');\n}\n\n// Analisar filial espec√≠fica\nfunction analisarFilial() {\n    const valorSelecionado = document.getElementById('selectFilial').value;\n    \n    if (!valorSelecionado) {\n        document.getElementById('detalhesFilial').style.display = 'none';\n        return;\n    }\n    \n    console.log('üè¢ Analisando', modoFilial === 'uf' ? 'UF' : 'filial', ':', valorSelecionado);\n    \n    // Filtrar intercorr√™ncias conforme modo\n    let dadosFilial;\n    if (modoFilial === 'uf') {\n        dadosFilial = intercorrenciasOriginais.filter(i => extrairUF(i) === valorSelecionado);\n    } else {\n        dadosFilial = intercorrenciasOriginais.filter(i => i.ID_FILIAL === valorSelecionado);\n    }\n    \n    // Atualizar insights\n    const total = dadosFilial.length;\n    const aprovadas = dadosFilial.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const taxa = total > 0 ? Math.round((aprovadas / total) * 100) : 0;\n    const motoboys = new Set(dadosFilial.map(i => i.NOME_MOTOBOY)).size;\n    \n    document.getElementById('flTotalIntercorrencias').textContent = total;\n    document.getElementById('flTaxaAprovacao').textContent = taxa + '%';\n    document.getElementById('flTotalMotoboys').textContent = motoboys;\n    \n    // Gerar gr√°ficos\n    gerarGraficoStatusFilial(dadosFilial);\n    gerarGraficoCidadesFilial(dadosFilial);\n    gerarGraficoMotoboyFilial(dadosFilial);\n    gerarGraficoHorariosFilial(dadosFilial);\n    gerarGraficoProblemasFilial(dadosFilial);\n    \n    // Mostrar detalhes\n    document.getElementById('detalhesFilial').style.display = 'block';\n}\n\n// Gerar gr√°fico de status por filial\nfunction gerarGraficoStatusFilial(dados) {\n    const container = document.getElementById('flGraficoStatus');\n    const aprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const reprovadas = dados.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n    const pendentes = dados.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n    \n    const maxVal = Math.max(aprovadas, reprovadas, pendentes, 1);\n    \n    container.innerHTML = `\n        <div class=\"bar-item\">\n            <div class=\"bar-label\">‚úÖ Aprovadas</div>\n            <div class=\"bar-wrapper\">\n                <div class=\"bar-fill\" style=\"width: ${Math.round((aprovadas / maxVal) * 100)}%; background: #10b981;\">\n                    <div class=\"bar-value\">${aprovadas}</div>\n                </div>\n            </div>\n        </div>\n        <div class=\"bar-item\">\n            <div class=\"bar-label\">‚ùå Reprovadas</div>\n            <div class=\"bar-wrapper\">\n                <div class=\"bar-fill\" style=\"width: ${Math.round((reprovadas / maxVal) * 100)}%; background: #dc2626;\">\n                    <div class=\"bar-value\">${reprovadas}</div>\n                </div>\n            </div>\n        </div>\n        <div class=\"bar-item\">\n            <div class=\"bar-label\">‚è≥ Pendentes</div>\n            <div class=\"bar-wrapper\">\n                <div class=\"bar-fill\" style=\"width: ${Math.round((pendentes / maxVal) * 100)}%; background: #f59e0b;\">\n                    <div class=\"bar-value\">${pendentes}</div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n// Gerar gr√°fico de cidades por filial\nfunction gerarGraficoCidadesFilial(dados) {\n    const container = document.getElementById('flGraficoCidades');\n    const cidadesStats = {};\n    \n    dados.forEach(item => {\n        const cidade = item.CIDADE || 'N/A';\n        cidadesStats[cidade] = (cidadesStats[cidade] || 0) + 1;\n    });\n    \n    const cidadesOrdenadas = Object.entries(cidadesStats).sort((a, b) => b[1] - a[1]);\n    const maxVal = Math.max(...Object.values(cidadesStats), 1);\n    \n    container.innerHTML = cidadesOrdenadas.map(([cidade, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${cidade}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico de motoboys por filial\nfunction gerarGraficoMotoboyFilial(dados) {\n    const container = document.getElementById('flGraficoMotoboys');\n    const motoboyStats = {};\n    \n    dados.forEach(item => {\n        const motoboy = item.NOME_MOTOBOY || 'N/A';\n        motoboyStats[motoboy] = (motoboyStats[motoboy] || 0) + 1;\n    });\n    \n    const motoboyOrdenados = Object.entries(motoboyStats).sort((a, b) => b[1] - a[1]).slice(0, 10);\n    const maxVal = Math.max(...Object.values(motoboyStats), 1);\n    \n    container.innerHTML = motoboyOrdenados.map(([motoboy, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${motoboy}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico de hor√°rios por filial\nfunction gerarGraficoHorariosFilial(dados) {\n    const container = document.getElementById('flGraficoHorarios');\n    const horarioStats = {};\n    \n    dados.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            try {\n                const data = new Date(item.DATA_INTERCORRENCIA);\n                const hora = data.getHours();\n                if (!isNaN(hora)) {\n                    const faixa = String(hora).padStart(2, '0') + ':00';\n                    horarioStats[faixa] = (horarioStats[faixa] || 0) + 1;\n                }\n            } catch (e) {}\n        }\n    });\n    \n    const horariosOrdenados = Object.entries(horarioStats).sort((a, b) => b[1] - a[1]).slice(0, 10);\n    const maxVal = Math.max(...Object.values(horarioStats), 1);\n    \n    container.innerHTML = horariosOrdenados.map(([horario, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${horario}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico de problemas por filial\nfunction gerarGraficoProblemasFilial(dados) {\n    const container = document.getElementById('flGraficoProblemas');\n    const problemasStats = {};\n    \n    dados.forEach(item => {\n        const problema = (item.DESCRICAO || 'Sem descri√ß√£o').substring(0, 40);\n        problemasStats[problema] = (problemasStats[problema] || 0) + 1;\n    });\n    \n    const problemasOrdenados = Object.entries(problemasStats).sort((a, b) => b[1] - a[1]).slice(0, 10);\n    const maxVal = Math.max(...Object.values(problemasStats), 1);\n    \n    container.innerHTML = problemasOrdenados.map(([problema, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\" style=\"min-width: 200px; max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;\" title=\"${problema}\">${problema}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar tabela de compara√ß√£o de filiais\nfunction gerarTabelaComparacaoFiliais() {\n    const tbody = document.getElementById('bodyTabelaFiliais');\n    \n    // Calcular estat√≠sticas por filial ou UF\n    const filialStats = {};\n    \n    intercorrenciasOriginais.forEach(item => {\n        let chave;\n        if (modoFilial === 'uf') {\n            chave = extrairUF(item) || 'N/A';\n        } else {\n            chave = item.ID_FILIAL || 'N/A';\n        }\n        \n        if (!filialStats[chave]) {\n            filialStats[chave] = {\n                total: 0,\n                aprovadas: 0,\n                reprovadas: 0,\n                pendentes: 0,\n                tempoTotal: 0,\n                motoboys: new Set(),\n                cidades: new Set()\n            };\n        }\n        \n        filialStats[chave].total++;\n        filialStats[chave].motoboys.add(item.NOME_MOTOBOY);\n        filialStats[chave].cidades.add(item.CIDADE);\n        \n        const status = getStatusIntercorrencia(item);\n        if (status === 'APROVADO') filialStats[chave].aprovadas++;\n        else if (status === 'REPROVADO') filialStats[chave].reprovadas++;\n        else filialStats[chave].pendentes++;\n        \n        // Calcular tempo\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        if (match) {\n            const [, dias, horas, minutos] = match;\n            filialStats[chave].tempoTotal += parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n        }\n    });\n    \n    // Ordenar por total de intercorr√™ncias\n    const ranking = Object.entries(filialStats).sort((a, b) => b[1].total - a[1].total);\n    \n    const labelColuna = modoFilial === 'uf' ? 'Estado (UF)' : 'Filial';\n    \n    // Atualizar header da tabela\n    document.querySelector('#tabelaComparacaoFiliais thead tr').innerHTML = `\n        <th>Rank</th>\n        <th>${labelColuna}</th>\n        <th>Total</th>\n        <th>Aprovadas</th>\n        <th>Reprovadas</th>\n        <th>Pendentes</th>\n        <th>Taxa Aprov.</th>\n        <th>Tempo M√©dio</th>\n        <th>Motoboys</th>\n        <th>Cidades</th>\n    `;\n    \n    tbody.innerHTML = ranking.map(([chave, stats], index) => {\n        const tempoMedio = stats.total > 0 ? Math.floor(stats.tempoTotal / stats.total) : 0;\n        const horas = Math.floor(tempoMedio / 60);\n        const minutos = tempoMedio % 60;\n        const tempoFormatado = horas + ':' + String(minutos).padStart(2, '0');\n        const taxaAprovacao = stats.total > 0 ? Math.round((stats.aprovadas / stats.total) * 100) : 0;\n        \n        const labelChave = modoFilial === 'uf' ? chave : `Filial ${chave}`;\n        \n        return `\n            <tr>\n                <td class=\"rank-cell\">${index + 1}¬∫</td>\n                <td style=\"font-weight: 700;\">${labelChave}</td>\n                <td><strong>${stats.total}</strong></td>\n                <td style=\"color: #10b981;\">${stats.aprovadas}</td>\n                <td style=\"color: #dc2626;\">${stats.reprovadas}</td>\n                <td style=\"color: #f59e0b;\">${stats.pendentes}</td>\n                <td><strong>${taxaAprovacao}%</strong></td>\n                <td>${tempoFormatado}</td>\n                <td>${stats.motoboys.size}</td>\n                <td>${stats.cidades.size}</td>\n            </tr>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°ficos avan√ßados (aba Analytics)\nfunction gerarGraficosAvancados() {\n    console.log('üìà Gerando gr√°ficos avan√ßados...');\n    \n    gerarHeatmapHorarios();\n    gerarTimelineChart();\n    gerarGraficoDiaSemana();\n    gerarGraficoPeriodoDia();\n    gerarGraficoTempoResolucao();\n    gerarGraficoTopCausas();\n    atualizarInsights();\n}\n\n// Gerar gr√°fico de timeline com linha e pontos\nfunction gerarTimelineChart() {\n    const container = document.getElementById('timelineChart');\n    const horarioStats = {};\n    \n    // Inicializar todas as horas\n    for (let h = 0; h < 24; h++) {\n        horarioStats[h] = 0;\n    }\n    \n    // Contar intercorr√™ncias por hora\n    intercorrenciasFiltradas.forEach(item => {\n        let hora = null;\n        \n        if (item.DATA_INTERCORRENCIA) {\n            try {\n                let dataHora;\n                if (typeof item.DATA_INTERCORRENCIA === 'string') {\n                    dataHora = new Date(item.DATA_INTERCORRENCIA);\n                } else {\n                    dataHora = new Date(item.DATA_INTERCORRENCIA);\n                }\n                \n                hora = dataHora.getHours();\n                \n                if (isNaN(hora) && typeof item.DATA_INTERCORRENCIA === 'string') {\n                    const timeMatch = item.DATA_INTERCORRENCIA.match(/(\\d{1,2}):(\\d{2})/);\n                    if (timeMatch) {\n                        hora = parseInt(timeMatch[1]);\n                    }\n                }\n            } catch (e) {}\n        }\n        \n        if (hora !== null && !isNaN(hora) && hora >= 0 && hora < 24) {\n            horarioStats[hora]++;\n        }\n    });\n    \n    // Encontrar valor m√°ximo para escala\n    const maxVal = Math.max(...Object.values(horarioStats), 1);\n    \n    // Configura√ß√µes do gr√°fico\n    const width = 1000;\n    const height = 250;\n    const padding = 40;\n    const chartWidth = width - (padding * 2);\n    const chartHeight = height - (padding * 2);\n    \n    // Criar pontos para linha\n    const points = [];\n    for (let h = 0; h < 24; h++) {\n        const x = padding + (h / 23) * chartWidth;\n        const y = height - padding - ((horarioStats[h] / maxVal) * chartHeight);\n        points.push({ x, y, hora: h, count: horarioStats[h] });\n    }\n    \n    // Criar path para linha\n    const linePath = points.map((p, i) => `${i === 0 ? 'M' : 'L'} ${p.x} ${p.y}`).join(' ');\n    \n    // Criar √°rea preenchida\n    const areaPath = `M ${padding} ${height - padding} L ${points.map(p => `${p.x} ${p.y}`).join(' L ')} L ${padding + chartWidth} ${height - padding} Z`;\n    \n    container.innerHTML = `\n        <svg width=\"100%\" height=\"${height}\" viewBox=\"0 0 ${width} ${height}\" style=\"background: white; border-radius: 8px;\">\n            <!-- Grid lines -->\n            ${[0, 0.25, 0.5, 0.75, 1].map(factor => {\n                const y = height - padding - (chartHeight * factor);\n                const value = Math.round(maxVal * factor);\n                return `\n                    <line x1=\"${padding}\" y1=\"${y}\" x2=\"${width - padding}\" y2=\"${y}\" \n                          stroke=\"#e5e7eb\" stroke-width=\"1\" stroke-dasharray=\"5,5\"/>\n                    <text x=\"${padding - 10}\" y=\"${y + 4}\" text-anchor=\"end\" \n                          font-size=\"10\" fill=\"#9ca3af\">${value}</text>\n                `;\n            }).join('')}\n            \n            <!-- √Årea preenchida -->\n            <path d=\"${areaPath}\" fill=\"url(#gradient)\" opacity=\"0.3\"/>\n            \n            <!-- Gradiente -->\n            <defs>\n                <linearGradient id=\"gradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                    <stop offset=\"0%\" style=\"stop-color:#ef4444;stop-opacity:0.8\" />\n                    <stop offset=\"100%\" style=\"stop-color:#ef4444;stop-opacity:0.1\" />\n                </linearGradient>\n            </defs>\n            \n            <!-- Linha principal -->\n            <path d=\"${linePath}\" fill=\"none\" stroke=\"#ef4444\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            \n            <!-- Pontos (bolas) -->\n            ${points.map(p => {\n                // Tamanho da bola baseado na quantidade\n                const radius = p.count === 0 ? 3 : Math.min(3 + (p.count / maxVal) * 5, 10);\n                const color = p.count === 0 ? '#d1d5db' : \n                             p.count <= 2 ? '#10b981' :\n                             p.count <= 5 ? '#f59e0b' :\n                             p.count <= 10 ? '#f97316' : '#ef4444';\n                \n                const clickHandler = p.count > 0 ? 'abrirModalTimelineHora(' + p.hora + ')' : '';\n                \n                return `\n                    <circle class=\"timeline-point\" cx=\"${p.x}\" cy=\"${p.y}\" r=\"${radius}\" \n                            fill=\"${color}\" stroke=\"white\" stroke-width=\"2\"\n                            style=\"cursor: ${p.count > 0 ? 'pointer' : 'default'};\"\n                            onclick=\"${clickHandler}\">\n                        <title>${String(p.hora).padStart(2, '0')}:00 - ${p.count} intercorr√™ncia(s)${p.count > 0 ? ' - Clique para ver detalhes' : ''}</title>\n                    </circle>\n                    <text x=\"${p.x}\" y=\"${height - padding + 20}\" text-anchor=\"middle\" \n                          font-size=\"9\" fill=\"#6b7280\" font-weight=\"600\"\n                          style=\"pointer-events: none;\">\n                        ${String(p.hora).padStart(2, '0')}h\n                    </text>\n                `;\n            }).join('')}\n            \n            <!-- Eixo X -->\n            <line x1=\"${padding}\" y1=\"${height - padding}\" x2=\"${width - padding}\" y2=\"${height - padding}\" \n                  stroke=\"#374151\" stroke-width=\"2\"/>\n            \n            <!-- Eixo Y -->\n            <line x1=\"${padding}\" y1=\"${padding}\" x2=\"${padding}\" y2=\"${height - padding}\" \n                  stroke=\"#374151\" stroke-width=\"2\"/>\n        </svg>\n        \n        <!-- Legenda -->\n        <div style=\"display: flex; justify-content: center; gap: 20px; margin-top: 16px; font-size: 11px;\">\n            <div style=\"display: flex; align-items: center; gap: 6px;\">\n                <div style=\"width: 12px; height: 12px; border-radius: 50%; background: #10b981;\"></div>\n                <span>Baixo (1-2)</span>\n            </div>\n            <div style=\"display: flex; align-items: center; gap: 6px;\">\n                <div style=\"width: 12px; height: 12px; border-radius: 50%; background: #f59e0b;\"></div>\n                <span>M√©dio (3-5)</span>\n            </div>\n            <div style=\"display: flex; align-items: center; gap: 6px;\">\n                <div style=\"width: 12px; height: 12px; border-radius: 50%; background: #f97316;\"></div>\n                <span>Alto (6-10)</span>\n            </div>\n            <div style=\"display: flex; align-items: center; gap: 6px;\">\n                <div style=\"width: 12px; height: 12px; border-radius: 50%; background: #ef4444;\"></div>\n                <span>Cr√≠tico (10+)</span>\n            </div>\n        </div>\n    `;\n}\n\n// Gerar heatmap de hor√°rios\nfunction gerarHeatmapHorarios() {\n    const container = document.getElementById('heatmapHorarios');\n    const horarioStats = {};\n    \n    // Inicializar todas as horas\n    for (let h = 0; h < 24; h++) {\n        horarioStats[h] = 0;\n    }\n    \n    console.log('üïê Gerando heatmap com', intercorrenciasFiltradas.length, 'intercorr√™ncias');\n    \n    // Contar intercorr√™ncias por hora - MELHORADO\n    intercorrenciasFiltradas.forEach(item => {\n        // Tentar extrair hora de diferentes campos\n        let hora = null;\n        \n        // Tentar do campo DATA_INTERCORRENCIA\n        if (item.DATA_INTERCORRENCIA) {\n            try {\n                // Verificar se √© timestamp ou string\n                let dataHora;\n                if (typeof item.DATA_INTERCORRENCIA === 'string') {\n                    // Pode ser formato ISO ou outros\n                    dataHora = new Date(item.DATA_INTERCORRENCIA);\n                } else {\n                    dataHora = new Date(item.DATA_INTERCORRENCIA);\n                }\n                \n                hora = dataHora.getHours();\n                \n                // Se getHours() retornar NaN, tentar parse manual\n                if (isNaN(hora) && typeof item.DATA_INTERCORRENCIA === 'string') {\n                    // Formato poss√≠vel: \"2024-01-15 14:30:00\" ou \"15/01/2024 14:30\"\n                    const timeMatch = item.DATA_INTERCORRENCIA.match(/(\\d{1,2}):(\\d{2})/);\n                    if (timeMatch) {\n                        hora = parseInt(timeMatch[1]);\n                    }\n                }\n            } catch (e) {\n                console.log('Erro parsing data:', item.DATA_INTERCORRENCIA, e);\n            }\n        }\n        \n        // Se conseguiu extrair uma hora v√°lida\n        if (hora !== null && !isNaN(hora) && hora >= 0 && hora < 24) {\n            horarioStats[hora]++;\n        }\n    });\n    \n    console.log('üìä Stats por hora:', horarioStats);\n    \n    const maxVal = Math.max(...Object.values(horarioStats), 1);\n    \n    container.innerHTML = Object.entries(horarioStats)\n        .sort((a, b) => parseInt(a[0]) - parseInt(b[0]))\n        .map(([hora, count]) => {\n            let cor = '#ecfdf5';\n            let textColor = '#065f46';\n            \n            if (count === 0) {\n                cor = '#f9fafb';\n                textColor = '#d1d5db';\n            } else if (count <= 2) {\n                cor = '#ecfdf5';\n                textColor = '#065f46';\n            } else if (count <= 5) {\n                cor = '#a7f3d0';\n                textColor = '#065f46';\n            } else if (count <= 10) {\n                cor = '#fef3c7';\n                textColor = '#92400e';\n            } else {\n                cor = '#fecaca';\n                textColor = '#991b1b';\n            }\n            \n            return `\n                <div class=\"heatmap-cell\" \n                     style=\"background: ${cor}; color: ${textColor}; font-weight: 700;\"\n                     title=\"${String(hora).padStart(2, '0')}:00 - ${count} intercorr√™ncia(s)\">\n                    ${String(hora).padStart(2, '0')}\n                </div>\n            `;\n        }).join('');\n}\n\n// Gerar gr√°fico por dia da semana\nfunction gerarGraficoDiaSemana() {\n    const container = document.getElementById('graficoDiaSemana');\n    const diasSemana = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];\n    const diaStats = [0, 0, 0, 0, 0, 0, 0];\n    \n    intercorrenciasFiltradas.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            try {\n                const data = new Date(item.DATA_INTERCORRENCIA);\n                const dia = data.getDay();\n                diaStats[dia]++;\n            } catch (e) {\n                // Ignorar\n            }\n        }\n    });\n    \n    const maxVal = Math.max(...diaStats, 1);\n    \n    container.innerHTML = diasSemana.map((dia, index) => {\n        const count = diaStats[index];\n        const porcentagem = Math.round((count / maxVal) * 100);\n        \n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${dia}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico por per√≠odo do dia\nfunction gerarGraficoPeriodoDia() {\n    const container = document.getElementById('graficoPeriodoDia');\n    const periodos = {\n        'Madrugada (00-06h)': 0,\n        'Manh√£ (06-12h)': 0,\n        'Tarde (12-18h)': 0,\n        'Noite (18-24h)': 0\n    };\n    \n    intercorrenciasFiltradas.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            try {\n                const data = new Date(item.DATA_INTERCORRENCIA);\n                const hora = data.getHours();\n                \n                if (hora >= 0 && hora < 6) periodos['Madrugada (00-06h)']++;\n                else if (hora >= 6 && hora < 12) periodos['Manh√£ (06-12h)']++;\n                else if (hora >= 12 && hora < 18) periodos['Tarde (12-18h)']++;\n                else periodos['Noite (18-24h)']++;\n            } catch (e) {\n                // Ignorar\n            }\n        }\n    });\n    \n    const maxVal = Math.max(...Object.values(periodos), 1);\n    \n    container.innerHTML = Object.entries(periodos).map(([periodo, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        \n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${periodo}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico de tempo de resolu√ß√£o\nfunction gerarGraficoTempoResolucao() {\n    const container = document.getElementById('graficoTempoResolucao');\n    const faixas = {\n        '0-30 min': 0,\n        '30min-1h': 0,\n        '1-2h': 0,\n        '2-4h': 0,\n        '4h+': 0\n    };\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n        const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n        \n        if (match) {\n            const [, dias, horas, minutos] = match;\n            const totalMinutos = parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            \n            if (totalMinutos < 30) faixas['0-30 min']++;\n            else if (totalMinutos < 60) faixas['30min-1h']++;\n            else if (totalMinutos < 120) faixas['1-2h']++;\n            else if (totalMinutos < 240) faixas['2-4h']++;\n            else faixas['4h+']++;\n        }\n    });\n    \n    const maxVal = Math.max(...Object.values(faixas), 1);\n    \n    container.innerHTML = Object.entries(faixas).map(([faixa, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        \n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\">${faixa}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Gerar gr√°fico top causas\nfunction gerarGraficoTopCausas() {\n    const container = document.getElementById('graficoTopCausas');\n    const causasStats = {};\n    \n    intercorrenciasFiltradas.forEach(item => {\n        const descricao = (item.DESCRICAO || 'Sem descri√ß√£o').substring(0, 40);\n        causasStats[descricao] = (causasStats[descricao] || 0) + 1;\n    });\n    \n    const topCausas = Object.entries(causasStats)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 10);\n    \n    const maxVal = Math.max(...topCausas.map(c => c[1]), 1);\n    \n    container.innerHTML = topCausas.map(([causa, count]) => {\n        const porcentagem = Math.round((count / maxVal) * 100);\n        \n        return `\n            <div class=\"bar-item\">\n                <div class=\"bar-label\" style=\"min-width: 150px; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;\" title=\"${causa}\">${causa}</div>\n                <div class=\"bar-wrapper\">\n                    <div class=\"bar-fill\" style=\"width: ${porcentagem}%;\">\n                        <div class=\"bar-value\">${count}</div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }).join('');\n}\n\n// Atualizar insights\nfunction atualizarInsights() {\n    // Hor√°rio de pico\n    const horarioStats = {};\n    intercorrenciasFiltradas.forEach(item => {\n        if (item.DATA_INTERCORRENCIA) {\n            try {\n                const data = new Date(item.DATA_INTERCORRENCIA);\n                const hora = data.getHours();\n                if (!isNaN(hora)) {\n                    horarioStats[hora] = (horarioStats[hora] || 0) + 1;\n                }\n            } catch (e) {}\n        }\n    });\n    \n    const horarioPico = Object.entries(horarioStats).sort((a, b) => b[1] - a[1])[0];\n    if (horarioPico) {\n        document.querySelector('#insightHorarioPico .insight-value').textContent = \n            String(horarioPico[0]).padStart(2, '0') + ':00';\n    }\n    \n    // Taxa de aprova√ß√£o\n    const total = intercorrenciasFiltradas.length;\n    const aprovadas = intercorrenciasFiltradas.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n    const taxa = total > 0 ? Math.round((aprovadas / total) * 100) : 0;\n    document.getElementById('insightTaxaAprovacao').textContent = taxa + '%';\n    \n    // Tempo m√©dio de resposta (simplificado)\n    let tempoMedioMinutos = 0;\n    if (total > 0) {\n        const tempos = intercorrenciasFiltradas.map(item => {\n            const tempoStr = item.TEMPO_INTERCORRENCIA || '0 0:0:0.0';\n            const match = tempoStr.match(/(\\d+)\\s+(\\d+):(\\d+):(\\d+)\\.(\\d+)/);\n            if (match) {\n                const [, dias, horas, minutos] = match;\n                return parseInt(dias) * 1440 + parseInt(horas) * 60 + parseInt(minutos);\n            }\n            return 0;\n        });\n        \n        tempoMedioMinutos = Math.floor(tempos.reduce((sum, t) => sum + t, 0) / tempos.length);\n    }\n    \n    const horasMedia = Math.floor(tempoMedioMinutos / 60);\n    const minutosMedia = tempoMedioMinutos % 60;\n    document.getElementById('insightTempoResposta').textContent = \n        horasMedia + ':' + String(minutosMedia).padStart(2, '0');\n}\n\n// Debug do sistema\nfunction debugSistema() {\n    console.log('üîç === DEBUG INTERCORR√äNCIAS BI 2.0 ===');\n    \n    const modal = document.getElementById('modalDebug');\n    const conteudo = document.getElementById('modalDebugConteudo');\n    \n    let html = '<div style=\"padding: 20px;\">';\n    \n    // Header\n    html += '<div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;\">';\n    html += '<h2 style=\"margin: 0 0 10px 0; font-size: 24px;\">üîç Debug - Central de Intercorr√™ncias BI 2.0</h2>';\n    html += '<p style=\"margin: 0; opacity: 0.9;\">Informa√ß√µes detalhadas do sistema</p>';\n    html += '</div>';\n    \n    // Dados B√°sicos\n    html += '<div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 5px solid #ef4444;\">';\n    html += '<h3 style=\"color: #ef4444; margin-bottom: 15px;\">üì¶ Dados Carregados</h3>';\n    html += '<div style=\"display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;\">';\n    html += `<div><strong>üìä Total de Registros Originais:</strong><br><span style=\"font-size: 24px; color: #ef4444; font-weight: 900;\">${intercorrenciasOriginais.length}</span></div>`;\n    html += `<div><strong>üîç Total de Registros Filtrados:</strong><br><span style=\"font-size: 24px; color: #1890ff; font-weight: 900;\">${intercorrenciasFiltradas.length}</span></div>`;\n    html += '</div>';\n    html += '</div>';\n    \n    if (intercorrenciasOriginais.length > 0) {\n        // Status\n        const aprovadas = intercorrenciasOriginais.filter(i => getStatusIntercorrencia(i) === 'APROVADO').length;\n        const reprovadas = intercorrenciasOriginais.filter(i => getStatusIntercorrencia(i) === 'REPROVADO').length;\n        const pendentes = intercorrenciasOriginais.filter(i => getStatusIntercorrencia(i) === 'PENDENTE').length;\n        \n        html += '<div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 5px solid #10b981;\">';\n        html += '<h3 style=\"color: #10b981; margin-bottom: 15px;\">üìä Distribui√ß√£o de Status</h3>';\n        html += '<div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;\">';\n        html += `<div style=\"text-align: center; padding: 15px; background: #d1fae5; border-radius: 8px;\"><div style=\"font-size: 28px; font-weight: 900; color: #065f46;\">${aprovadas}</div><div style=\"font-size: 12px; color: #065f46;\">‚úÖ Aprovadas</div></div>`;\n        html += `<div style=\"text-align: center; padding: 15px; background: #fee2e2; border-radius: 8px;\"><div style=\"font-size: 28px; font-weight: 900; color: #991b1b;\">${reprovadas}</div><div style=\"font-size: 12px; color: #991b1b;\">‚ùå Reprovadas</div></div>`;\n        html += `<div style=\"text-align: center; padding: 15px; background: #fef3c7; border-radius: 8px;\"><div style=\"font-size: 28px; font-weight: 900; color: #92400e;\">${pendentes}</div><div style=\"font-size: 12px; color: #92400e;\">‚è≥ Pendentes</div></div>`;\n        html += '</div>';\n        html += '</div>';\n        \n        // Campos\n        const campos = Object.keys(intercorrenciasOriginais[0]);\n        html += '<div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 5px solid #f59e0b;\">';\n        html += '<h3 style=\"color: #f59e0b; margin-bottom: 15px;\">üîë Campos Dispon√≠veis</h3>';\n        html += '<div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;\">';\n        campos.forEach(campo => {\n            html += `<div style=\"background: #fef3c7; padding: 8px; border-radius: 6px; font-size: 11px; font-weight: 600;\">${campo}</div>`;\n        });\n        html += '</div>';\n        html += `<div style=\"margin-top: 15px; padding: 15px; background: #fff7ed; border-radius: 8px;\"><strong>Total de campos:</strong> ${campos.length}</div>`;\n        html += '</div>';\n        \n        // Exemplo de Registro\n        html += '<div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 5px solid #8b5cf6;\">';\n        html += '<h3 style=\"color: #8b5cf6; margin-bottom: 15px;\">üìù Exemplo de Registro (Primeiro)</h3>';\n        html += '<pre style=\"background: #f9fafb; padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 11px;\">';\n        html += JSON.stringify(intercorrenciasOriginais[0], null, 2);\n        html += '</pre>';\n        html += '</div>';\n        \n        // Analytics\n        html += '<div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 5px solid #1890ff;\">';\n        html += '<h3 style=\"color: #1890ff; margin-bottom: 15px;\">üìà Analytics Gerados</h3>';\n        const filiaisCount = document.getElementById('graficoFiliais')?.children.length || 0;\n        const motoboysCount = document.getElementById('graficoMotoboys')?.children.length || 0;\n        const cidadesCount = document.getElementById('graficoCidades')?.children.length || 0;\n        html += '<div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;\">';\n        html += `<div style=\"text-align: center; padding: 15px; background: #f0f9ff; border-radius: 8px;\"><div style=\"font-size: 28px; font-weight: 900; color: #1890ff;\">${filiaisCount}</div><div style=\"font-size: 12px; color: #1890ff;\">üè¢ Gr√°fico Filiais</div></div>`;\n        html += `<div style=\"text-align: center; padding: 15px; background: #f0f9ff; border-radius: 8px;\"><div style=\"font-size: 28px; font-weight: 900; color: #1890ff;\">${motoboysCount}</div><div style=\"font-size: 12px; color: #1890ff;\">üèçÔ∏è Gr√°fico Motoboys</div></div>`;\n        html += `<div style=\"text-align: center; padding: 15px; background: #f0f9ff; border-radius: 8px;\"><div style=\"font-size: 28px; font-weight: 900; color: #1890ff;\">${cidadesCount}</div><div style=\"font-size: 12px; color: #1890ff;\">üèôÔ∏è Gr√°fico Cidades</div></div>`;\n        html += '</div>';\n        html += '</div>';\n        \n        // Imagens\n        const comImagem = intercorrenciasOriginais.filter(i => i.URLS_FOTOS && i.URLS_FOTOS.trim()).length;\n        html += '<div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 5px solid #ec4899;\">';\n        html += '<h3 style=\"color: #ec4899; margin-bottom: 15px;\">üì∑ Imagens</h3>';\n        html += `<div style=\"padding: 15px; background: #fce7f3; border-radius: 8px; text-align: center;\">`;\n        html += `<div style=\"font-size: 32px; font-weight: 900; color: #ec4899;\">${comImagem}</div>`;\n        html += `<div style=\"font-size: 14px; color: #ec4899;\">Intercorr√™ncias com fotos anexadas</div>`;\n        html += `</div>`;\n        html += '</div>';\n        \n        // UFs Detectadas\n        const ufsMap = {};\n        intercorrenciasOriginais.forEach(i => {\n            const uf = extrairUF(i);\n            if (uf) {\n                ufsMap[uf] = (ufsMap[uf] || 0) + 1;\n            }\n        });\n        const ufs = Object.keys(ufsMap).sort();\n        \n        html += '<div style=\"background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 5px solid #14b8a6;\">';\n        html += '<h3 style=\"color: #14b8a6; margin-bottom: 15px;\">üó∫Ô∏è UFs Detectadas (do campo CIDADE)</h3>';\n        if (ufs.length > 0) {\n            html += '<div style=\"display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px;\">';\n            ufs.forEach(uf => {\n                html += `<div style=\"text-align: center; padding: 10px; background: #ccfbf1; border-radius: 8px;\">`;\n                html += `<div style=\"font-size: 20px; font-weight: 900; color: #14b8a6;\">${uf}</div>`;\n                html += `<div style=\"font-size: 11px; color: #14b8a6;\">${ufsMap[uf]} reg.</div>`;\n                html += `</div>`;\n            });\n            html += '</div>';\n        } else {\n            html += '<div style=\"padding: 15px; background: #fef3c7; border-radius: 8px; color: #92400e;\">‚ö†Ô∏è Nenhuma UF foi detectada. Verifique o formato do campo CIDADE.</div>';\n        }\n        html += '</div>';\n        \n    } else {\n        html += '<div style=\"background: #fee2e2; border-radius: 12px; padding: 30px; text-align: center; border-left: 5px solid #dc2626;\">';\n        html += '<div style=\"font-size: 64px; margin-bottom: 20px;\">‚ö†Ô∏è</div>';\n        html += '<h3 style=\"color: #dc2626; margin-bottom: 10px;\">Nenhum Dado Carregado!</h3>';\n        html += '<p style=\"color: #991b1b;\">A vari√°vel intercorrenciasOriginais est√° vazia.</p>';\n        html += '<p style=\"color: #991b1b;\">Verifique se intercorrencias_bi20 existe e cont√©m dados.</p>';\n        html += '</div>';\n    }\n    \n    html += '</div>';\n    \n    conteudo.innerHTML = html;\n    modal.style.display = 'block';\n    \n    // Tamb√©m logar no console\n    console.log('üì¶ Dados originais:', intercorrenciasOriginais.length);\n    console.log('üîç Dados filtrados:', intercorrenciasFiltradas.length);\n    console.log('üîç === DEBUG FINALIZADO ===');\n}\n\n// Fechar modal de debug\nfunction fecharModalDebug() {\n    document.getElementById('modalDebug').style.display = 'none';\n}\n\n// Fechar modal clicando fora\nwindow.onclick = function(event) {\n    const modalImagem = document.getElementById('modalImagem');\n    const modalTimeline = document.getElementById('modalTimelineHora');\n    const modalDebug = document.getElementById('modalDebug');\n    \n    if (event.target === modalImagem) {\n        modalImagem.style.display = 'none';\n    }\n    \n    if (event.target === modalTimeline) {\n        modalTimeline.style.display = 'none';\n    }\n    \n    if (event.target === modalDebug) {\n        modalDebug.style.display = 'none';\n    }\n}\n\n// Inicializar sistema\nsetTimeout(() => {\n    console.log('‚ö†Ô∏è Inicializando Central de Intercorr√™ncias BI 2.0...');\n    console.log('üì¶ Dados carregados:', intercorrenciasOriginais.length, 'intercorr√™ncias');\n    \n    if (intercorrenciasOriginais.length > 0) {\n        console.log('üîç Exemplo de intercorr√™ncia:', intercorrenciasOriginais[0]);\n        console.log('üîë Campos dispon√≠veis:', Object.keys(intercorrenciasOriginais[0]));\n        \n        // Verificar aprova√ß√µes\n        const aprovadas = intercorrenciasOriginais.filter(i => i.APROVACAO_INTERCORRENCIA === 'TRUE').length;\n        const pendentes = intercorrenciasOriginais.filter(i => i.APROVACAO_INTERCORRENCIA !== 'TRUE').length;\n        console.log('üìä Status inicial: ' + aprovadas + ' aprovadas, ' + pendentes + ' pendentes');\n        \n        try {\n            console.log('1Ô∏è‚É£ Populando filtros...');\n            popularFiltros();\n            \n            console.log('2Ô∏è‚É£ Copiando dados filtrados...');\n            intercorrenciasFiltradas = intercorrenciasOriginais;\n            \n            console.log('3Ô∏è‚É£ Atualizando estat√≠sticas...');\n            atualizarEstatisticas();\n            \n            console.log('4Ô∏è‚É£ Renderizando cards...');\n            renderizarCards();\n            \n            console.log('5Ô∏è‚É£ Atualizando resultados...');\n            atualizarResultados();\n            \n            console.log('6Ô∏è‚É£ Gerando gr√°ficos b√°sicos...');\n            gerarGraficos();\n            \n            console.log('7Ô∏è‚É£ Gerando gr√°ficos avan√ßados...');\n            gerarGraficosAvancados();\n            \n            console.log('8Ô∏è‚É£ Inicializando aba de motoboys...');\n            inicializarAbaMotoboys();\n            \n            console.log('9Ô∏è‚É£ Inicializando aba de filiais...');\n            inicializarAbaFiliais();\n            \n            console.log('‚úÖ Todas as etapas conclu√≠das com sucesso!');\n        } catch (error) {\n            console.error('‚ùå ERRO durante inicializa√ß√£o:', error);\n            console.error('Stack trace:', error.stack);\n            alert('Erro ao inicializar o sistema. Verifique o console para detalhes.');\n        }\n    } else {\n        console.warn('‚ö†Ô∏è Nenhum dado encontrado em intercorrenciasOriginais!');\n        console.log('Verificando vari√°vel intercorrencias_bi20:', typeof intercorrencias_bi20);\n        \n        // Tentar carregar novamente\n        try {\n            if (typeof intercorrencias_bi20 !== 'undefined' && intercorrencias_bi20?.data) {\n                console.log('üîÑ Tentando carregar dados novamente...');\n                intercorrenciasOriginais = intercorrencias_bi20.data || [];\n                console.log('üìä Dados recarregados:', intercorrenciasOriginais.length);\n                \n                if (intercorrenciasOriginais.length > 0) {\n                    console.log('‚úÖ Sucesso! Reiniciando...');\n                    location.reload();\n                    return;\n                }\n            }\n        } catch (e) {\n            console.error('‚ùå Erro ao tentar recarregar:', e);\n        }\n        \n        document.getElementById('intercorrenciasGrid').innerHTML = `\n            <div class=\"sem-intercorrencias\">\n                <div class=\"sem-intercorrencias-icon\">‚ö†Ô∏è</div>\n                <div class=\"sem-intercorrencias-texto\">Nenhum dado carregado</div>\n                <div class=\"sem-intercorrencias-subtexto\">\n                    Verifique se a vari√°vel intercorrencias_bi20 existe e cont√©m dados.<br><br>\n                    <button onclick=\"location.reload()\" style=\"background: #ef4444; color: white; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 14px;\">\n                        üîÑ Recarregar P√°gina\n                    </button>\n                </div>\n            </div>\n        `;\n    }\n    \n    console.log('‚úÖ Central de Intercorr√™ncias BI 2.0 inicializada');\n    console.log('üîç Use o bot√£o \"Debug\" no header para an√°lise detalhada');\n}, 500);\n</script>\n\n{{''}}\n",
  "topRow": 13,
  "type": "IFRAME_WIDGET",
  "version": 1,
  "widgetId": "vrq3hnmw2t",
  "widgetName": "Iframe2Copy"
}