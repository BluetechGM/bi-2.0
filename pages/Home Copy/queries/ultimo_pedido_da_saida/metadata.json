{
  "gitSyncId": "6904ab7642599522ad71b295_8d0c290d-d854-40f7-8752-658f0eb5ea02",
  "id": "Home Copy_ultimo_pedido_da_saida",
  "pluginId": "oracle-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "encodeParamsToggle": true,
      "formData": {
        "body": {
          "data": "SELECT \n    rel.saidaid,\n    rel.numped AS pedido,\n    rel.codfilial,\n    (SELECT TAB_GRUPOFILIAL.SIGLA \n       FROM TAB_GRUPOFILIAL \n      WHERE TAB_GRUPOFILIAL.CODFILIAL = rel.codfilial) AS FILIAL,\n    TO_CHAR(rel.dtretorno, 'DD/MM/YYYY HH24:MI:SS') AS entrega_cliente,\n    TO_CHAR(rel.dtacerto, 'DD/MM/YYYY HH24:MI:SS') AS fim_rota,\n    CASE \n        WHEN rel.dtretorno IS NULL OR rel.dtacerto IS NULL THEN '00:00:00'\n        ELSE\n            TO_CHAR(TRUNC((rel.dtacerto - rel.dtretorno) * 24), 'FM00') || ':' ||\n            TO_CHAR(TRUNC(MOD((rel.dtacerto - rel.dtretorno) * 24 * 60, 60)), 'FM00') || ':' ||\n            TO_CHAR(TRUNC(MOD((rel.dtacerto - rel.dtretorno) * 24 * 60 * 60, 60)), 'FM00')\n    END AS tempo_retorno\nFROM (\n    SELECT \n        t.saidaid,\n        t.codfilial,\n        t.numped,\n        t.datasaida,\n        CAST(i.dataintegracao AS DATE) AS dtretorno,\n        CAST(t.dataretorno AS DATE) AS dtacerto,\n        ROW_NUMBER() OVER (PARTITION BY t.saidaid ORDER BY i.dataintegracao DESC) AS rn\n    FROM tab_saidamoto t\n    LEFT JOIN tab_integra_site i ON i.numped = t.numped\n    WHERE t.datasaida >= TO_DATE('{{ moment(DatePicker_Data_Inicio.selectedDate).format(\"DD-MM-YYYY\") }}', 'DD-MM-YYYY')\n      AND t.datasaida < TO_DATE('{{ moment(DatePicker_Data_Fim.selectedDate).format(\"DD-MM-YYYY\") }}', 'DD-MM-YYYY') + 1\n) rel\nWHERE rel.rn = 1\nORDER BY rel.saidaid\n"
        },
        "preparedStatement": {
          "data": true
        }
      },
      "paginationType": "NONE",
      "timeoutInMillisecond": 100000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "WINDONBLUE",
      "isAutoGenerated": false,
      "name": "WINDONBLUE",
      "pluginId": "oracle-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "formData.body.data"
      }
    ],
    "name": "ultimo_pedido_da_saida",
    "pageId": "Home Copy",
    "runBehaviour": "ON_PAGE_LOAD",
    "userSetOnLoad": true
  }
}